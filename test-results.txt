
> @cardplay/core@0.1.0 test
> vitest run

Testing types with tsc and vue-tsc is an experimental feature.
Breaking changes might not follow SemVer, please pin Vitest's version when using it.

 RUN  v1.6.1 /Users/halleyyoung/Documents/behavioral/cardplay

 ✓ src/ui/components/arrangement-panel.test.ts  (238 tests) 26ms
 ✓ src/ui/components/piano-roll-panel.test.ts  (132 tests) 18ms
 ✓ src/ui/components/tracker-panel.test.ts  (139 tests) 22ms
 ✓ src/cards/card-visuals.test.ts  (162 tests) 43ms
 ✓ src/cards/arranger.test.ts  (222 tests) 28ms
 ✓ src/cards/generators.test.ts  (164 tests) 20ms
 ✓ src/ui/session-view.test.ts  (166 tests) 20ms
 ✓ src/gofai/nl/__tests__/golden-utterances.test.ts  (211 tests) 18ms
 ✓ src/ai/theory/theory-cards.test.ts  (115 tests) 21ms
 ✓ src/ui/components/sample-browser.test.ts  (131 tests) 24ms
 ✓ src/cards/transforms.test.ts  (123 tests) 14ms
 ✓ src/gofai/canon/__tests__/goals-constraints.test.ts  (73 tests) 14ms
 ✓ src/gofai/invariants/__tests__/semantic-safety-invariants.test.ts  (47 tests) 9ms
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Notation Composer: Engraving Quality (M014) > M026: returns engraving rules
Error getting answer: [object Object]
Error getting answer: [object Object]

stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Notation Composer: Engraving Quality (M014) > M026: returns engraving rules
Error getting answer: [object Object]
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > SpecEventBus (C915) > should handle errors in handlers without breaking other handlers
SpecEventBus handler error: Error: handler error
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts:239:44
    at SpecEventBus.publish (/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.ts:124:15)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts:243:9
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:958:5)
    at startTests (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:967:3)

 ✓ src/cards/drum-machine.test.ts  (128 tests | 3 skipped) 31ms
 ✓ src/containers/container.test.ts  (75 tests) 20ms
 ✓ src/cards/effects.test.ts  (112 tests) 19ms
 ✓ src/cards/macro-controls.test.ts  (79 tests) 15ms
 ✓ src/notation/notation.test.ts  (96 tests) 18ms
 ✓ src/ai/learning/user-preferences.test.ts  (63 tests) 227ms
 ✓ src/ui/cards.test.ts  (94 tests) 13ms
 ✓ src/gofai/canon/__tests__/versioning.test.ts  (70 tests) 16ms
 ✓ src/notation/playback.test.ts  (75 tests) 35ms
 ✓ src/ui/beginner.test.ts  (73 tests) 12ms
 ✓ src/cards/presets.test.ts  (58 tests) 21ms
 ✓ src/gofai/infra/__tests__/project-world-api.test.ts  (47 tests) 9ms
stderr | src/ai/theory/spec-event-bus.test.ts > Schema Matching Score (C890) > romanesca bass pattern gets partial match
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Schema Matching Score (C890) > non-matching bass gets low score
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Constraint Export/Import (C1085-C1086) > export to Prolog generates valid facts
No definition for constraint type 'user:test'

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C699: detects ornament insertion points on strong beats
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C699: detects phrase endings on long notes
Error getting answer: [object Object]

 ✓ src/tracks/clip-operations.test.ts  (62 tests) 10ms
stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C701: generates roll with tempo-adaptive strike count
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C701: generates roll with tempo-adaptive strike count
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C703: generates cut (grace note above)
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C703: generates tap (grace note below)
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C707: fiddle double-stop finds open string resonance
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Celtic Ornament Generators > C746: harp voicing produces open sonority
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Contrary Motion Detection (C1234) > detects contrary motion between two voices
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Contrary Motion Detection (C1234) > no contrary motion in parallel voices
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Schema Recognition (C879) > detects descending bass as Romanesca
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Schema Recognition (C879) > detects stepwise descent as Prinner
Error getting answer: [object Object]

 ✓ src/cards/bassline.test.ts  (144 tests | 2 skipped) 25ms
stderr | src/ai/theory/spec-event-bus.test.ts > Schema Recognition (C879) > returns empty for no pattern
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Culture Recognition (C881) > identifies pentatonic as chinese
Error getting answer: [object Object]

stderr | src/ai/theory/spec-event-bus.test.ts > Culture Recognition (C881) > identifies chromatic-rich melody as possible carnatic
Error getting answer: [object Object]

 ✓ src/ui/achievements.test.ts  (71 tests) 15ms
 ✓ src/gofai/nl/__tests__/ambiguity-detection.test.ts  (99 tests) 9ms
 ✓ src/cards/lead-synth.test.ts  (105 tests) 23ms
 ✓ src/cards/parameters.test.ts  (73 tests) 11ms
 ❯ src/ai/theory/spec-event-bus.test.ts  (395 tests | 173 failed) 1247ms
   ❯ src/ai/theory/spec-event-bus.test.ts > Card Constraint Lifecycle (C1059-C1062) > C1062: MusicSpec changes propagate to card params
     → expected [] to have a length of 1 but got +0
   ❯ src/ai/theory/spec-event-bus.test.ts > Chinese Mode Tests (C1820) > C1820: Chinese modes calculate correct pitches
     → Target cannot be null or undefined.
   ❯ src/ai/theory/spec-event-bus.test.ts > Orchestration Solver (C1546) > C1546: solveOrchestration returns valid assignments
     → adapter.loadProgram is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Korvai Search (C632, C634) > fills tala cycle with phrase candidates
     → searchKorvai is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Korvai Search (C632, C634) > respects maxDepth bound (C634)
     → searchKorvai is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C945/C946: exports to notation format
     → exportToNotation is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C945: low notes get bass clef
     → exportToNotation is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C947/C948: exports to tracker format
     → exportToTracker is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C949/C950: exports to arranger format
     → Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Phrase Recommendation (C928, C930) > C928: recommends phrases matching spec culture
     → Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Phrase Recommendation (C928, C930) > C930: suggests arranger variation based on energy
     → suggestArrangerVariation is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Line Lint (C1432) > detects large leaps
     → lintJazzLine is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Line Lint (C1432) > clean line has high score
     → lintJazzLine is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C983: default flags all enabled
     → DEFAULT_FEATURE_FLAGS is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C983: override specific flags
     → getActiveFeatureFlags is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C984: capabilities report lists all modules
     → generateCapabilitiesReport is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C986: migration hides advanced cards for old projects
     → migrateProjectTheoryDefaults is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C986: v2 projects do not hide cards
     → migrateProjectTheoryDefaults is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > creates relative time grid from note events
     → createFreeRhythmGrid is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > round-trips free-rhythm grid to events
     → createFreeRhythmGrid is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > empty input returns empty grid
     → createFreeRhythmGrid is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Piano & Guitar Voicing (C1224, C1226) > C1224: two-handed voicing has LH and RH
     → generateTwoHandedVoicing is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Piano & Guitar Voicing (C1224, C1226) > C1226: guitar voicing respects fret span
     → generateGuitarVoicing is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Schema-as-Constraints (C347) > applies schema constraints suggesting relevant cards
     → Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Contemporary Jazz Pack (C1415) > pack has required fields
     → CONTEMPORARY_JAZZ_PACK is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > validates a complete manifest
     → validatePackManifest is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > rejects manifest with missing fields
     → validatePackManifest is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > serialize and parse round-trip
     → serializePackManifest is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Pack Signing (C1015) > hash is deterministic
     → hashPackContent is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Pack Signing (C1015) > verify succeeds with correct hash
     → hashPackContent is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox validates safe code
     → sandboxPrologCode is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox rejects unsafe code
     → sandboxPrologCode is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox rejects wrong namespace
     → sandboxPrologCode is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Card Template (C1047) > creates template with required fields
     → createTheoryCardTemplate is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1049: constraint → param sync
     → syncConstraintToParam is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1050: param → constraint sync
     → syncParamToConstraint is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1051: card-to-card links
     → clearCardLinks is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1056: install and uninstall pack
     → createCardPack is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1057: resolve dependencies
     → createCardPack is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1058: check pack update
     → createCardPack is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1091: save and load project constraints
     → saveProjectConstraints is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1094: constraint profile lifecycle
     → saveConstraintProfile is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1095/C1096: project bundle export and import
     → exportProjectBundle is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1098: health check detects duplicate types
     → runConstraintHealthCheck is not defined
   ❯ src/ai/theory/spec-event-bus.test.ts > Key Suggestions for Instruments (C739) > penalizes bad keys
     → Cannot read properties of undefined (reading 'score')
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > explains dorian mode
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > explains mixolydian mode
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > returns generic for unknown modes
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Dance Accent Presets (C724) > has presets for major dance types
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Dance Accent Presets (C724) > each preset has beats array
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Variation Presets (C729) > has multiple variation types
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Variation Presets (C729) > each preset has description
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Chinese Variation Presets (C831) > has multiple variation types
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects parallel fifths
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects voice crossing
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects large leaps
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sample Deck Exports (C991) > exports multiple deck definitions
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sample Deck Exports (C991) > each deck has name, cards, and description
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sample Board Presets (C992) > exports multiple board presets
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sample Board Presets (C992) > each board has name and decks
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > returns config for beginner
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > returns config for pro
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > progressive disclosure increases with level
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > records events
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > computes usage summary
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > gets most used tools
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > clears events
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Arrangement Templates (C694) > provides templates for common tune types
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Arrangement Templates (C694) > each template has structure and tempo
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > builds a set from tunes
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > scores related keys higher
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > estimates duration
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Vocabulary Export (C1441) > exports vocabulary to practice sheet
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Vocabulary Export (C1441) > respects difficulty parameter
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > generates AABB markers
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > handles AABBCC
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > computes bar positions
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > has standard Celtic patterns
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > has multiple voicing templates
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > finds voicing for tune type
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > returns default for unknown type
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sheng Voicings (C815) > has multiple voicing templates
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Sheng Voicings (C815) > finds voicing for mode
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > marks intro at position 0
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > detects energy jumps as boundaries
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > returns empty for empty input
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > builds schema result card
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > builds culture result card
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > handles unknown analysis type
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Orchestration Role Allocation (C899) > allocates roles for default style
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Orchestration Role Allocation (C899) > uses style-specific templates
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Mixer Defaults (C900) > generates mixer defaults from roles
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Variation Recommendations (C932) > recommends variations for song parts
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Fill Triggers (C934) > suggests fills at section boundaries
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Fill Triggers (C934) > assigns higher intensity near end
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > provides galant board template
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > provides celtic board template
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > getAllBoardTemplates returns all
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > searches by query
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > filters by culture
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > filters by category
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > returns all for empty query
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > has multiple templates
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > finds template for lydian scale
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > returns undefined for unknown scale
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Reharmonization (C1340, C1341) > suggests tritone substitutions
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Reharmonization (C1340, C1341) > filters by context
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Bebop Vocabulary Constraints (C1398) > has multiple pattern constraints
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Tracker Jazz Patterns (C1399) > has patterns of various difficulties
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Tracker Jazz Patterns (C1399) > filters by category
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Solo Section Config (C1400) > generates config for bebop
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Solo Section Config (C1400) > generates config for blues
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Heterophony Lanes (C794) > generates lanes with lead as first
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Heterophony Lanes (C794) > assigns culture-specific labels
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > supports push and undo
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > supports redo
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > clears redo on new push
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > installs and retrieves packs
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > prevents duplicate installs
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > enables and disables packs
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Voice Leading (C1170) > scores smooth voice leading
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Voice Leading (C1170) > flags wide voice leading
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > PersonalVocabularyLibrary (C1439) > adds and retrieves entries
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > PersonalVocabularyLibrary (C1439) > searches by query
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Pitch Class Visualization (C1079) > generates 12 pitch classes
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Beat Grid Visualization (C1080) > generates beats for 4/4
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Tension Graph Visualization (C1081) > generates tension points
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Diff (C1084) > detects added constraints
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Diff (C1084) > detects removed constraints
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > ConstraintUsageTracker (C1097) > tracks events and computes stats
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > ConstraintUsageTracker (C1097) > finds most used constraints
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Ear Training (C1442) > generates interval exercises
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Ear Training (C1442) > generates chord exercises
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Phrase Adaptation (C877, C878) > transposes phrase to target key
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Phrase Adaptation (C877, C878) > scales rhythm for tempo change
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Prolog Preview (C1052) > generates key constraint preview
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Prolog Preview (C1052) > generates multi-constraint preview
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Explain Constraint (C1054) > explains key constraint
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Explain Constraint (C1054) > handles unknown constraint types
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > has starter listings
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > searches by query
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > filters by culture
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Target Note Practice (C1436) > generates practice for known chords
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Target Note Practice (C1436) > increases targets with difficulty
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Card Pack Prolog Bundling (C1032) > extracts predicates from Prolog code
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Inline Prolog Snippets (C1033) > namespaces predicates
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > validates correct Prolog
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > detects missing period
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > skips comments
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Round-Trip Tests (C921) > changing spec constraints updates recommendations
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Round-Trip Tests (C921) > accept recommendation → modify → new recommendations differ
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Visualization Updates (C1089) > pitch class display updates on scale change
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Constraint Visualization Updates (C1089) > beat grid updates on meter change
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Generic Editor Parameter Types (C1087) > editor fields handle all basic theory card params
     → Cannot read properties of undefined (reading 'Key')
   ❯ src/ai/theory/spec-event-bus.test.ts > Celtic Workflow Integration (C760) > full Celtic workflow: tune type → form → ornaments → set
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Chinese Workflow Integration (C857) > full Chinese workflow: mode → heterophony → ornaments
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > LCC Workflow Integration (C1200) > full LCC workflow: scale → voicing → voice leading
     → actual value must be number or bigint, received "undefined"
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Arranging Workflow (C1350) > full jazz workflow: voicing → reharmonization → solo section
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Improv Workflow (C1445) > full improv workflow: vocabulary → patterns → practice
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Custom Constraint Ecosystem Integration (C1099) > full ecosystem: define → register → search → preview → explain
     → Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Theory Cross-Phase Validation > C1447 LCC constraints work with jazz voicings
     → fromChord.join is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Jazz Theory Cross-Phase Validation > C1448 jazz voicings work with reharmonization
     → expected undefined to be truthy
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1474 spectral analysis produces correct centroids
     → actual value must be number or bigint, received "object"
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1490 spectral morphing interpolates correctly
     → Cannot read properties of undefined (reading 'amplitude')
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1530 parsimonious path finds smooth voice leading
     → expected undefined not to be undefined
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C15 — Film Scoring Tests > C1694 composer style matching returns valid results
     → cueFeatures.join is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C15 — Film Scoring Tests > C1699 emotion and composer systems integrate
     → features.map is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1746 raga details include fusion-compatible data
     → expected undefined not to be undefined
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1776 maqam details include modulation info
     → expected undefined not to be undefined
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1789 maqam + emotion model cross-validation
     → features.map is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2090 all cultures work with emotion models
     → features.map is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2095 popular music final integration
     → adapter.loadProgram is not a function
   ❯ src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2096 film scoring final integration
     → features.map is not a function
 ✓ src/gofai/nl/__tests__/fuzz-tokenizer.test.ts  (381 tests) 35ms
 ✓ src/audio/web-midi.test.ts  (54 tests) 9ms
 ✓ src/cards/organ.test.ts  (117 tests) 23ms
 ✓ src/gofai/nl/__tests__/paraphrase-invariance.test.ts  (103 tests) 10ms
 ✓ src/audio/event-flattener.test.ts  (48 tests) 13ms
 ✓ src/cards/score-notation.test.ts  (45 tests) 11ms
 ✓ src/cards/pad-synth.test.ts  (107 tests) 20ms
 ✓ src/cards/loop-player.test.ts  (87 tests) 18ms
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: beginners see basic features only
[FeatureId] Unknown feature ID format: 'basic_board_switcher'

 ✓ src/cards/arpeggiator.test.ts  (88 tests | 2 skipped) 36ms
 ✓ src/cards/sequencer.test.ts  (79 tests | 2 skipped) 20ms
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: beginners see basic features only
[FeatureId] Unknown feature ID format: 'ai_advisor'

 ✓ src/ui/arrangement-operations.test.ts  (44 tests) 8ms
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: advanced users see advanced features
[FeatureId] Unknown feature ID format: 'ai_advisor'

stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: advanced users see advanced features
[FeatureId] Unknown feature ID format: 'pattern_editor'

 ✓ src/cards/recording-manager.test.ts  (46 tests) 11ms
 ✓ src/cards/sampler.test.ts  (73 tests) 12ms
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: experts see everything
[FeatureId] Unknown feature ID format: 'basic_board_switcher'
[FeatureId] Unknown feature ID format: 'simple_generator'
[FeatureId] Unknown feature ID format: 'pattern_editor'
[FeatureId] Unknown feature ID format: 'sample_browser'
[FeatureId] Unknown feature ID format: 'basic_mixer'
[FeatureId] Unknown feature ID format: 'phrase_library'
[FeatureId] Unknown feature ID format: 'harmony_display'
[FeatureId] Unknown feature ID format: 'chord_track'
[FeatureId] Unknown feature ID format: 'automation_basic'
[FeatureId] Unknown feature ID format: 'effect_chain'
[FeatureId] Unknown feature ID format: 'ai_advisor'
[FeatureId] Unknown feature ID format: 'routing_overlay'
[FeatureId] Unknown feature ID format: 'modulation_matrix'
[FeatureId] Unknown feature ID format: 'counterpoint_checker'
[FeatureId] Unknown feature ID format: 'advanced_automation'
[FeatureId] Unknown feature ID format: 'spectrum_analyzer'
[FeatureId] Unknown feature ID format: 'custom_prolog_rules'
[FeatureId] Unknown feature ID format: 'kb_editor'
[FeatureId] Unknown feature ID format: 'performance_profiler'
[FeatureId] Unknown feature ID format: 'script_editor'

stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Feature Visibility (N128) > N133: beginners see limited features
[FeatureId] Unknown feature ID format: 'basic_board_switcher'
[FeatureId] Unknown feature ID format: 'simple_generator'
[FeatureId] Unknown feature ID format: 'pattern_editor'
[FeatureId] Unknown feature ID format: 'sample_browser'
[FeatureId] Unknown feature ID format: 'basic_mixer'

 ✓ src/audio/drum-patterns.test.ts  (73 tests) 25ms
stderr | src/audio/drum-patterns.test.ts > Clip Creation > createArrangementClip > should return null for invalid pattern IDs
Pattern not found: nonexistent-pattern

stderr | src/audio/drum-patterns.test.ts > DrumPatternPlayer > should return false for unknown pattern ID
Pattern not found: nonexistent

stderr | src/audio/drum-patterns.test.ts > Sampler Integration > quickPlayPattern > should return null for unknown pattern
Pattern not found: unknown

 ✓ src/gofai/nl/__tests__/performance-latency.test.ts  (51 tests) 6ms
 ✓ src/ui/visualization.test.ts  (82 tests) 13ms
 ✓ src/gofai/canon/__tests__/effect-taxonomy.test.ts  (77 tests) 11ms
 ✓ src/audio/sampler-core.test.ts  (59 tests) 32ms
 ✓ src/ai/theory/canonical-representations.test.ts  (73 tests) 11ms
 ✓ src/gofai/canon/__tests__/goals-constraints-preferences.test.ts  (48 tests) 8ms
 ✓ src/export/project-exchange.test.ts  (33 tests | 12 skipped) 7ms
 ✓ src/ui/components.test.ts  (72 tests) 12ms
stdout | src/cards/phrase-system.test.ts > Phrase System > IdeaTool - rateIdea() > should accept rating for an idea
Rated idea idea-1769777411207 with 5 stars

 ✓ src/cards/phrase-system.test.ts  (48 tests) 19ms
 ❯ src/gofai/eval/constraint-violation-tests.test.ts  (0 test)
stdout | src/performance/performance-mode.test.ts > Performance Mode Store > panic > adds warning on panic
PANIC: Stopping all audio

stdout | src/performance/performance-mode.test.ts > M150: Performance Mode Layout Accessibility > panic button accessibility > panic is available during performance
PANIC: Stopping all audio

stdout | src/performance/performance-mode.test.ts > M150: Performance Mode Layout Accessibility > panic button accessibility > panic immediately clears audio
PANIC: Stopping all audio

stdout | src/performance/performance-mode.test.ts > M369: Performance Mode Stability Under Load > recovery after panic > panic clears resources
PANIC: Stopping all audio

stdout | src/performance/performance-mode.test.ts > M369: Performance Mode Stability Under Load > recovery after panic > can continue after panic
PANIC: Stopping all audio

 ✓ src/performance/performance-mode.test.ts  (66 tests) 72ms
 ✓ src/audio/wavetable.test.ts  (56 tests) 622ms
 ✓ src/audio/midi-input-handler.test.ts  (40 tests) 9ms
 ✓ src/gofai/canon/__tests__/id-system.test.ts  (58 tests) 15ms
 ✓ src/cards/chord-progression.test.ts  (70 tests | 2 skipped) 25ms
 ✓ src/cards/melody.test.ts  (71 tests | 2 skipped) 26ms
 ✓ src/ai/learning/preset-tagging.test.ts  (44 tests) 12ms
 ✓ src/user-cards/deck-template-advanced.test.ts  (42 tests) 11ms
 ✓ src/audio/audio-engine.test.ts  (49 tests) 9ms
 ✓ src/cards/drum-kit.test.ts  (62 tests) 16ms
 ❯ src/gofai/eval/planning-golden-suite.test.ts  (17 tests | 16 failed) 9ms
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate deterministic plan for "make it darker"
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate plan for "increase lift" with texture opcodes
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate plan for "make it wider" with production opcodes
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate minimal plan for small changes
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Scoped Planning > should restrict plan to chorus only when scope specified
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Scoped Planning > should plan differently for verse vs chorus with same goal
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should preserve melody when constrained
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should only change drums when constrained
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should choose lower-cost plan when constraints limit options
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Multi-Objective Planning > should handle complementary goals efficiently
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Multi-Objective Planning > should handle conflicting goals by choosing balanced plan
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should produce identical plans across multiple runs
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should have stable ranking when scores are equal
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should produce byte-identical serialization
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Edge Cases > should handle empty project gracefully
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Edge Cases > should handle impossible constraints gracefully
     → Cannot read properties of undefined (reading 'maxDepth')
 ✓ src/audio/sampler-modulation.test.ts  (56 tests) 30ms
 ✓ src/audio/sample-manipulation-ui.test.ts  (40 tests) 26ms
 ✓ src/ui/layout.test.ts  (66 tests) 7ms
 ✓ src/notation/editing.test.ts  (39 tests) 8ms
 ✓ src/cards/modulation.test.ts  (43 tests) 9ms
 ✓ src/audio/sample-editor.test.ts  (43 tests) 138ms
 ✓ src/cards/graph.test.ts  (32 tests) 8ms
 ✓ src/gofai/canon/__tests__/extension-semantics.test.ts  (33 tests) 6ms
 ✓ src/ai/queries/workflow-queries.test.ts  (50 tests) 1294ms
 ✓ src/audio/scheduler.test.ts  (63 tests) 9ms
stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Board Switcher Workflow > should allow switching between boards via switcher
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Board Switcher Workflow > should preserve recent boards list across switches
Notation (Manual) board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Tracker + Phrases board activated
Tracker + Phrases board deactivated
AI Arranger board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Board Switcher Workflow > should handle rapid board switching without errors
AI Arranger board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Phrase Drag and Drop > should make phrase events visible in all views
Notation + Harmony board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Generative Clip Creation > should create clip in session grid and make it visible in timeline
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Generative Clip Creation > should preserve generator metadata across board switches
Basic Session board deactivated
Generative Ambient board activated
Generative Ambient board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Cross-View Editing > should sync edits between tracker and notation views
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Board Persistence > should persist board preferences across switches
Basic Tracker board deactivated
Session + Generators board activated
Session + Generators board deactivated
Notation + Harmony board activated

stdout | src/boards/__tests__/board-system-end-to-end.test.ts > Board System End-to-End > Performance > should handle 100 rapid board switches without memory growth
Notation + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated
Session + Generators board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}
Tracker + Harmony board deactivated
Notation + Harmony board activated

 ✓ src/boards/__tests__/board-system-end-to-end.test.ts  (11 tests) 14ms
 ❯ src/gofai/eval/plan-explanation-tests.test.ts  (21 tests | 21 failed) 16ms
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should link every goal to at least one opcode
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should provide reason for every opcode
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should link opcodes to specific goals in reason text
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should handle multi-goal plans with clear attribution
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should track provenance from lexeme to opcode
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should preserve provenance through planning stages
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should track which rule/strategy generated each opcode
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should include extension namespace in provenance when applicable
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should generate user-friendly explanation text
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should explain what each opcode does
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should explain why each opcode was chosen
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should group related opcodes in explanation
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should mention constraints that were respected
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "what changed?"
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "why did it change?"
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "what was kept fixed?"
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should explain tradeoffs when goals conflict
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should explain why alternatives were rejected
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should generate identical explanations for identical plans
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should maintain explanation across serialization
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should handle missing provenance gracefully
     → Cannot read properties of undefined (reading 'maxDepth')
 ✓ src/ui/onboarding.test.ts  (49 tests) 12ms
 ✓ src/ui/session-recording.test.ts  (25 tests) 8ms
 ❯ src/gofai/eval/planning-performance-tests.test.ts  (21 tests | 21 failed) 14ms
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan simple single-axis goal in < 100ms
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan multi-axis goals in < 500ms
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan chorus-scope edit in < 1s
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan constrained goals in < 2s
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan full-song scope in < 5s
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should use < 50MB for simple planning
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should use < 100MB for complex planning
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should not leak memory across multiple planning runs
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should scale linearly with project length
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should scale sub-linearly with goal count
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should handle large fixtures efficiently
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should benefit from scoped planning
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Throughput > should generate multiple plans per second
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Throughput > should maintain throughput with caching
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle pathological goal combinations
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle deep constraint hierarchies
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should prune search space effectively
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle empty fixtures gracefully
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should timeout or fail gracefully on impossible requests
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Regression Guards > should maintain baseline performance across refactors
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Regression Guards > should not regress on typical use cases
     → Cannot read properties of undefined (reading 'maxDepth')
 ✓ src/gofai/canon/__tests__/domain-nouns-batches-16-18.test.ts  (49 tests) 31ms
 ✓ src/audio/synth.test.ts  (56 tests) 13ms
 ❯ src/gofai/eval/least-change-tests.test.ts  (20 tests | 17 failed) 10ms
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should prefer lower-cost plan when both satisfy goals
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should minimize opcode count for simple goals
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should prefer non-destructive edits
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should rank plans by total cost
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Cost Hierarchy > should prefer production changes over event changes
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Cost Hierarchy > should calculate costs consistently
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request aggressive editing
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request minimal editing
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request rewrite
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Tie-Breaking > should use deterministic tie-breaker when costs are equal
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Tie-Breaking > should maintain stable ordering across multiple runs
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should scale cost with goal magnitude
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should have proportional cost increase for multiple goals
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should avoid exponential cost growth
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should handle zero-cost plans (identity)
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should cap maximum cost
     → Cannot read properties of undefined (reading 'maxDepth')
   ❯ src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should handle negative costs gracefully
     → Cannot read properties of undefined (reading 'maxDepth')
stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Advanced Features Override (N130) > shows all features when override is active
[FeatureId] Unknown feature ID format: 'basic_chords'
[FeatureId] Unknown feature ID format: 'major_minor_scales'
[FeatureId] Unknown feature ID format: 'simple_progressions'
[FeatureId] Unknown feature ID format: 'basic_drum_patterns'
[FeatureId] Unknown feature ID format: 'simple_melodies'
[FeatureId] Unknown feature ID format: 'seventh_chords'
[FeatureId] Unknown feature ID format: 'modes'
[FeatureId] Unknown feature ID format: 'secondary_dominants'
[FeatureId] Unknown feature ID format: 'syncopation'
[FeatureId] Unknown feature ID format: 'phrase_variation'
[FeatureId] Unknown feature ID format: 'basic_voice_leading'
[FeatureId] Unknown feature ID format: 'extended_harmony'
[FeatureId] Unknown feature ID format: 'modal_interchange'
[FeatureId] Unknown feature ID format: 'tritone_substitution'
[FeatureId] Unknown feature ID format: 'counterpoint'
[FeatureId] Unknown feature ID format: 'polyrhythm'
[FeatureId] Unknown feature ID format: 'advanced_voice_leading'
[FeatureId] Unknown feature ID format: 'reharmonization'
[FeatureId] Unknown feature ID format: 'twelve_tone'
[FeatureId] Unknown feature ID format: 'spectral_harmony'
[FeatureId] Unknown feature ID format: 'generative_composition'
[FeatureId] Unknown feature ID format: 'microtonal'
[FeatureId] Unknown feature ID format: 'complex_polyrhythm'
[FeatureId] Unknown feature ID format: 'advanced_orchestration'

stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Advanced Features Override (N130) > respects skill level when override is disabled
[FeatureId] Unknown feature ID format: 'basic_board_switcher'
[FeatureId] Unknown feature ID format: 'simple_generator'
[FeatureId] Unknown feature ID format: 'pattern_editor'
[FeatureId] Unknown feature ID format: 'sample_browser'
[FeatureId] Unknown feature ID format: 'basic_mixer'

stderr | src/ai/queries/persona-queries.test.ts > Persona-Specific Query Functions > Advanced Features Override (N130) > respects skill level when override is disabled
[FeatureId] Unknown feature ID format: 'basic_board_switcher'
[FeatureId] Unknown feature ID format: 'simple_generator'
[FeatureId] Unknown feature ID format: 'pattern_editor'
[FeatureId] Unknown feature ID format: 'sample_browser'
[FeatureId] Unknown feature ID format: 'basic_mixer'
[FeatureId] Unknown feature ID format: 'phrase_library'
[FeatureId] Unknown feature ID format: 'harmony_display'
[FeatureId] Unknown feature ID format: 'chord_track'
[FeatureId] Unknown feature ID format: 'automation_basic'
[FeatureId] Unknown feature ID format: 'effect_chain'
[FeatureId] Unknown feature ID format: 'ai_advisor'
[FeatureId] Unknown feature ID format: 'routing_overlay'
[FeatureId] Unknown feature ID format: 'modulation_matrix'
[FeatureId] Unknown feature ID format: 'counterpoint_checker'
[FeatureId] Unknown feature ID format: 'advanced_automation'
[FeatureId] Unknown feature ID format: 'spectrum_analyzer'
[FeatureId] Unknown feature ID format: 'custom_prolog_rules'
[FeatureId] Unknown feature ID format: 'kb_editor'
[FeatureId] Unknown feature ID format: 'performance_profiler'
[FeatureId] Unknown feature ID format: 'script_editor'

 ✓ src/ai/queries/persona-queries.test.ts  (164 tests) 5219ms
stderr | src/ai/engine/performance-regression.test.ts > AI Performance Tests (N164) > Slow Query Logger > logs slow queries when enabled
[SlowQuery] 100.0ms (+50.0ms over budget) 
  Query: slow_query(X) 
  Source: test 
  Time: 2026-01-30T12:50:13.833Z

stderr | src/ai/engine/performance-regression.test.ts > AI Performance Tests (N164) > Slow Query Logger > calls alert callbacks
[SlowQuery] 100.0ms (+50.0ms over budget) 
  Query: alert_query(X) 
  Source: test 
  Time: 2026-01-30T12:50:13.837Z
[SlowQuery] 100.0ms (+50.0ms over budget) 
  Query: another_query(X) 
  Source: test 
  Time: 2026-01-30T12:50:13.838Z

stderr | src/ai/engine/performance-regression.test.ts > AI Performance Tests (N164) > Slow Query Logger > generates summary statistics
[SlowQuery] 60.0ms (+10.0ms over budget) 
  Query: slow_0(X) 
  Source: module-a 
  Time: 2026-01-30T12:50:13.838Z
[SlowQuery] 70.0ms (+20.0ms over budget) 
  Query: slow_1(X) 
  Source: module-a 
  Time: 2026-01-30T12:50:13.839Z
[SlowQuery] 80.0ms (+30.0ms over budget) 
  Query: slow_2(X) 
  Source: module-a 
  Time: 2026-01-30T12:50:13.839Z
[SlowQuery] 90.0ms (+40.0ms over budget) 
  Query: slow_3(X) 
  Source: module-b 
  Time: 2026-01-30T12:50:13.839Z
[SlowQuery] 100.0ms (+50.0ms over budget) 
  Query: slow_4(X) 
  Source: module-b 
  Time: 2026-01-30T12:50:13.839Z

 ✓ src/ai/engine/performance-regression.test.ts  (24 tests) 29ms
 ✓ src/audio/audio-optimization.test.ts  (47 tests) 13ms
 ✓ src/audio/mixer.test.ts  (54 tests) 12ms
 ✓ src/gofai/canon/__tests__/vocabulary-policy.test.ts  (57 tests) 16ms
stderr | src/ai/advisor/advisor-interface.test.ts > AIAdvisor > board questions > should list boards when asked generically
Error getting answer: [object Object]

 ✓ src/audio/sample-mapper.test.ts  (38 tests) 131ms
 ✓ src/ai/advisor/advisor-interface.test.ts  (41 tests) 1163ms
stderr | src/ai/queries/board-queries.test.ts > Board & Deck Query Functions > Tutorial Sequence (L118) > should get tutorial sequence for board
Error getting answer: [object Object]

stderr | src/ai/queries/board-queries.test.ts > Board & Deck Query Functions > Tutorial Sequence (L118) > should get empty state suggestion for deck
Error getting answer: [object Object]

 ✓ src/audio/sample.test.ts  (51 tests) 8ms
stderr | src/ai/queries/board-queries.test.ts > Board & Deck Query Functions > Tutorial Sequence (L118) > should get help topic for action
Error getting answer: [object Object]

 ✓ src/tracks/auto-coloring.test.ts  (49 tests) 10ms
stderr | src/ai/queries/board-queries.test.ts > Board & Deck Query Functions > Performance & Accessibility > should get accessibility rules for deck
Error getting answer: [object Object]

 ✓ src/mixer/reference-player.test.ts  (58 tests) 10ms
 ✓ src/cards/registry.test.ts  (38 tests) 16ms
 ✓ src/ai/queries/board-queries.test.ts  (41 tests) 1745ms
 ✓ src/ui/tooltips.test.ts  (43 tests) 8ms
 ✓ src/audio/freesound.test.ts  (37 tests) 12ms
 ✓ src/streams/stream.test.ts  (35 tests) 10ms
 ✓ src/notation/event-bridge.test.ts  (29 tests) 13ms
 ✓ src/ai/engine/kb-memory-profiler.test.ts  (24 tests) 36ms
 ✓ src/cards/audio-transforms.test.ts  (43 tests) 8ms
 ✓ src/cards/keyboard-instruments.test.ts  (47 tests) 11ms
 ✓ src/tests/integration-verification.test.ts  (12 tests) 10ms
stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports template with all metadata
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports template with streams and clips
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports template with board configuration
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports template with versioning info
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports template as serializable JSON
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O025: Template Export > exports multiple templates as a collection
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template has required metadata fields
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template streams have valid structure
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template clips reference valid streams
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template board references exist
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template has no missing assets
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template difficulty levels are valid
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates template tags are non-empty
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > O026: Template Asset Validation > validates estimated time format
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > Template Package Validation > validates complete template package structure
Registered 9 builtin templates

stdout | src/boards/templates/template-validation.test.ts > Template Export and Validation (O025-O026) > Template Package Validation > validates template package size is reasonable
Registered 9 builtin templates

 ✓ src/boards/templates/template-validation.test.ts  (17 tests) 11ms
stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Cross-board data sharing > should share streams across all boards
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Cross-board data sharing > should share clips across all boards
Basic Session board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Basic Session board activated
Basic Session board deactivated
Basic Sampler board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Cross-board data sharing > should preserve routing graph across boards
Basic Sampler board deactivated
Modular Routing board activated
Modular Routing board deactivated
Producer board activated
Producer board deactivated
Live Performance board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Project format consistency > should serialize and deserialize projects across boards
Live Performance board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Project format consistency > should not duplicate data when switching boards
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated
Basic Session board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Active context preservation > should preserve active stream when requested
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Active context preservation > should preserve active clip when requested
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Active context preservation > should clear context when preservation not requested
Basic Session board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Board-specific state isolation > should isolate per-board layout state
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Board-specific state isolation > should isolate per-board deck state
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Data integrity > should maintain event ordering across board switches
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/project-compatibility.test.ts > K004: Project Compatibility > Data integrity > should maintain clip-stream references
Basic Session board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Basic Session board activated

 ✓ src/boards/__tests__/project-compatibility.test.ts  (12 tests) 6ms
 ✓ src/cards/card.test.ts  (23 tests) 8ms
stderr | src/ai/engine/prolog-adapter.test.ts > PrologAdapter > Query result structure > should return error for invalid query
Error getting answer: [object Object]

stderr | src/ai/engine/prolog-adapter.test.ts > PrologAdapter > Reset and reload > should reset session and clear loaded programs
Error getting answer: [object Object]

 ✓ src/ai/engine/prolog-adapter.test.ts  (35 tests | 1 skipped) 235ms
 ✓ src/export/stem-export.test.ts  (48 tests) 1334ms
stderr | src/ai/engine/lifecycle-perf.test.ts > KB Lifecycle & Performance (L375-L387) > L386: Performance budgets > PerfMonitor getSlowQueries identifies slow queries
[PerfMonitor] Slow query (500.0ms): slow(X)

stderr | src/ai/engine/lifecycle-perf.test.ts > KB Lifecycle & Performance (L375-L387) > L375: Query batch > createQueryBatch reports failure for invalid queries
Error getting answer: [object Object]

 ✓ src/ui/components/export-dialog.test.ts  (49 tests) 231ms
 ✓ src/ai/engine/lifecycle-perf.test.ts  (30 tests) 3639ms
 ✓ src/ai/queries/composition-queries.test.ts  (38 tests) 2726ms
 ✓ src/audio/sample-slicer.test.ts  (29 tests) 9ms
 ✓ src/ui/theme.test.ts  (55 tests) 8ms
 ✓ src/user-cards/card-editor-panel.test.ts  (35 tests) 89ms
 ✓ src/audio/dynamics-analyzer.test.ts  (39 tests) 10ms
 ✓ src/export/comments.test.ts  (26 tests) 6ms
stderr | src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should switch between generative boards preserving context
Cannot switch to board "ai-arranger": board not found in registry

stderr | src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should maintain recent boards list across generative board switches
Cannot switch to board "ai-arranger": board not found in registry
Cannot switch to board "ai-composition": board not found in registry
Cannot switch to board "generative-ambient": board not found in registry

 ❯ src/boards/builtins/phase-h-integration.test.ts  (38 tests | 5 failed) 21ms
   ❯ src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > AI Arranger Board (H001-H025) > H022: smoke test - arranger board registered
     → expected undefined to be { id: 'ai-arranger', …(21) } // Object.is equality
   ❯ src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > AI Composition Board (H026-H050) > H047: smoke test - generate draft creates clip + events, visible in notation and tracker
     → expected undefined to be { id: 'ai-composition', …(21) } // Object.is equality
   ❯ src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Generative Ambient Board (H051-H075) > H071: smoke test - ambient board registered
     → expected undefined to be { id: 'generative-ambient', …(21) } // Object.is equality
   ❯ src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should switch between generative boards preserving context
     → expected null to be 'ai-arranger' // Object.is equality
   ❯ src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should maintain recent boards list across generative board switches
     → expected [] to include 'ai-arranger'
stderr | src/boards/decks/factory-registry.test.ts > DeckFactoryRegistry > registerFactory > should replace existing factory
Deck factory for "arrangement-deck" already registered, replacing

stderr | src/boards/decks/factory-registry.test.ts > DeckFactoryRegistry > unregisterFactory > should not throw when unregistering nonexistent factory
[CardPlay] Unknown DeckType "nonexistent" - not in canonical set

 ✓ src/boards/decks/factory-registry.test.ts  (26 tests) 8ms
 ✓ src/storage/indexeddb-backend.test.ts  (24 tests) 270ms
 ✓ src/export/collaboration-workflow.test.ts  (10 tests | 2 skipped) 5ms
stderr | src/boards/switching/switch-board.test.ts > switchBoard > basic switching > should return false for invalid board
Cannot switch to board "nonexistent-board": board not found in registry

stderr | src/boards/switching/switch-board.test.ts > switchBoard > lifecycle hooks > should handle lifecycle hook errors gracefully
Error in board onActivate hook: Error: Activation failed
    at Object.onActivate (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.test.ts:313:35)
    at Module.switchBoard (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.ts:110:19)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.test.ts:320:20
    at Proxy.assertThrows (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/core/assertions.js:2644:7)
    at Proxy.methodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/addMethod.js:57:25)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:850:16)
    at Proxy.overwritingMethodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/overwriteMethod.js:78:33)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:1324:19)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:800:17)
    at Proxy.methodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/addMethod.js:57:25)
Error in board onDeactivate hook: Error: Deactivation failed
    at Object.onDeactivate (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.test.ts:314:37)
    at Module.switchBoard (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.ts:57:20)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/boards/switching/switch-board.test.ts:321:20
    at Proxy.assertThrows (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/core/assertions.js:2644:7)
    at Proxy.methodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/addMethod.js:57:25)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:850:16)
    at Proxy.overwritingMethodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/overwriteMethod.js:78:33)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:1324:19)
    at Proxy.<anonymous> (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/expect/dist/index.js:800:17)
    at Proxy.methodWrapper (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/chai/lib/chai/utils/addMethod.js:57:25)

 ✓ src/boards/switching/switch-board.test.ts  (21 tests) 14ms
stderr | src/audio/midi-mapping.test.ts > MIDI Mapping System > preset management > handles invalid JSON
Failed to parse MIDI preset JSON: SyntaxError: Unexpected token 'i', "invalid json" is not valid JSON
    at JSON.parse (<anonymous>)
    at Module.presetFromJSON (/Users/halleyyoung/Documents/behavioral/cardplay/src/audio/midi-mapping.ts:423:25)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/audio/midi-mapping.test.ts:350:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runFiles (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:958:5)

 ✓ src/audio/midi-mapping.test.ts  (29 tests) 22ms
 ❯ src/boards/__tests__/drag-drop-integration.test.ts  (9 tests | 5 failed) 17ms
   ❯ src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E079: Phrase drop writes events into store > should write phrase notes to active stream
     → expected undefined to be 'note' // Object.is equality
   ❯ src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E079: Phrase drop writes events into store > should handle empty phrase gracefully
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E080: Disallowed drops rejected with reason > should reject generator card drop on manual-only deck
     → expected 'No handler registered for card-templa…' to contain 'generator'
   ❯ src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > Drop handler undo integration > should mark drop as undoable when successful
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > Multi-track phrase drops > should handle phrases with multiple tracks
     → expected false to be true // Object.is equality
stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What persists across board switches > should persist all streams and events
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What persists across board switches > should persist all clips and clip registry
Notation (Manual) board deactivated
Basic Session board activated
Basic Session board deactivated
Producer board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What persists across board switches > should persist recent boards list
Producer board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What persists across board switches > should persist favorite boards
Basic Session board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What persists across board switches > should persist per-board layout preferences
Basic Session board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What resets on board switch > should reset layout when resetLayout option is true
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What resets on board switch > should reset deck state when resetDecks option is true
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What resets on board switch > should reset active context when preserveActiveContext is false
Basic Tracker board deactivated
Basic Tracker board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What migrates during board switch > should migrate active stream to new board when preserving context
Basic Tracker board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What migrates during board switch > should maintain stream visibility across compatible boards
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Piano Roll Producer board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > What migrates during board switch > should maintain clip references across session/arrangement boards
Piano Roll Producer board deactivated
Basic Session board activated
Basic Session board deactivated
Producer board activated
Producer board deactivated
Live Performance board activated

stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > Board lifecycle hooks > should update current board ID on switch
Live Performance board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

 ✓ src/boards/__tests__/board-switching-semantics.test.ts  (15 tests) 6ms
stdout | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > Board lifecycle hooks > should add board to recent list on switch
Basic Session board deactivated
Basic Tracker board activated

stderr | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > Error handling during board switch > should handle switch to non-existent board gracefully
Cannot switch to board "non-existent-board": board not found in registry

stderr | src/boards/__tests__/board-switching-semantics.test.ts > K005: Board Switching Semantics > Error handling during board switch > should preserve data even if switch fails
Cannot switch to board "invalid-board": board not found in registry

 ✓ src/events/operations.test.ts  (40 tests) 7ms
 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts  (23 tests | 9 failed) 14ms
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical axis IDs
     → expected false to be true // Object.is equality
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical opcode IDs
     → expected false to be true // Object.is equality
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical constraint type IDs
     → expected false to be true // Object.is equality
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Lexeme Binding Stability > should preserve section lexeme bindings
     → expected 0 to be greater than 0
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Lexeme Binding Stability > should preserve layer lexeme bindings
     → expected 0 to be greater than 0
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > ID Format Stability > should maintain opcode ID format (op:name)
     → expected 'opcode:change' to match /^(op:|[a-z_]+:op:)/
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > ID Format Stability > should maintain lexeme ID format (lex:category:name)
     → expected 'lexeme:make:verb' to match /^(lex:|[a-z_]+:lex:)/
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Backwards Compatibility > should maintain minimum entity counts (no accidental deletions)
     → expected 54 to be greater than or equal to 100
   ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Semantic Stability > should maintain section role consistency
     → expected undefined not to be undefined
stderr | src/canon/__tests__/id-tables.test.ts > CANONICAL_EVENT_KINDS table > normalizes legacy aliases to canonical names
[CardPlay] Deprecated EventKind "control_change" - use "control" instead. See docs/event-kind-schemas.md for canonical values.
[CardPlay] Deprecated EventKind "pitch_bend" - use "pitchBend" instead. See docs/event-kind-schemas.md for canonical values.
[CardPlay] Deprecated EventKind "program_change" - use "program" instead. See docs/event-kind-schemas.md for canonical values.

stderr | src/canon/__tests__/id-tables.test.ts > BUILTIN_FEATURE_IDS table > normalizes legacy feature strings
[FeatureId] Legacy feature string 'pattern-editor' should be 'feature:editor:pattern-editor'
[FeatureId] Legacy feature string 'piano-roll' should be 'feature:editor:piano-roll'

stderr | src/canon/__tests__/id-tables.test.ts > LEGACY_DECK_TYPE_ALIASES table > maps legacy names to canonical names
[CardPlay] Deprecated DeckType "pattern-editor" - use "pattern-deck" instead. See docs/canon/ids.md for canonical values.
[CardPlay] Deprecated DeckType "piano-roll" - use "piano-roll-deck" instead. See docs/canon/ids.md for canonical values.
[CardPlay] Deprecated DeckType "notation-score" - use "notation-deck" instead. See docs/canon/ids.md for canonical values.

 ✓ src/canon/__tests__/id-tables.test.ts  (38 tests) 9ms
 ✓ src/export/collaboration-metadata.test.ts  (16 tests) 5ms
 ✓ src/audio/pitch-detect.test.ts  (43 tests) 99ms
 ✓ src/ui/tests/spectrum-preset-browser.test.ts  (23 tests) 5ms
 ✓ src/cards/phrase-midi.test.ts  (20 tests) 6ms
 ✓ src/voices/voice.test.ts  (39 tests) 8ms
 ✓ src/cards/choir.test.ts  (29 tests) 9ms
 ✓ src/export/project-diff.test.ts  (15 tests) 6ms
 ✓ src/boards/deck-packs/deck-packs.test.ts  (20 tests) 753ms
stderr | src/boards/deck-packs/deck-packs.test.ts > Deck Pack Factory Coverage (Change 199) > all deck pack deck types have registered factories
Deck packs reference DeckTypes without factories: [
  'essential-production/mixer-deck',
  'essential-production/transport-deck',
  'essential-production/instruments-deck',
  'essential-production/properties-deck',
  'notation-essentials/notation-deck',
  'notation-essentials/properties-deck',
  'notation-essentials/instruments-deck',
  'notation-essentials/dsp-chain',
  'sound-design-lab/routing-deck',
  'sound-design-lab/spectrum-analyzer-deck',
  'sound-design-lab/waveform-editor-deck',
  'sound-design-lab/modulation-matrix-deck',
  'sound-design-lab/properties-deck'
]

 ❯ src/boards/__tests__/phase-g-integration.test.ts  (8 tests | 8 failed) 11ms
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G026-G027: Chord tracking and undo > G026: should update tracker coloring when chord changes
     → Cannot read properties of undefined (reading 'CHORD')
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G026-G027: Chord tracking and undo > G027: should make chord edits undoable
     → Cannot read properties of undefined (reading 'CHORD')
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G055: should show phrase library deck on Tracker+Phrases board
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G056: should write correct event timings when dropping phrase
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G057: should make phrase drop undoable
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Tracker+Harmony Board > should have harmony display deck visible
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Session+Generators Board > should have generator deck visible
     → expected false to be true // Object.is equality
   ❯ src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Notation+Harmony Board > should have notation and harmony decks
     → expected false to be true // Object.is equality
 ✓ src/boards/layout/serialize.test.ts  (20 tests) 5ms
stderr | src/boards/templates/registry.test.ts > TemplateRegistry > O018: Template Loading > replaces duplicate template IDs with warning
Template duplicate-test already registered, replacing

 ✓ src/boards/templates/registry.test.ts  (11 tests) 5ms
 ✓ src/cards/stack.test.ts  (25 tests) 6ms
stdout | src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > I024: Session clip selection updates notation/tracker editor > should update active context when selecting clip
Session + Generators board activated

stdout | src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > K009: Edit same stream in tracker and notation > should show edits from tracker in notation
Session + Generators board deactivated
Notation + Harmony board activated

stdout | src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > K009: Edit same stream in tracker and notation > should show edits from notation in tracker
Notation + Harmony board deactivated
Tracker + Harmony board activated
Restored harmony context: {
  showHarmonyColors: false,
  showRomanNumerals: false,
  currentKey: 'C',
  currentChord: null
}

 ❯ src/boards/__tests__/cross-view-sync.integration.test.ts  (9 tests | 4 failed) 16ms
   ❯ src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > I024: Session clip selection updates notation/tracker editor > should update active context when selecting clip
     → object is not iterable (cannot read property Symbol(Symbol.iterator))
   ❯ src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > I024: Session clip selection updates notation/tracker editor > should maintain selection across board switches
     → object is not iterable (cannot read property Symbol(Symbol.iterator))
   ❯ src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > Selection synchronization > should sync selection across tracker/piano roll/notation
     → object is not iterable (cannot read property Symbol(Symbol.iterator))
   ❯ src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > Selection synchronization > should clear selection when switching with clearSelection option
     → object is not iterable (cannot read property Symbol(Symbol.iterator))
stdout | src/audio/worklet.test.ts > workletDebug > should not throw when enabled
[Worklet] test

 ✓ src/audio/worklet.test.ts  (35 tests) 15ms
 ✓ src/ai/queries/feature-derivation.test.ts  (20 tests) 8ms
 ✓ src/ai/theory/__tests__/deck-templates.test.ts  (27 tests) 9ms
 ✓ src/audio/sample-pack-manager.test.ts  (33 tests) 224ms
 ✓ src/cards/adapter.test.ts  (28 tests) 5ms
 ✓ src/extensions/__tests__/permissions.test.ts  (29 tests) 6ms
 ✓ src/user-cards/card-metadata-ui.test.ts  (37 tests) 126ms
stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > board reference validation (L126) > should pass validation when all references exist
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > board reference validation (L126) > should detect missing board references
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > contradiction detection (L127) > should pass when no contradictions exist
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > contradiction detection (L127) > should detect contradictory control levels
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > contradiction detection (L127) > should detect contradictory control levels
Error getting answer: [object Object]

 ✓ src/boards/builtins/notation-harmony-board.test.ts  (24 tests) 21ms
stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > contradiction detection (L127) > should warn about duplicate progressions
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > contradiction detection (L127) > should warn about duplicate progressions
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > dynamic KB updates (L124) > should add facts for new board
Error getting answer: [object Object]
KB validation failed after adding board 'dynamic_board': [
  {
    type: 'missing_reference',
    message: "Board 'dynamic_board' referenced in KB but not found in registry",
    location: 'board_name/2',
    details: { boardId: 'dynamic_board' }
  }
]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > dynamic KB updates (L124) > should validate KB after dynamic update
Error getting answer: [object Object]
KB validation failed after adding board 'test_board_123': [
  {
    type: 'missing_reference',
    message: "Board 'test_board_123' referenced in KB but not found in registry",
    location: 'board_name/2',
    details: { boardId: 'test_board_123' }
  }
]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > dynamic KB updates (L124) > should handle multiple dynamic boards
Error getting answer: [object Object]
KB validation failed after adding board 'board1': [
  {
    type: 'missing_reference',
    message: "Board 'board1' referenced in KB but not found in registry",
    location: 'board_name/2',
    details: { boardId: 'board1' }
  }
]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > dynamic KB updates (L124) > should handle multiple dynamic boards
Error getting answer: [object Object]
KB validation failed after adding board 'board2': [
  {
    type: 'missing_reference',
    message: "Board 'board2' referenced in KB but not found in registry",
    location: 'board_name/2',
    details: { boardId: 'board2' }
  }
]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > dynamic KB updates (L124) > should handle multiple dynamic boards
Error getting answer: [object Object]
KB validation failed after adding board 'board3': [
  {
    type: 'missing_reference',
    message: "Board 'board3' referenced in KB but not found in registry",
    location: 'board_name/2',
    details: { boardId: 'board3' }
  }
]

 ✓ src/export/board-export.test.ts  (25 tests) 6ms
stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should validate all aspects of KB
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should validate all aspects of KB
Error getting answer: [object Object]

 ✓ src/boards/store/store.test.ts  (25 tests) 9ms
stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should format validation results
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should format validation results
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should format validation results
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should format validation results
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > full KB validation > should format validation results
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle query failures gracefully
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle query failures gracefully
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle malformed KB facts
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle malformed KB facts
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle malformed KB facts
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle malformed KB facts
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > error handling > should handle malformed KB facts
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should validate after loading multiple KBs
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should validate after loading multiple KBs
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should validate after loading multiple KBs
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should detect cross-module contradictions
Error getting answer: [object Object]

stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should detect cross-module contradictions
Error getting answer: [object Object]

 ✓ src/ai/knowledge/kb-validation.test.ts  (16 tests) 225ms
stderr | src/ai/knowledge/kb-validation.test.ts > KB Validation > integration > should detect cross-module contradictions
Error getting answer: [object Object]

 ✓ src/boards/gating/manual-board-gating-smoke.test.ts  (15 tests) 9ms
 ✓ src/rules/rules.test.ts  (14 tests) 8ms
 ✓ src/ai/queries/spec-queries.test.ts  (73 tests) 12104ms
stderr | src/boards/context/store.test.ts > BoardContextStore > corrupt data handling > should fallback to default on invalid JSON
Failed to load active context: SyntaxError: Unexpected token 'o', "not valid json {{{" is not valid JSON
    at JSON.parse (<anonymous>)
    at loadContext (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/context/store.ts:37:25)
    at new BoardContextStore (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/context/store.ts:114:20)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/boards/context/store.test.ts:311:24
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)

 ✓ src/boards/context/store.test.ts  (25 tests) 12ms
 ✓ src/extensions/__tests__/examples.test.ts  (17 tests) 4ms
 ✓ src/cards/protocol.test.ts  (29 tests) 5ms
 ✓ src/ai/learning/workspace-templates.test.ts  (20 tests) 5ms
 ✓ src/types/event.test.ts  (37 tests) 8ms
 ❯ src/boards/builtins/phase-h-smoke.test.ts  (7 tests | 4 failed) 9ms
   ❯ src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H022: Arranger generates events visible in tracker/piano roll > should generate events visible across views
     → expected 0 to be greater than 0
   ❯ src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H022: Arranger generates events visible in tracker/piano roll > should preserve generated events when switching boards
     → expected undefined not to be undefined
   ❯ src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H023: Freeze prevents regeneration and is undoable > should freeze generated events
     → Cannot read properties of undefined (reading 'start')
   ❯ src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H023: Freeze prevents regeneration and is undoable > should support selective freeze (specific event IDs)
     → expected 0 to be greater than 0
 ✓ src/boards/builtins/harmony-notation-integration.test.ts  (6 tests) 10ms
 ✓ src/ai/learning/tutorial-progress.test.ts  (25 tests) 6ms
 ✓ src/notation/comparison-sync.test.ts  (18 tests) 6ms
 ✓ src/boards/layout/adapter.test.ts  (18 tests) 5ms
 ❯ src/ui/components/notation-harmony-overlay.test.ts  (9 tests | 9 failed) 5ms
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > creates overlay with toolbar buttons
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > toggles highlights when button is clicked
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > G114: snap to chord tones is undoable and preserves rhythm
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > G113: chord suggestions update context and refresh overlays
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > harmonizes selection when harmonize button is clicked
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > handles empty selection gracefully
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > handles no active stream gracefully
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > subscribes to context changes
     → Cannot read properties of undefined (reading 'NOTE')
   ❯ src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > cleans up subscription on disposal
     → Cannot read properties of undefined (reading 'NOTE')
 ✓ src/audio/freesound-api.test.ts  (27 tests) 8ms
 ✓ src/ai/learning/project-metadata.test.ts  (26 tests) 7ms
 ❯ src/ui/projections/event-projections.test.ts  (10 tests | 8 failed) 11ms
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 335: Tracker projection matches SSOT > should project events onto tracker rows
     → expected [] to have a length of 1 but got +0
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should project notes onto piano roll grid
     → expected [] to have a length of 3 but got +0
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should filter by pitch range
     → expected [] to have a length of 1 but got +0
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should track selection state
     → Cannot read properties of undefined (reading 'selected')
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should handle viewport clipping
     → expected [] to have a length of 1 but got +0
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Notation projection > should organize notes into measures
     → expected [] to have a length of 2 but got +0
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 334: Projection invalidation > should track projection version
     → expected true to be false // Object.is equality
   ❯ src/ui/projections/event-projections.test.ts > Event Projections > Change 334: Projection invalidation > should notify subscribers on invalidation
     → expected false to be true // Object.is equality
stdout | src/cards/testing/card-test.test.ts > Card Testing Framework > Test Runner > should run unit tests successfully
Result: {
  "cardId": "double-card",
  "cardName": "Double Card",
  "totalTests": 3,
  "passed": 3,
  "failed": 0,
  "skipped": 0,
  "duration": 0.5658329999987473,
  "results": [
    {
      "testId": "unit-1769777422200-0.4756726425130383",
      "testName": "should double positive number",
      "testType": "unit",
      "passed": true,
      "duration": 0.062249999999039574,
      "output": 10
    },
    {
      "testId": "unit-1769777422200-0.639800737513581",
      "testName": "should double negative number",
      "testType": "unit",
      "passed": true,
      "duration": 0.008332999999765889,
      "output": -6
    },
    {
      "testId": "unit-1769777422200-0.4273646731962639",
      "testName": "should double zero",
      "testType": "unit",
      "passed": true,
      "duration": 0.004750000000058208,
      "output": 0
    }
  ],
  "qualityScore": 100
}

 ✓ src/cards/testing/card-test.test.ts  (15 tests) 12ms
 ✓ src/ai/advisor/conversation-manager.test.ts  (30 tests) 1017ms
stderr | src/ai/theory/__tests__/host-action-handlers.test.ts > Host Action Handler Registry > Registration > should allow overriding extension handlers
HostAction handler for 'test-pack:action' re-registered (1.0.0 → 2.0.0)

 ✓ src/ai/theory/__tests__/host-action-handlers.test.ts  (17 tests) 5ms
 ✓ src/ui/components/new-project-wizard.test.ts  (14 tests) 278ms
 ✓ src/ui/utils/polish-checklist.test.ts  (19 tests) 5ms
 ✓ src/ai/learning/session-notes.test.ts  (24 tests) 5ms
 ❯ src/boards/builtins/phrase-integration.test.ts  (5 tests | 3 failed) 7ms
   ❯ src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > G056: dropping phrase writes correct event timings into SharedEventStore
     → expected undefined to be true // Object.is equality
   ❯ src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > G057: phrase drop is undoable and restores previous events
     → expected undefined to be true // Object.is equality
   ❯ src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > phrase adaptation: adapts to harmony context when available
     → expected undefined to be true // Object.is equality
 ✓ src/audio/context.test.ts  (24 tests) 115ms
stderr | issueWarning (file:/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@lit/reactive-element/src/reactive-element.ts:98:15)
Lit is in dev mode. Not recommended for production! See https://lit.dev/msg/dev-mode for more information.

 ✓ src/ui/components/command-palette.test.ts  (19 tests) 5ms
 ✓ src/ui/core-card-adapter.test.ts  (21 tests) 12ms
 ✓ src/ui/actions/harmony-actions.test.ts  (20 tests) 8ms
 ✓ src/boards/gating/get-allowed-cards.test.ts  (15 tests) 6ms
 ✓ src/boards/harmony/coloring.test.ts  (17 tests) 6ms
 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts  (14 tests | 6 failed | 5 skipped) 12ms
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should ignore missing pack with "ignore" policy
     → handleMissingPack is not a function
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should create placeholder with "placeholder" policy
     → handleMissingPack is not a function
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should propagate error with "error" policy
     → handleMissingPack is not a function
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Placeholder > should handle missing pack with placeholder behavior
     → handleMissingPack is not a function
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Invalid Manifest > should accept manifest with valid version
     → expected false to be true // Object.is equality
   ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Loading Errors > should handle extension enable failure gracefully
     → expected false to be true // Object.is equality
 ✓ src/ai/learning/help-browser.test.ts  (22 tests) 5ms
 ❯ src/boards/integration/board-switch-integration.test.ts  (13 tests | 13 failed) 14ms
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should compute visible decks for current board
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should update visible decks when board switches
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should cache visible decks for performance
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should compute allowed cards for current board
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should update allowed cards when board switches
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should provide card-specific check method
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should clear cache when board switches
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should recompute on force refresh
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should notify listeners on board switch
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should allow unsubscribe
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > isDeckCurrentlyVisible > should check deck visibility using cached results
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle no active board gracefully
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
   ❯ src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle board switch to same board
     → Cannot initialize local storage without a `--localstorage-file` path
     → Cannot initialize local storage without a `--localstorage-file` path
 ✓ src/ai/learning/project-versioning.test.ts  (18 tests) 6ms
 ✓ src/ai/theory/prolog-host-actions.test.ts  (9 tests) 13ms
 ✓ src/ai/theory/spec-prolog-roundtrip.test.ts  (9 tests) 4ms
 ✓ src/boards/gating/ontology-gating.test.ts  (18 tests) 5ms
 ✓ src/tests/snapshots/ontology-pack-registry.snapshot.test.ts  (11 tests) 4ms
 ✓ src/cards/card-filtering.test.ts  (25 tests) 5ms
stdout | src/ui/components/arranger-deck.test.ts > Arranger Deck > Generation > generates section events (H014)
Generated section: { section: 'Test Section', parts: [ 'drums' ] }

stdout | src/ui/components/arranger-deck.test.ts > Arranger Deck > Generation > regenerates section (H016)
Generated section: { section: 'Test Section', parts: [ 'drums' ] }
Regenerated section: Test Section

stdout | src/ui/components/arranger-deck.test.ts > Arranger Deck > Generation > freezes section (H017)
Generated section: { section: 'Test Section', parts: [ 'drums' ] }
Froze section: Test Section

stdout | src/ui/components/arranger-deck.test.ts > Arranger Deck > Generation > respects frozen state during regeneration (H023)
Generated section: { section: 'Test Section', parts: [ 'drums' ] }
Froze section: Test Section
Regenerated section: Test Section

stdout | src/ui/components/arranger-deck.test.ts > Arranger Deck > Control Level Indicators (H020) > tracks control level per part
Generated section: { section: 'Test', parts: [ 'drums', 'bass' ] }
Froze section: Test
Unfroze section: Test

 ✓ src/ui/components/arranger-deck.test.ts  (11 tests) 12ms
 ✓ src/ai/theory/__tests__/prolog-action-parsing.test.ts  (10 tests) 3ms
 ✓ src/ai/learning/undo-branching.test.ts  (20 tests) 4ms
 ✓ src/boards/harmony/integration.test.ts  (11 tests) 10ms
 ✓ src/cards/preset-sync.test.ts  (14 tests) 152ms
stderr | src/boards/store/migrations.test.ts > BoardState Migrations > Corrupt data handling > should fallback to default on invalid JSON
Failed to load board state: SyntaxError: Unexpected token 'o', "not valid json {{{" is not valid JSON
    at JSON.parse (<anonymous>)
    at Module.loadBoardState (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/storage.ts:35:25)
    at new BoardStateStore (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/store.ts:29:18)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/migrations.test.ts:152:21
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:60:26
    at runTest (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:781:17)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)
    at runSuite (file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:909:15)

 ✓ src/boards/store/migrations.test.ts  (11 tests) 7ms
 ✓ src/tests/canon/card-systems-enforcement.test.ts  (8 tests) 1441ms
stdout | src/boards/__tests__/gating-integration.test.ts > Gating Integration > D076: should hide disallowed card; enabling via board switch reveals it
Basic Tracker board activated
Basic Tracker board deactivated
Tracker + Phrases board activated

 ✓ src/boards/__tests__/gating-integration.test.ts  (5 tests) 4ms
 ✓ src/tests/snapshots/deck-template-registry.snapshot.test.ts  (13 tests) 8ms
 ✓ src/boards/registry.test.ts  (15 tests) 5ms
stdout | src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > getReharmonizationSuggestions > suggests chords based on melody
Generated reharmonization suggestions: []

 ❯ src/boards/builtins/harmony-analysis.test.ts  (11 tests | 4 failed) 8ms
   ❯ src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > snapToChordTones > snaps notes to chord tones
     → Cannot read properties of undefined (reading 'id')
   ❯ src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > snapToChordTones > is undoable
     → Cannot read properties of undefined (reading 'id')
   ❯ src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > harmonizeMelody > adds harmony notes below melody
     → Cannot read properties of undefined (reading 'id')
   ❯ src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > getReharmonizationSuggestions > suggests chords based on melody
     → expected 0 to be greater than 0
 ✓ src/tests/canon/canon-ids.test.ts  (21 tests) 4ms
 ✓ src/tests/canon/card-systems-boundaries.test.ts  (6 tests) 30ms
 ✓ src/boards/gating/validate-deck-drop.test.ts  (14 tests) 4ms
 ✓ src/state/ssot.test.ts  (14 tests) 4ms
stdout | src/audio/sample-packs.test.ts > Sample Pack System > SamplePackLoader > should track load progress
Pack loading skipped in test (network required)

 ✓ src/audio/sample-packs.test.ts  (18 tests) 669ms
 ✓ src/types/__tests__/time-conversion.test.ts  (24 tests) 5ms
 ✓ src/boards/gating/validate-connection.test.ts  (27 tests) 6ms
 ✓ src/boards/builtins/basic-tracker-board.test.ts  (11 tests) 4ms
 ✓ src/audio/export.test.ts  (23 tests) 4308ms
 ✓ src/boards/integration/phase-i-integration.test.ts  (8 tests) 5ms
 ✓ src/ai/theory/custom-constraints-namespacing.test.ts  (11 tests) 4ms
 ✓ src/test-utils/test-utils.test.ts  (18 tests) 8ms
 ✓ src/events/serialization.test.ts  (13 tests) 6ms
 ✓ src/music/harmony-helper.test.ts  (10 tests) 6ms
 ✓ src/tests/canon/namespaced-id.test.ts  (22 tests) 5ms
 ✓ src/tests/canon/port-compat.test.ts  (22 tests) 5ms
 ✓ src/boards/__tests__/cross-view-sync.test.ts  (5 tests) 9ms
stdout | src/boards/switching/capture-to-manual.test.ts > captureToManualBoard > should preserve active stream context
Freezing generated layers before capture...
Captured to manual board: {
  from: 'Test Generative Board',
  to: 'Basic Session',
  preservedStreams: [ 'test-stream-1' ]
}
✨ Captured to Basic Session. Your generated content is now editable.

 ✓ src/boards/switching/capture-to-manual.test.ts  (8 tests) 3ms
 ✓ src/boards/__tests__/routing-persistence.test.ts  (5 tests) 3ms
 ✓ src/boards/builtins/composer-board.test.ts  (14 tests) 4ms
stderr | src/ai/knowledge/__tests__/kb-health-report.test.ts > KB Health Report (Changes 387-388) > ontology modules in health report > should include loaded ontology modules
Ontology not found: carnatic

stderr | src/ai/knowledge/__tests__/kb-health-report.test.ts > KB Health Report (Changes 387-388) > ontology modules in health report > should track total modules including ontologies
Ontology not found: carnatic

 ✓ src/state/routing-graph.test.ts  (10 tests) 4ms
 ✓ src/boards/__tests__/board-schema-canon.test.ts  (9 tests) 9ms
 ✓ src/user-cards/template-preview.test.ts  (11 tests) 6ms
 ✓ src/ai/knowledge/__tests__/kb-health-report.test.ts  (16 tests) 1063ms
 ✓ src/boards/decks/__tests__/deck-capabilities.test.ts  (19 tests) 6ms
 ✓ src/extensions/__tests__/extensions.test.ts  (9 tests) 4ms
 ✓ src/boards/settings/store.test.ts  (12 tests) 3ms
 ✓ src/gofai/infra/__tests__/vocab-coverage-report.test.ts  (11 tests) 5ms
 ✓ src/boards/gating/is-card-allowed.test.ts  (8 tests) 3ms
 ✓ src/boards/gating/card-kinds.test.ts  (24 tests) 4ms
 ✓ src/user-cards/pack-ratings.test.ts  (10 tests) 5ms
 ✓ src/boards/integration/phase-j-integration.test.ts  (11 tests) 4ms
 ❯ src/ui/components/missing-pack-placeholder.test.ts  (14 tests | 9 failed) 6ms
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > creates a DOM element with pack information
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes error message when present
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes provenance when present
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes referenced-by when present
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createInlineMissingPackPlaceholder > creates a compact inline element
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > createInlineMissingPackPlaceholder > includes warning icon
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > returns placeholder when pack is not found
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > returns placeholder when getter throws
     → document is not defined
   ❯ src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > includes context in placeholder
     → document is not defined
stdout | src/boards/__tests__/board-factory-validation.test.ts > B134: Board Factory Validation > collects deck types from all builtin boards
Found 16 unique deck types across 16 boards

stderr | src/boards/__tests__/board-factory-validation.test.ts > B134: Board Factory Validation > all referenced deck types have registered factories
Missing factories for deck types: [
  'pattern-deck',    'instruments-deck',
  'dsp-chain',       'properties-deck',
  'harmony-deck',    'phrases-deck',
  'session-deck',    'mixer-deck',
  'samples-deck',    'arrangement-deck',
  'notation-deck',   'arranger-deck',
  'generators-deck', 'ai-advisor-deck',
  'transport-deck',  'routing-deck'
]

 ❯ src/boards/__tests__/board-factory-validation.test.ts  (3 tests | 1 failed) 6ms
   ❯ src/boards/__tests__/board-factory-validation.test.ts > B134: Board Factory Validation > all referenced deck types have registered factories
     → Missing factories for: pattern-deck, instruments-deck, dsp-chain, properties-deck, harmony-deck, phrases-deck, session-deck, mixer-deck, samples-deck, arrangement-deck, notation-deck, arranger-deck, generators-deck, ai-advisor-deck, transport-deck, routing-deck: expected [ 'pattern-deck', …(15) ] to have a length of +0 but got 16
 ✓ src/tests/canon/ssot-stores-sync.test.ts  (5 tests) 3ms
 ✓ src/community/sample-packs/sample-packs.test.ts  (11 tests) 4ms
stdout | src/boards/builtins/capture-to-manual-action.test.ts > captureToManualBoard > should preserve active context when capturing
Basic Session board activated
[Capture] Switched from AI Arranger → Basic Session
[Capture] Active context preserved: { streamId: null, clipId: null, trackId: null }

stdout | src/boards/builtins/capture-to-manual-action.test.ts > captureToManualBoard > should switch to recommended board
Basic Session board deactivated
Notation (Manual) board activated
[Capture] Switched from AI Composition → Notation (Manual)
[Capture] Active context preserved: { streamId: null, clipId: null, trackId: null }

stdout | src/boards/builtins/capture-to-manual-action.test.ts > captureToManualBoard > should allow explicit target board
Notation (Manual) board deactivated
Basic Tracker board activated
[Capture] Switched from AI Arranger → Basic Tracker
[Capture] Active context preserved: { streamId: null, clipId: null, trackId: null }

stdout | src/boards/builtins/capture-to-manual-action.test.ts > captureToManualBoard > should log capture for user awareness
Basic Tracker board deactivated
Basic Session board activated
[Capture] Switched from AI Arranger → Basic Session
[Capture] Active context preserved: { streamId: null, clipId: null, trackId: null }

 ✓ src/boards/builtins/capture-to-manual-action.test.ts  (17 tests) 6ms
 ✓ src/tests/snapshots/theory-card-registry.snapshot.test.ts  (9 tests) 6ms
 ✓ src/boards/builtins/basic-session-board.test.ts  (10 tests) 3ms
 ✓ src/boards/decks/audio-deck-adapter.test.ts  (8 tests) 4ms
 ✓ src/tests/snapshots/board-registry.snapshot.test.ts  (7 tests) 3ms
 ✓ src/performance/performance-optimization.test.ts  (13 tests) 16ms
stdout | src/ai/engine/prolog-adapter.bench.test.ts > PrologAdapter Performance > L027: Query throughput > should handle 1000 simple queries in reasonable time
Query throughput: 488 queries/sec
Total time for 1000 queries: 2049.44ms

 ✓ src/music/roman-numerals.test.ts  (16 tests) 3ms
 ✓ src/state/event-store.test.ts  (8 tests) 4ms
 ✓ src/user-cards/pack-discovery.test.ts  (9 tests) 6ms
 ✓ src/tests/snapshots/event-kind-registry.snapshot.test.ts  (8 tests) 4ms
stdout | src/tests/no-duplicate-exported-symbols.test.ts > No Duplicate Exported Symbols (Change 470) > should use qualified names for card types
Expected qualified names:
  Card<A,B> → CoreCard (composition cards)
  Card (audio) → AudioModuleCard
  CardState (UI) → CardSurfaceState
  PortType (UI) → UIPortType, VisualPortType
  Track (arrangement) → ArrangementTrack
  Track (freeze) → FreezeTrackModel

 ✓ src/tests/no-duplicate-exported-symbols.test.ts  (2 tests) 839ms
 ✓ src/ai/regression/ai-bug-regressions.test.ts  (3 tests) 1102ms
stderr | src/tests/no-duplicate-routing-store.test.ts > Routing Graph Store SSOT > should not have parallel routing state in UI components
Found UI files with potential parallel routing state:
src/ui/achievements.ts
src/ui/beginner.ts
src/ui/cards.ts
src/ui/components/connection-router.ts
src/ui/components/contextual-tooltips.ts
src/ui/components/reveal-panel.ts
src/ui/components/whats-this-mode.ts
src/ui/deck-layouts.ts
src/ui/demo-songs.ts
src/ui/drag-drop-system.ts
src/ui/keyboard-navigation.ts
src/ui/layout.ts

 ✓ src/tests/no-duplicate-routing-store.test.ts  (3 tests) 252ms
 ✓ src/user-cards/pack-stats.test.ts  (7 tests) 6ms
 ✓ src/boards/validate.test.ts  (7 tests) 3ms
 ✓ src/boards/builtins/basic-sampler-board.test.ts  (9 tests) 3ms
stdout | src/tests/no-legacy-decktype.test.ts > No Legacy DeckType Strings (Change 467) > canonical DeckType values should be used
Expected canonical DeckType values: pattern-deck, piano-roll-deck, notation-deck, session-deck, arrangement-deck, mixer-deck, instruments-deck, effects-deck, samples-deck, phrases-deck, harmony-deck, generators-deck, routing-deck, automation-deck, properties-deck, ai-advisor-deck

 ✓ src/tests/no-legacy-decktype.test.ts  (2 tests) 1082ms
 ❯ src/boards/settings/board-settings-panel.test.ts  (9 tests | 8 failed) 6ms
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should create panel with board settings
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show board name in header
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should have default display settings
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show display section
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show tracker base selector for tracker boards
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should emit event when settings applied
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should be read-only when configured
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should destroy cleanly
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
 ❯ src/extensions/__tests__/pack-integration.test.ts  (6 tests | 4 failed) 10ms
   ❯ src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should register event kinds with namespaced IDs
     → expected [ { kind: 'note', …(3) }, …(12) ] to include 'integration-test:custom-event'
   ❯ src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should register port types with namespaced IDs
     → getPortTypeEntries is not a function
   ❯ src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should prevent ID collisions with builtins
     → expected [Function] to throw an error
   ❯ src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should allow multiple packs with different namespaces
     → expected [ { kind: 'note', …(2) }, …(14) ] to include 'pack1-test:event'
 ✓ src/boards/builtins/session-generators-board.test.ts  (14 tests) 4ms
stdout | src/ai/engine/prolog-adapter.bench.test.ts > PrologAdapter Performance > L027: Query throughput > should handle queries with backtracking efficiently
Backtracking queries: 2265.59ms for 100 queries

stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should generate ascending arpeggio
Error getting answer: [object Object]

 ✓ src/boards/recommendations.test.ts  (14 tests) 8ms
stdout | src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > not-yet-implemented DeckTypes are documented

ℹ Not yet implemented (2 DeckTypes):
  - spectrum-analyzer-deck
  - waveform-editor-deck


stdout | src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > factory registry has reasonable coverage

DeckType factory coverage: 0/26 (0.0%)


 ❯ src/boards/decks/__tests__/deck-type-coverage.test.ts  (4 tests | 2 failed) 5ms
   ❯ src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > every implemented DeckType has a registered factory
     → Missing factories for implemented DeckTypes:
  - pattern-deck
  - piano-roll-deck
  - notation-deck
  - session-deck
  - arrangement-deck
  - arranger-deck
  - mixer-deck
  - transport-deck
  - instruments-deck
  - samples-deck
  - sample-manager-deck
  - effects-deck
  - dsp-chain
  - routing-deck
  - modulation-matrix-deck
  - automation-deck
  - properties-deck
  - phrases-deck
  - harmony-deck
  - generators-deck
  - ai-advisor-deck
  - track-groups-deck
  - mix-bus-deck
  - reference-track-deck

Either:
1. Implement the factory in factories/ directory
2. Register it in factories/index.ts
3. Or add to NOT_YET_IMPLEMENTED if not ready
   ❯ src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > factory registry has reasonable coverage
     → expected 0 to be greater than or equal to 80
stdout | src/tests/no-phantom-registry-v2.test.ts > No Phantom Registry V2 (Change 469) > should not claim phantom paths are implemented in docs
Docs directory not found, skipping test

stdout | src/tests/no-phantom-registry-v2.test.ts > No Phantom Registry V2 (Change 469) > should verify registry/v2 path does not exist (or is documented)
registry/v2 does not exist - docs must mark references as aspirational

 ✓ src/tests/no-phantom-registry-v2.test.ts  (2 tests) 2ms
 ✓ src/tests/snapshots/port-type-registry.snapshot.test.ts  (6 tests) 5ms
 ✓ src/tests/snapshots/deck-factory-registry.snapshot.test.ts  (5 tests) 6ms
 ✓ src/boards/theme/board-theme-defaults.test.ts  (9 tests) 7ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should generate descending arpeggio
Error getting answer: [object Object]

 ✓ src/tests/canon/no-phantom-modules.test.ts  (1 test) 48ms
 ✓ src/audio/freeze-track.test.ts  (6 tests) 4ms
stdout | src/ai/engine/prolog-adapter.bench.test.ts > PrologAdapter Performance > L027: Query throughput > should handle findAll efficiently
findAll queries: 1288.55ms for 500 queries

stdout | src/tests/no-direction-porttype.test.ts > No Direction in PortType (Change 468) > PortSpec model should be used for new code
Use PortSpec for port definitions: {"direction":"in","type":"audio"}

 ✓ src/tests/no-direction-porttype.test.ts  (2 tests) 1640ms
stdout | src/gofai/canon/__tests__/ontology-drift-lint.test.ts > ontology-drift-lint > checkOntologyDrift > should check docs vs code agreement
Note: 58 drift warnings detected (non-fatal)
Warning: 1 drift errors detected - docs may need updates
  - Lexeme ID "lex:verb:make" appears in docs but not in CORE_LEXEMES

 ✓ src/gofai/canon/__tests__/ontology-drift-lint.test.ts  (4 tests) 20ms
stdout | src/gofai/canon/__tests__/ontology-drift-lint.test.ts > ontology-drift-lint > assertNoOntologyDrift > should not throw if drift is acceptable
Note: Drift errors exist but may be acceptable during development

 ✓ src/ai/engine/prolog-adapter.bench.test.ts  (7 tests) 5880ms
stdout | src/ai/engine/prolog-adapter.bench.test.ts > PrologAdapter Performance > Cache performance > should benefit from caching repeated queries
Cold query: 36.30ms, Warm query: 0.01ms

 ✓ src/registry/v2/__tests__/registry-v2.test.ts  (5 tests) 3ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should generate chord pattern (all notes together)
Error getting answer: [object Object]

 ✓ src/state/__tests__/clip-registry.snapshot.test.ts  (5 tests) 3ms
 ✓ src/ai/e2e/ai-workflows.e2e.test.ts  (1 test) 1345ms
 ✓ src/ai/learning/learning-simulation.test.ts  (2 tests) 138ms
 ✓ src/boards/theme/control-level-colors.test.ts  (8 tests) 3ms
 ❯ src/ui/components/control-spectrum-badge.test.ts  (6 tests | 6 failed) 4ms
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should create a badge with the correct control level
     → document is not defined
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should show label when showLabel is true
     → document is not defined
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should hide label when showLabel is false
     → document is not defined
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should update control level dynamically
     → document is not defined
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should apply correct size classes
     → document is not defined
   ❯ src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should cleanup when destroyed
     → document is not defined
 ✓ src/boards/builtins/tracker-phrases-board.test.ts  (12 tests) 4ms
 ✓ src/boards/__tests__/board-metadata-validation.test.ts  (2 tests) 1ms
 ✓ src/ai/adaptation/prolog-phrase-adapter.test.ts  (29 tests) 22287ms
 ✓ src/ai/queries/project-analysis.examples.test.ts  (2 tests) 231ms
stdout | src/ai/queries/workflow-planning.bench.test.ts > Workflow planning performance (N048) > cold planWorkflow(make_beat, producer) completes in <200ms
Workflow planning cold planWorkflow(make_beat, producer): 43.86ms

 ✓ src/ai/queries/workflow-planning.bench.test.ts  (1 test) 46ms
stdout | src/ai/queries/project-analysis.bench.test.ts > Project analysis performance (N098) > cold analyzeProject completes in <1s
Project analysis cold analyzeProject: 145.80ms

 ✓ src/ai/queries/project-analysis.bench.test.ts  (1 test) 148ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should generate alberti bass pattern
Error getting answer: [object Object]

 ✓ src/tests/no-hardcoded-ppq.test.ts  (2 tests) 933ms
 ✓ src/notation/harmony-overlay.test.ts  (15 tests) 12ms
 ✓ src/ui/drop-handlers.test.ts  (28 tests) 36ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should respect octave range
Error getting answer: [object Object]

 ✓ src/boards/builtins/phase-g-integration.test.ts  (32 tests) 18ms
 ✓ src/ai/learning/privacy-offline.test.ts  (1 test) 1236ms
stderr | src/tests/board-integration.test.ts > E081: Board Layout Rendering Integration > should create deck instances matching board definition
No factory registered for deck type: notation-deck
No factory registered for deck type: instruments-deck
No factory registered for deck type: properties-deck

stdout | src/tests/board-integration.test.ts > E082: Board Switching Deck Replacement > should replace decks when switching from notation to tracker board
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/tests/board-integration.test.ts > E082: Board Switching Deck Replacement > should preserve recent boards list when switching
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Basic Session board activated

stdout | src/tests/board-integration.test.ts > E082: Board Switching Deck Replacement > should update board chrome when switching boards
Basic Session board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated

stdout | src/tests/board-integration.test.ts > E083: Deck State Persistence > should persist deck state across board switches
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated

 ✓ src/tests/board-integration.test.ts  (11 tests) 16ms
 ✓ src/ui/components/sample-waveform-preview.test.ts  (70 tests) 546ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should generate for chord progression
Error getting answer: [object Object]

 ✓ src/ui/components/extension-browser.test.ts  (26 tests) 90ms
 ✓ src/boards/builtins/tracker-harmony-board.test.ts  (26 tests) 20ms
 ❯ src/ui/components/session-grid-panel.test.ts  (19 tests | 6 failed) 129ms
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Grid Rendering > should apply clip colors to slots
     → expected '' to be truthy
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Slot Selection > should update selection indicator when slot is clicked
     → expected false to be true // Object.is equality
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Play State Display > should show stopped state styling
     → expected false to be true // Object.is equality
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Keyboard Navigation > should navigate slots with arrow keys
     → expected <body><div id="test-root"></div></body> to be <button …(7)>…(1)</button> // Object.is equality
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Keyboard Navigation > should activate slot with Enter key
     → expected "spy" to be called at least once
   ❯ src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Accessibility > should update aria-pressed for play state
     → expected null to be 'true' // Object.is equality
 ✓ src/ui/components/virtual-list.test.ts  (14 tests) 49ms
 ✓ src/ui/components/control-level-indicator.test.ts  (22 tests) 120ms
stdout | src/boards/builtins/manual-boards.smoke.test.ts > Phase F: Manual Boards Smoke Tests > Notation Board (Manual) - F023, F024, F025 > F025: should preserve active stream/clip context when switching
Notation (Manual) board activated

stdout | src/boards/builtins/manual-boards.smoke.test.ts > Phase F: Manual Boards Smoke Tests > Cross-Board Context Preservation > should preserve stream/clip context when switching between manual boards
Notation (Manual) board deactivated
Basic Tracker board activated
Basic Tracker board deactivated
Notation (Manual) board activated
Notation (Manual) board deactivated
Basic Session board activated

 ✓ src/boards/builtins/manual-boards.smoke.test.ts  (11 tests) 14ms
 ❯ src/ui/components/toast-notification.test.ts  (25 tests | 8 failed) 148ms
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Auto-dismiss > should auto-dismiss after duration
     → expected false to be true // Object.is equality
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Auto-dismiss > should not auto-dismiss when duration is 0
     → expected false to be true // Object.is equality
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Manual dismiss > should dismiss toast when dismiss() is called
     → expected "spy" to be called at least once
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Manual dismiss > should dismiss toast when close button is clicked
     → expected "spy" to be called at least once
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > dismissAllToasts > should dismiss all active toasts
     → expected false to be true // Object.is equality
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > dismissToastsAtPosition > should dismiss only toasts at specified position
     → expected false to be true // Object.is equality
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Stacking > should stack multiple toasts at same position
     → expected undefined to be 3 // Object.is equality
   ❯ src/ui/components/toast-notification.test.ts > Toast Notification System > Stacking > should create separate containers for different positions
     → expected null to be truthy
 ❯ src/boards/decks/deck-container.test.ts  (18 tests | 18 failed) 58ms
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should create a deck container element
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should render deck header with title
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should render deck content in body
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should render tabs when cardLayout is tabs
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should highlight active tab based on state
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should call onStateChange when tab is clicked
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should persist active tab to runtime state
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist scroll position
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist focused item
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist filter state
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should restore state from persisted runtime state
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render stack layout
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render split layout
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render floating layout
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Cleanup > should call deck instance destroy on cleanup
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Cleanup > should remove element from DOM on destroy
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Close Action > should call onClose callback when close button is clicked
     → this.options.instance.render is not a function
   ❯ src/boards/decks/deck-container.test.ts > DeckContainer > Context Menu > should show context menu on right click
     → this.options.instance.render is not a function
 ✓ src/ui/components/harmony-settings-panel.test.ts  (15 tests) 67ms
 ✓ src/ui/visual-density.test.ts  (17 tests) 6ms
stderr | src/ui/components/gated-card-browser.test.ts > GatedCardBrowser > creates a card browser
Failed to load board state: DOMException [SecurityError]: Cannot initialize local storage without a `--localstorage-file` path
    at Object.get [as localStorage] (node:internal/webstorage:28:17)
    at get localStorage (node:internal/util:660:20)
    at Module.loadBoardState (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/storage.ts:29:50)
    at new BoardStateStore (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/store.ts:29:18)
    at Module.getBoardStateStore (/Users/halleyyoung/Documents/behavioral/cardplay/src/boards/store/store.ts:510:21)
    at GatedCardBrowser.loadCurrentBoard (/Users/halleyyoung/Documents/behavioral/cardplay/src/ui/components/gated-card-browser.ts:91:24)
    at new GatedCardBrowser (/Users/halleyyoung/Documents/behavioral/cardplay/src/ui/components/gated-card-browser.ts:82:10)
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/ui/components/gated-card-browser.test.ts:57:21
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:135:14
    at file:///Users/halleyyoung/Documents/behavioral/cardplay/node_modules/@vitest/runner/dist/index.js:60:26

 ✓ src/ui/components/gated-card-browser.test.ts  (17 tests) 113ms
stderr | src/ui/utils/micro-interactions.test.ts > Micro-interactions > fadeOut > fades out element
AssertionError: expected '0' to be '1' // Object.is equality
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/ui/utils/micro-interactions.test.ts:221:39
    at invokeTheCallbackFunction (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/living/generated/Function.js:19:26)
    at runAnimationFrameCallbacks (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/browser/Window.js:688:13)
    at Timeout._onTimeout (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/browser/Window.js:666:11)
    at listOnTimeout (node:internal/timers:605:17)
    at processTimers (node:internal/timers:541:7)

 ❯ src/ui/components/first-run-board-selection.test.ts  (7 tests | 7 failed) 6ms
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should create first-run selection element
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should show recommended boards
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should mark first-run complete on selection
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should provide skip option
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should show control spectrum explanation
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should persist first-run completion
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should support user type mapping
     → Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
stderr | src/ui/utils/micro-interactions.test.ts
AssertionError: expected 'translateX(20px)' to be 'translate(0, 0)' // Object.is equality
    at /Users/halleyyoung/Documents/behavioral/cardplay/src/ui/utils/micro-interactions.test.ts:245:41
    at invokeTheCallbackFunction (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/living/generated/Function.js:19:26)
    at runAnimationFrameCallbacks (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/browser/Window.js:688:13)
    at Timeout._onTimeout (/Users/halleyyoung/Documents/behavioral/cardplay/node_modules/jsdom/lib/jsdom/browser/Window.js:666:11)
    at listOnTimeout (node:internal/timers:605:17)
    at processTimers (node:internal/timers:541:7)

 ❯ src/ui/utils/micro-interactions.test.ts  (18 tests | 3 failed) 192ms
   ❯ src/ui/utils/micro-interactions.test.ts > Micro-interactions > highlightFlash > adds highlight flash
     → expected 'rgb(255, 215, 0)' to be '#ffd700' // Object.is equality
   ❯ src/ui/utils/micro-interactions.test.ts > Micro-interactions > createLoadingSpinner > creates spinner element
     → expected '' to be '20px' // Object.is equality
   ❯ src/ui/utils/micro-interactions.test.ts > Micro-interactions > animateNumber > animates number from start to end
     → expected '0' not to be '0' // Object.is equality
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should handle extended chords
Error getting answer: [object Object]

 ✓ src/ui/components/unknown-card-placeholder.test.ts  (24 tests) 50ms
 ❯ src/ui/components/board-browser.test.ts  (7 tests | 7 failed) 62ms
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should create browser element
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should group boards by control level
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should filter by difficulty
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should show deck type previews
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should support board opening
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should support search/filtering
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-browser.test.ts > BoardBrowser > should support favoriting boards
     → Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
 ✓ src/ui/generated-styling.test.ts  (19 tests) 9ms
 ✓ src/ui/event-styling.test.ts  (14 tests) 19ms
stderr | src/ui/components/control-spectrum-slider.test.ts > ControlSpectrumSlider > should respect allowed levels
Level not allowed: manual-with-hints

 ✓ src/ui/components/control-spectrum-slider.test.ts  (16 tests) 69ms
stderr | src/ai/generators/generators.test.ts > Generators > ArpeggioGenerator > should apply velocity curves
Error getting answer: [object Object]

 ✓ src/ai/generators/generators.test.ts  (43 tests) 26635ms
 ✓ src/ui/components/bounce-dialog.test.ts  (10 tests) 108ms
 ❯ src/ui/components/undo-history-browser.test.ts  (11 tests | 11 failed) 7ms
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should create and render undo history browser
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display header with title
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display empty state when no actions
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display stats correctly
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should render control buttons
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display actions in timeline
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should mark current action
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should distinguish past and future actions
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should have proper ARIA attributes
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should inject styles only once
     → Cannot read properties of undefined (reading 'getInstance')
   ❯ src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should auto-update timeline periodically
     → Cannot read properties of undefined (reading 'getInstance')
 ✓ src/ui/components/empty-state.test.ts  (17 tests) 72ms
 ❯ src/ui/components/board-switcher.test.ts  (8 tests | 8 failed) 50ms
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should create a board switcher modal
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should have search input
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should show results
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should filter results on search
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should toggle favorites
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should close on Escape
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should close on outside click
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-switcher.test.ts > BoardSwitcher > should navigate with arrow keys
     → Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
stderr | src/ui/components/ai-advisor-panel.test.ts > <ai-advisor-panel>
Lit is in dev mode. Not recommended for production! See https://lit.dev/msg/dev-mode for more information.

 ✓ src/ui/components/ai-advisor-panel.test.ts  (2 tests) 88ms
 ❯ src/ui/components/board-host.test.ts  (6 tests | 6 failed) 82ms
   ❯ src/ui/components/board-host.test.ts > BoardHost > should create a board host element
     → window.matchMedia is not a function
   ❯ src/ui/components/board-host.test.ts > BoardHost > should have a header and workspace
     → window.matchMedia is not a function
   ❯ src/ui/components/board-host.test.ts > BoardHost > should show "No board active" when no board is selected
     → window.matchMedia is not a function
   ❯ src/ui/components/board-host.test.ts > BoardHost > should update when board state changes
     → Extension board 'test-board' must use namespaced ID (e.g., 'your-pack:test-board'). Only builtin boards can use un-namespaced IDs.
   ❯ src/ui/components/board-host.test.ts > BoardHost > should cleanup subscriptions on destroy
     → window.matchMedia is not a function
   ❯ src/ui/components/board-host.test.ts > BoardHost > should display control level badge
     → Extension board 'assisted-board' must use namespaced ID (e.g., 'your-pack:assisted-board'). Only builtin boards can use un-namespaced IDs.
 ✓ src/ui/components/properties-panel.test.ts  (5 tests) 70ms
 ❯ src/ui/components/help-browser-deck.test.ts  (11 tests | 1 failed) 125ms
   ❯ src/ui/components/help-browser-deck.test.ts > HelpBrowserDeck > should search help topics
     → expected false to be true // Object.is equality
stdout | src/boards/__tests__/integration.test.ts > Board Integration Tests > Board Switching (K006) > should switch boards and update state
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated

stdout | src/boards/__tests__/integration.test.ts > Board Integration Tests > Board Switching (K006) > should preserve active context when switching boards
Session + Generators board deactivated
Notation + Harmony board activated
Notation + Harmony board deactivated
Session + Generators board activated

stdout | src/boards/__tests__/integration.test.ts > Board Integration Tests > Board State Persistence > should persist board state to localStorage
Session + Generators board deactivated
Notation + Harmony board activated

 ❯ src/ai/harmony/harmony-explorer.test.ts  (31 tests | 1 failed) 25470ms
   ❯ src/ai/harmony/harmony-explorer.test.ts > HarmonyExplorer > performance > should analyze long progression in reasonable time
     → expected 731.2617920000012 to be less than 500
 ✓ src/boards/__tests__/integration.test.ts  (6 tests) 611ms
 ✓ src/ai/queries/theory-queries.test.ts  (42 tests) 33677ms

⎯⎯⎯⎯⎯⎯ Failed Suites 1 ⎯⎯⎯⎯⎯⎯⎯

 FAIL  src/gofai/eval/constraint-violation-tests.test.ts [ src/gofai/eval/constraint-violation-tests.test.ts ]
Error: Failed to load url ../execution/plan-executor (resolved id: ../execution/plan-executor) in /Users/halleyyoung/Documents/behavioral/cardplay/src/gofai/eval/constraint-violation-tests.test.ts. Does the file exist?
 ❯ loadAndTransform node_modules/vite/dist/node/chunks/dep-BK3b2jBa.js:51969:17

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[1/446]⎯

⎯⎯⎯⎯⎯⎯ Failed Tests 432 ⎯⎯⎯⎯⎯⎯

 FAIL  src/ai/harmony/harmony-explorer.test.ts > HarmonyExplorer > performance > should analyze long progression in reasonable time
AssertionError: expected 731.2617920000012 to be less than 500
 ❯ src/ai/harmony/harmony-explorer.test.ts:477:24
    475|       const duration = performance.now() - start;
    476|       
    477|       expect(duration).toBeLessThan(500);
       |                        ^
    478|     });
    479|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[2/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Card Constraint Lifecycle (C1059-C1062) > C1062: MusicSpec changes propagate to card params
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

 ❯ src/ai/theory/spec-event-bus.test.ts:1231:22
    1229| 
    1230|     bus.publish(event);
    1231|     expect(received).toHaveLength(1);
       |                      ^
    1232|     expect(received[0]!.changedConstraints[0]!.type).toBe('key');
    1233|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[3/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Chinese Mode Tests (C1820) > C1820: Chinese modes calculate correct pitches
AssertionError: Target cannot be null or undefined.
 ❯ src/ai/theory/spec-event-bus.test.ts:1301:35
    1299|     ];
    1300|     const profile = extractProfile(gongNotes);
    1301|     expect(profile.pitchClassSet).toHaveLength(5);
       |                                   ^
    1302|     expect(profile.pitchClassSet).toContain(0);  // C
    1303|     expect(profile.pitchClassSet).toContain(2);  // D

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[4/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Orchestration Solver (C1546) > C1546: solveOrchestration returns valid assignments
TypeError: adapter.loadProgram is not a function
 ❯ Module.loadMusicTheoryKB src/ai/knowledge/music-theory-loader.ts:71:17
     69|   }
     70| 
     71|   await adapter.loadProgram(musicTheoryPl, 'music-theory-kb');
       |                 ^
     72|   await adapter.loadProgram(musicTheoryComputationalPl, 'music-theory-…
     73|   await adapter.loadProgram(musicTheoryGalantPl, 'music-theory-kb/gala…
 ❯ ensureLoaded src/ai/queries/spec-queries.ts:180:9
 ❯ Module.solveOrchestration src/ai/queries/spec-queries.ts:7000:9
 ❯ src/ai/theory/spec-event-bus.test.ts:1323:38

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[5/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Korvai Search (C632, C634) > fills tala cycle with phrase candidates
ReferenceError: searchKorvai is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2672:20
    2670|       { notes: [67, 65], syllables: ['tha', 'ki'] },
    2671|     ];
    2672|     const result = await searchKorvai('adi', 'chatusra', phrases);
       |                    ^
    2673|     expect(result.value.totalBeats).toBeGreaterThan(0);
    2674|     expect(result.value.phrases.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[6/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Korvai Search (C632, C634) > respects maxDepth bound (C634)
ReferenceError: searchKorvai is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2682:20
    2680|       { notes: [60], syllables: ['ta'] }, // 1-beat phrase, cycle is 8…
    2681|     ];
    2682|     const result = await searchKorvai('adi', 'chatusra', phrases, { ma…
       |                    ^
    2683|     // Should stop after 3 iterations max
    2684|     expect(result.value.phrases.length).toBeLessThanOrEqual(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[7/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C945/C946: exports to notation format
ReferenceError: exportToNotation is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2695:20
    2693|   it('C945/C946: exports to notation format', async () => {
    2694|     // Using specQueries.* imports (see top of file)
    2695|     const result = await exportToNotation([60, 62, 64, 65], [480, 480,…
       |                    ^
    2696|     expect(result.value.measures.length).toBeGreaterThan(0);
    2697|     expect(result.value.clef).toBe('treble');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[8/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C945: low notes get bass clef
ReferenceError: exportToNotation is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2703:20
    2701|   it('C945: low notes get bass clef', async () => {
    2702|     // Using specQueries.* imports (see top of file)
    2703|     const result = await exportToNotation([36, 40, 43], [480, 480, 480…
       |                    ^
    2704|     expect(result.value.clef).toBe('bass');
    2705|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[9/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C947/C948: exports to tracker format
ReferenceError: exportToTracker is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2709:20
    2707|   it('C947/C948: exports to tracker format', async () => {
    2708|     // Using specQueries.* imports (see top of file)
    2709|     const result = await exportToTracker([60, 64, 67], [480, 480, 480]…
       |                    ^
    2710|     expect(result.value.rows.length).toBe(3);
    2711|     expect(result.value.rows[0]!.note).toContain('C-'); // C note

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[10/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Export Formats (C945-C950) > C949/C950: exports to arranger format
Error: Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:2718:68
    2716|   it('C949/C950: exports to arranger format', async () => {
    2717|     // Using specQueries.* imports (see top of file)
    2718|     const { createMusicSpec: cms, withTempo: wt, withStyle: ws } = req…
       |                                                                    ^
    2719|     const spec = ws(wt(cms(), 140), 'jazz');
    2720|     const result = await exportToArranger(spec, ['Cmaj7', 'Dm7', 'G7']…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[11/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phrase Recommendation (C928, C930) > C928: recommends phrases matching spec culture
Error: Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:2734:46
    2732|   it('C928: recommends phrases matching spec culture', async () => {
    2733|     // Using specQueries.* imports (see top of file)
    2734|     const { createMusicSpec, withCulture } = require('./music-spec') a…
       |                                              ^
    2735| 
    2736|     // Add some test phrases

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[12/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phrase Recommendation (C928, C930) > C930: suggests arranger variation based on energy
ReferenceError: suggestArrangerVariation is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2760:24
    2758|     // Using specQueries.* imports (see top of file)
    2759| 
    2760|     const highEnergy = await suggestArrangerVariation('chorus', 0.9, 0…
       |                        ^
    2761|     expect(highEnergy.value.variation).toBe('climactic');
    2762|     expect(highEnergy.value.techniques).toContain('full_ensemble');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[13/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Line Lint (C1432) > detects large leaps
ReferenceError: lintJazzLine is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2778:20
    2776|     // Line with a large leap (> octave)
    2777|     const notes = [60, 62, 64, 80, 82]; // 64 -> 80 = 16 semitones
    2778|     const result = await lintJazzLine(notes, ['Cmaj7'], 'bebop');
       |                    ^
    2779|     const leapIssues = result.value.issues.filter(i => i.message.inclu…
    2780|     expect(leapIssues.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[14/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Line Lint (C1432) > clean line has high score
ReferenceError: lintJazzLine is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2787:20
    2785|     // Stepwise bebop line
    2786|     const notes = [60, 62, 63, 64, 65, 67, 69, 71, 72];
    2787|     const result = await lintJazzLine(notes, ['Cmaj7', 'Dm7'], 'bebop'…
       |                    ^
    2788|     expect(result.value.score).toBeGreaterThanOrEqual(80);
    2789|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[15/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C983: default flags all enabled
ReferenceError: DEFAULT_FEATURE_FLAGS is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2799:12
    2797|   it('C983: default flags all enabled', () => {
    2798|     // Using specQueries.* imports (see top of file)
    2799|     expect(DEFAULT_FEATURE_FLAGS.lccExtended).toBe(true);
       |            ^
    2800|     expect(DEFAULT_FEATURE_FLAGS.jazzAdvanced).toBe(true);
    2801|     const flags = getActiveFeatureFlags();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[16/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C983: override specific flags
ReferenceError: getActiveFeatureFlags is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2807:19
    2805|   it('C983: override specific flags', () => {
    2806|     // Using specQueries.* imports (see top of file)
    2807|     const flags = getActiveFeatureFlags({ spiralDFT: false, lccExtende…
       |                   ^
    2808|     expect(flags.spiralDFT).toBe(false);
    2809|     expect(flags.lccExtended).toBe(false);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[17/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C984: capabilities report lists all modules
ReferenceError: generateCapabilitiesReport is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2815:20
    2813|   it('C984: capabilities report lists all modules', () => {
    2814|     // Using specQueries.* imports (see top of file)
    2815|     const report = generateCapabilitiesReport(DEFAULT_FEATURE_FLAGS);
       |                    ^
    2816|     expect(report.length).toBe(7);
    2817|     expect(report.every(r => r.enabled)).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[18/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C986: migration hides advanced cards for old projects
ReferenceError: migrateProjectTheoryDefaults is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2823:20
    2821|   it('C986: migration hides advanced cards for old projects', () => {
    2822|     // Using specQueries.* imports (see top of file)
    2823|     const result = migrateProjectTheoryDefaults('1.0.0', []);
       |                    ^
    2824|     expect(result.hiddenCards.length).toBeGreaterThan(0);
    2825|     expect(result.hiddenCards).toContain('lydian_chromatic');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[19/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Feature Flags & Capabilities (C983, C984, C986) > C986: v2 projects do not hide cards
ReferenceError: migrateProjectTheoryDefaults is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2832:20
    2830|   it('C986: v2 projects do not hide cards', () => {
    2831|     // Using specQueries.* imports (see top of file)
    2832|     const result = migrateProjectTheoryDefaults('2.0.0', []);
       |                    ^
    2833|     expect(result.hiddenCards.length).toBe(0);
    2834|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[20/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > creates relative time grid from note events
ReferenceError: createFreeRhythmGrid is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2849:18
    2847|       { pitch: 67, timeMs: 1200, durationMs: 800, velocity: 60 },
    2848|     ];
    2849|     const grid = createFreeRhythmGrid(notes, 2000);
       |                  ^
    2850|     expect(grid.length).toBe(3);
    2851|     expect(grid[0]!.relativeTime).toBe(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[21/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > round-trips free-rhythm grid to events
ReferenceError: createFreeRhythmGrid is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2863:18
    2861|       { pitch: 64, timeMs: 1000, durationMs: 500, velocity: 64 },
    2862|     ];
    2863|     const grid = createFreeRhythmGrid(original, 2000);
       |                  ^
    2864|     const events = freeRhythmToEvents(grid, 2000);
    2865|     expect(events.length).toBe(2);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[22/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Free-Rhythm Grid (C799) > empty input returns empty grid
ReferenceError: createFreeRhythmGrid is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2873:5
    2871|   it('empty input returns empty grid', () => {
    2872|     // Using specQueries.* imports (see top of file)
    2873|     expect(createFreeRhythmGrid([], 1000)).toHaveLength(0);
       |     ^
    2874|     expect(createFreeRhythmGrid([{ pitch: 60, timeMs: 0, durationMs: 1…
    2875|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[23/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Piano & Guitar Voicing (C1224, C1226) > C1224: two-handed voicing has LH and RH
ReferenceError: generateTwoHandedVoicing is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2885:20
    2883|   it('C1224: two-handed voicing has LH and RH', async () => {
    2884|     // Using specQueries.* imports (see top of file)
    2885|     const result = await generateTwoHandedVoicing('Dm7', 50, 'jazz');
       |                    ^
    2886|     expect(result.value.leftHand.length).toBeGreaterThanOrEqual(2);
    2887|     expect(result.value.rightHand.length).toBeGreaterThanOrEqual(2);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[24/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Piano & Guitar Voicing (C1224, C1226) > C1226: guitar voicing respects fret span
ReferenceError: generateGuitarVoicing is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2897:20
    2895|   it('C1226: guitar voicing respects fret span', async () => {
    2896|     // Using specQueries.* imports (see top of file)
    2897|     const result = await generateGuitarVoicing('Am', 45, 0);
       |                    ^
    2898|     expect(result.value.frets.length).toBe(6);
    2899|     // Playable frets should have span <= 4

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[25/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Schema-as-Constraints (C347) > applies schema constraints suggesting relevant cards
Error: Cannot find module './music-spec'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:2915:68
    2913|   it('applies schema constraints suggesting relevant cards', async () …
    2914|     // Using specQueries.* imports (see top of file)
    2915|     const { createMusicSpec, withConstraints, schemaConstraint } = req…
       |                                                                    ^
    2916|     const spec = withConstraints(createMusicSpec(), [schemaConstraint(…
    2917|     const result = await applySchemaConstraintsToDeck(spec, 'test-deck…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[26/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Contemporary Jazz Pack (C1415) > pack has required fields
ReferenceError: CONTEMPORARY_JAZZ_PACK is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2931:12
    2929|   it('pack has required fields', () => {
    2930|     // Using specQueries.* imports (see top of file)
    2931|     expect(CONTEMPORARY_JAZZ_PACK.name).toBe('contemporary_jazz');
       |            ^
    2932|     expect(CONTEMPORARY_JAZZ_PACK.constraints.length).toBeGreaterThanO…
    2933|     expect(CONTEMPORARY_JAZZ_PACK.prologCode).toContain('triad_pair');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[27/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > validates a complete manifest
ReferenceError: validatePackManifest is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2945:20
    2943|   it('validates a complete manifest', () => {
    2944|     // Already imported at top
    2945|     const result = validatePackManifest({
       |                    ^
    2946|       packId: 'test-pack',
    2947|       name: 'Test Pack',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[28/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > rejects manifest with missing fields
ReferenceError: validatePackManifest is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2961:20
    2959|   it('rejects manifest with missing fields', () => {
    2960|     // Already imported at top
    2961|     const result = validatePackManifest({});
       |                    ^
    2962|     expect(result.valid).toBe(false);
    2963|     expect(result.errors.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[29/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Pack Format (C1014) > serialize and parse round-trip
ReferenceError: serializePackManifest is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:2978:18
    2976|       prologCode: 'rt_pred(x).',
    2977|     };
    2978|     const json = serializePackManifest(manifest);
       |                  ^
    2979|     const parsed = parsePackManifest(json);
    2980|     expect(parsed).not.toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[30/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Pack Signing (C1015) > hash is deterministic
ReferenceError: hashPackContent is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3000:16
    2998|       prologCode: 'test.',
    2999|     };
    3000|     const h1 = hashPackContent(manifest);
       |                ^
    3001|     const h2 = hashPackContent(manifest);
    3002|     expect(h1).toBe(h2);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[31/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Pack Signing (C1015) > verify succeeds with correct hash
ReferenceError: hashPackContent is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3017:18
    3015|       signature: { algorithm: 'sha256' as const, hash: '' },
    3016|     };
    3017|     const hash = hashPackContent(manifest);
       |                  ^
    3018|     const signed = { ...manifest, signature: { algorithm: 'sha256' as …
    3019|     expect(verifyPackSignature(signed)).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[32/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox validates safe code
ReferenceError: sandboxPrologCode is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3030:20
    3028|   it('sandbox validates safe code', () => {
    3029|     // Already imported at top
    3030|     const result = sandboxPrologCode(
       |                    ^
    3031|       'user_test_pred(X) :- X > 0.\nuser_test_helper(1).',
    3032|       'user_test'

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[33/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox rejects unsafe code
ReferenceError: sandboxPrologCode is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3041:20
    3039|   it('sandbox rejects unsafe code', () => {
    3040|     // Already imported at top
    3041|     const result = sandboxPrologCode('assertz(hack(1)).', 'user_test');
       |                    ^
    3042|     expect(result.success).toBe(false);
    3043|     expect(result.errors.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[34/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Sandbox (C1029) > sandbox rejects wrong namespace
ReferenceError: sandboxPrologCode is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3048:20
    3046|   it('sandbox rejects wrong namespace', () => {
    3047|     // Already imported at top
    3048|     const result = sandboxPrologCode('wrong_name(1).', 'user_test');
       |                    ^
    3049|     expect(result.success).toBe(false);
    3050|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[35/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Card Template (C1047) > creates template with required fields
ReferenceError: createTheoryCardTemplate is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3060:22
    3058|   it('creates template with required fields', () => {
    3059|     // Already imported at top
    3060|     const template = createTheoryCardTemplate('my_card', 'My Card', 'p…
       |                      ^
    3061|     expect(template.cardId).toBe('user:my_card');
    3062|     expect(template.displayName).toBe('My Card');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[36/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1049: constraint → param sync
ReferenceError: syncConstraintToParam is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3079:21
    3077|     ];
    3078|     const constraint = { type: 'key', root: 'C', mode: 'major' };
    3079|     const updated = syncConstraintToParam(constraint as any, mappings,…
       |                     ^
    3080|     expect(updated.rootNote).toBe('C');
    3081|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[37/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1050: param → constraint sync
ReferenceError: syncParamToConstraint is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3089:21
    3087|     ];
    3088|     const constraints = [{ type: 'key' as const, root: 'G' as const, m…
    3089|     const updated = syncParamToConstraint('rootNote', 'D', mappings, c…
       |                     ^
    3090|     expect((updated[0] as any).root).toBe('D');
    3091|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[38/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Bidirectional Sync (C1048-C1051) > C1051: card-to-card links
ReferenceError: clearCardLinks is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3095:5
    3093|   it('C1051: card-to-card links', () => {
    3094|     // Already imported at top
    3095|     clearCardLinks();
       |     ^
    3096|     registerCardLink({
    3097|       sourceCardId: 'key_card',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[39/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1056: install and uninstall pack
ReferenceError: createCardPack is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3116:18
    3114|   it('C1056: install and uninstall pack', () => {
    3115|     // Already imported at top
    3116|     const pack = createCardPack('test-pack', 'Test', '1.0.0', 'test pa…
       |                  ^
    3117|       { cardId: 'test:card1', displayName: 'Card 1', category: 'pitch'…
    3118|     ]);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[40/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1057: resolve dependencies
ReferenceError: createCardPack is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3128:18
    3126|   it('C1057: resolve dependencies', () => {
    3127|     // Already imported at top
    3128|     const pack = createCardPack('dep-pack', 'Dep', '1.0.0', 'has deps'…
       |                  ^
    3129|     const withDeps = { ...pack, dependencies: [{ packId: 'nonexistent'…
    3130|     const resolution = resolvePackDependencies(withDeps);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[41/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Card Pack Management (C1056-C1058) > C1058: check pack update
ReferenceError: createCardPack is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3137:18
    3135|   it('C1058: check pack update', () => {
    3136|     // Already imported at top
    3137|     const pack = createCardPack('update-pack', 'Update', '1.0.0', 'che…
       |                  ^
    3138|     installCardPack(pack);
    3139|     const check = checkPackUpdate('update-pack', '2.0.0');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[42/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1091: save and load project constraints
ReferenceError: saveProjectConstraints is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3175:18
    3173|       { type: 'user:test', hard: true, params: { value: 42 } },
    3174|     ];
    3175|     const json = saveProjectConstraints('proj1', constraints);
       |                  ^
    3176|     const state = loadProjectConstraints(json);
    3177|     expect(state).not.toBeNull();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[43/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1094: constraint profile lifecycle
ReferenceError: saveConstraintProfile is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3184:5
    3182|   it('C1094: constraint profile lifecycle', () => {
    3183|     // Already imported at top
    3184|     saveConstraintProfile({
       |     ^
    3185|       id: 'test-profile',
    3186|       name: 'Test Profile',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[44/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1095/C1096: project bundle export and import
ReferenceError: exportProjectBundle is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3200:18
    3198|     // Already imported at top
    3199|     const constraints = [{ type: 'user:test', hard: false, params: { x…
    3200|     const json = exportProjectBundle('proj2', constraints, []);
       |                  ^
    3201|     const result = importProjectBundle(json);
    3202|     expect(result.constraints).toHaveLength(1);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[45/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Project Persistence (C1091-C1098) > C1098: health check detects duplicate types
ReferenceError: runConstraintHealthCheck is not defined
 ❯ src/ai/theory/spec-event-bus.test.ts:3212:20
    3210|       { type: 'user:dup', hard: false, params: {} },
    3211|     ];
    3212|     const report = runConstraintHealthCheck(constraints);
       |                    ^
    3213|     expect(report.totalConstraints).toBe(2);
    3214|     const dupIssues = report.issues.filter(i => i.message.includes('Mu…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[46/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Key Suggestions for Instruments (C739) > penalizes bad keys
TypeError: Cannot read properties of undefined (reading 'score')
 ❯ src/ai/theory/spec-event-bus.test.ts:3595:48
    3593|     const dKey = suggestions.find(s => s.key === 'd');
    3594|     const dbKey = suggestions.find(s => s.key === 'dflat');
    3595|     expect(dKey!.score).toBeGreaterThan(dbKey!.score);
       |                                                ^
    3596|   });
    3597| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[47/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > explains dorian mode
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3683:9
    3681|     const {
    3682|       explainCelticModalHarmony,
    3683|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3684|     const explanation = explainCelticModalHarmony('dorian');
    3685|     expect(explanation.mode).toBe('dorian');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[48/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > explains mixolydian mode
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3694:9
    3692|     const {
    3693|       explainCelticModalHarmony,
    3694|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3695|     const explanation = explainCelticModalHarmony('mixolydian');
    3696|     expect(explanation.mode).toBe('mixolydian');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[49/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Modal Harmony Explainer (C697) > returns generic for unknown modes
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3703:9
    3701|     const {
    3702|       explainCelticModalHarmony,
    3703|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3704|     const explanation = explainCelticModalHarmony('locrian');
    3705|     expect(explanation.description).toContain('Celtic');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[50/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Dance Accent Presets (C724) > has presets for major dance types
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3717:9
    3715|     const {
    3716|       CELTIC_DANCE_ACCENT_PRESETS,
    3717|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3718|     expect(CELTIC_DANCE_ACCENT_PRESETS.length).toBeGreaterThan(4);
    3719|     const types = CELTIC_DANCE_ACCENT_PRESETS.map((p: any) => p.danceT…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[51/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Dance Accent Presets (C724) > each preset has beats array
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3728:9
    3726|     const {
    3727|       CELTIC_DANCE_ACCENT_PRESETS,
    3728|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3729|     for (const preset of CELTIC_DANCE_ACCENT_PRESETS) {
    3730|       expect(preset.beats.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[52/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Variation Presets (C729) > has multiple variation types
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3744:9
    3742|     const {
    3743|       CELTIC_VARIATION_PRESETS,
    3744|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3745|     expect(CELTIC_VARIATION_PRESETS.length).toBeGreaterThan(3);
    3746|     const names = CELTIC_VARIATION_PRESETS.map((p: any) => p.name);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[53/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Variation Presets (C729) > each preset has description
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3754:9
    3752|     const {
    3753|       CELTIC_VARIATION_PRESETS,
    3754|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3755|     for (const preset of CELTIC_VARIATION_PRESETS) {
    3756|       expect(preset.description.length).toBeGreaterThan(5);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[54/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Chinese Variation Presets (C831) > has multiple variation types
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3769:9
    3767|     const {
    3768|       CHINESE_VARIATION_PRESETS,
    3769|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3770|     expect(CHINESE_VARIATION_PRESETS.length).toBeGreaterThan(3);
    3771|     const names = CHINESE_VARIATION_PRESETS.map((p: any) => p.name);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[55/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects parallel fifths
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3785:9
    3783|     const {
    3784|       checkVoiceLeadingSimple,
    3785|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3786|     // Two voices moving in parallel fifths: C-G → D-A
    3787|     const voices = [

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[56/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects voice crossing
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3799:9
    3797|     const {
    3798|       checkVoiceLeadingSimple,
    3799|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3800|     // Voice 0 goes below voice 1
    3801|     const voices = [

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[57/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Voice Leading Check (C939) > detects large leaps
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3813:9
    3811|     const {
    3812|       checkVoiceLeadingSimple,
    3813|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3814|     const voices = [
    3815|       [60, 84], // soprano leaps up 2 octaves

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[58/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sample Deck Exports (C991) > exports multiple deck definitions
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3831:9
    3829|     const {
    3830|       SAMPLE_DECK_EXPORTS,
    3831|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3832|     expect(SAMPLE_DECK_EXPORTS.length).toBeGreaterThan(5);
    3833|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[59/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sample Deck Exports (C991) > each deck has name, cards, and description
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3838:9
    3836|     const {
    3837|       SAMPLE_DECK_EXPORTS,
    3838|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3839|     for (const deck of SAMPLE_DECK_EXPORTS) {
    3840|       expect(deck.name.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[60/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sample Board Presets (C992) > exports multiple board presets
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3855:9
    3853|     const {
    3854|       SAMPLE_BOARD_PRESETS,
    3855|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3856|     expect(SAMPLE_BOARD_PRESETS.length).toBeGreaterThan(3);
    3857|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[61/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sample Board Presets (C992) > each board has name and decks
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3862:9
    3860|     const {
    3861|       SAMPLE_BOARD_PRESETS,
    3862|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3863|     for (const board of SAMPLE_BOARD_PRESETS) {
    3864|       expect(board.name.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[62/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > returns config for beginner
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3878:9
    3876|     const {
    3877|       getTheoryModeConfig,
    3878|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3879|     const config = getTheoryModeConfig('beginner');
    3880|     expect(config.level).toBe('beginner');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[63/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > returns config for pro
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3888:9
    3886|     const {
    3887|       getTheoryModeConfig,
    3888|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3889|     const config = getTheoryModeConfig('pro');
    3890|     expect(config.level).toBe('pro');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[64/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Mode Config (C987, C988) > progressive disclosure increases with level
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3898:9
    3896|     const {
    3897|       getTheoryModeConfig,
    3898|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3899|     const beginner = getTheoryModeConfig('beginner');
    3900|     const advanced = getTheoryModeConfig('advanced');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[65/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > records events
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3913:9
    3911|     const {
    3912|       TheoryTelemetry,
    3913|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3914|     const telemetry = new TheoryTelemetry();
    3915|     telemetry.record('schema_card', 'open');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[66/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > computes usage summary
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3924:9
    3922|     const {
    3923|       TheoryTelemetry,
    3924|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3925|     const telemetry = new TheoryTelemetry();
    3926|     telemetry.record('schema_card', 'open');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[67/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > gets most used tools
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3937:9
    3935|     const {
    3936|       TheoryTelemetry,
    3937|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3938|     const telemetry = new TheoryTelemetry();
    3939|     telemetry.record('schema_card', 'open');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[68/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Telemetry (C989) > clears events
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3951:9
    3949|     const {
    3950|       TheoryTelemetry,
    3951|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3952|     const telemetry = new TheoryTelemetry();
    3953|     telemetry.record('test', 'action');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[69/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Arrangement Templates (C694) > provides templates for common tune types
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3968:9
    3966|       CELTIC_ARRANGEMENT_TEMPLATES,
    3967|       getCelticArrangementTemplate,
    3968|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3969|     expect(CELTIC_ARRANGEMENT_TEMPLATES.length).toBeGreaterThan(3);
    3970|     const reel = getCelticArrangementTemplate('reel');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[70/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Arrangement Templates (C694) > each template has structure and tempo
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3978:9
    3976|     const {
    3977|       CELTIC_ARRANGEMENT_TEMPLATES,
    3978|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3979|     for (const template of CELTIC_ARRANGEMENT_TEMPLATES) {
    3980|       expect(template.structure.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[71/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > builds a set from tunes
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:3994:9
    3992|     const {
    3993|       buildTuneSet,
    3994|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    3995|     const tunes = [
    3996|       { name: 'Morrison\'s Jig', tuneType: 'jig', key: 'd' },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[72/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > scores related keys higher
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4009:9
    4007|     const {
    4008|       buildTuneSet,
    4009|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4010|     const relatedKeys = buildTuneSet([
    4011|       { name: 'A', tuneType: 'reel', key: 'd' },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[73/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Set Builder (C734) > estimates duration
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4024:9
    4022|     const {
    4023|       buildTuneSet,
    4024|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4025|     const set = buildTuneSet([
    4026|       { name: 'A', tuneType: 'reel', key: 'd' },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[74/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Vocabulary Export (C1441) > exports vocabulary to practice sheet
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4040:9
    4038|     const {
    4039|       exportVocabularyToPracticeSheet,
    4040|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4041|     const vocab = [
    4042|       { pattern: [60, 62, 64], name: 'Major scale fragment', category:…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[75/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Vocabulary Export (C1441) > respects difficulty parameter
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4055:9
    4053|     const {
    4054|       exportVocabularyToPracticeSheet,
    4055|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4056|     const sheet = exportVocabularyToPracticeSheet([], 'Test', 'beginne…
    4057|     expect(sheet.difficulty).toBe('beginner');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[76/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > generates AABB markers
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4069:9
    4067|     const {
    4068|       generateFormMarkers,
    4069|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4070|     const markers = generateFormMarkers('AABB');
    4071|     expect(markers.length).toBe(2);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[77/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > handles AABBCC
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4081:9
    4079|     const {
    4080|       generateFormMarkers,
    4081|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4082|     const markers = generateFormMarkers('AABBCC');
    4083|     expect(markers.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[78/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > computes bar positions
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4090:9
    4088|     const {
    4089|       generateFormMarkers,
    4090|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4091|     const markers = generateFormMarkers('AABB', 8);
    4092|     expect(markers[0]!.startBar).toBe(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[79/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Form Markers (C693) > has standard Celtic patterns
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4101:9
    4099|     const {
    4100|       CELTIC_FORM_PATTERNS,
    4101|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4102|     expect(CELTIC_FORM_PATTERNS['reel']).toBe('AABB');
    4103|     expect(CELTIC_FORM_PATTERNS['march']).toBe('AABBCC');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[80/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > has multiple voicing templates
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4115:9
    4113|     const {
    4114|       CELTIC_HARP_VOICINGS,
    4115|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4116|     expect(CELTIC_HARP_VOICINGS.length).toBeGreaterThan(3);
    4117|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[81/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > finds voicing for tune type
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4122:9
    4120|     const {
    4121|       getHarpVoicing,
    4122|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4123|     const voicing = getHarpVoicing('reel');
    4124|     expect(voicing.suitableFor).toContain('reel');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[82/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Harp Voicings (C748) > returns default for unknown type
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4131:9
    4129|     const {
    4130|       getHarpVoicing,
    4131|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4132|     const voicing = getHarpVoicing('unknown_type');
    4133|     expect(voicing).toBeDefined();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[83/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sheng Voicings (C815) > has multiple voicing templates
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4145:9
    4143|     const {
    4144|       SHENG_VOICINGS,
    4145|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4146|     expect(SHENG_VOICINGS.length).toBeGreaterThan(3);
    4147|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[84/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Sheng Voicings (C815) > finds voicing for mode
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4152:9
    4150|     const {
    4151|       getShengVoicing,
    4152|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4153|     const voicing = getShengVoicing('gong');
    4154|     expect(voicing.suitableFor).toContain('gong');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[85/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > marks intro at position 0
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4166:9
    4164|     const {
    4165|       suggestSectionMarkers,
    4166|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4167|     const markers = suggestSectionMarkers([0.2, 0.3, 0.4, 0.8, 0.9, 0.…
    4168|     expect(markers[0]!.position).toBe(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[86/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > detects energy jumps as boundaries
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4175:9
    4173|     const {
    4174|       suggestSectionMarkers,
    4175|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4176|     const markers = suggestSectionMarkers([0.2, 0.2, 0.8, 0.8, 0.2, 0.…
    4177|     // Should find at least intro + energy change at position 2

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[87/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Section Markers (C828) > returns empty for empty input
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4184:9
    4182|     const {
    4183|       suggestSectionMarkers,
    4184|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4185|     const markers = suggestSectionMarkers([]);
    4186|     expect(markers.length).toBe(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[88/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > builds schema result card
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4198:9
    4196|     const {
    4197|       buildAnalysisResultCard,
    4198|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4199|     const card = buildAnalysisResultCard('schema', { schemaName: 'roma…
    4200|     expect(card.category).toBe('schema');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[89/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > builds culture result card
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4209:9
    4207|     const {
    4208|       buildAnalysisResultCard,
    4209|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4210|     const card = buildAnalysisResultCard('culture', { culture: 'carnat…
    4211|     expect(card.category).toBe('culture');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[90/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Analysis Result Cards (C884) > handles unknown analysis type
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4218:9
    4216|     const {
    4217|       buildAnalysisResultCard,
    4218|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4219|     const card = buildAnalysisResultCard('custom', { foo: 'bar' });
    4220|     expect(card.category).toBe('general');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[91/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Orchestration Role Allocation (C899) > allocates roles for default style
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4232:9
    4230|     const {
    4231|       allocateOrchestrationRoles,
    4232|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4233|     const roles = allocateOrchestrationRoles(3);
    4234|     expect(roles.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[92/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Orchestration Role Allocation (C899) > uses style-specific templates
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4243:9
    4241|     const {
    4242|       allocateOrchestrationRoles,
    4243|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4244|     const jazzRoles = allocateOrchestrationRoles(4, 'jazz');
    4245|     expect(jazzRoles[0]!.instrument).toBe('saxophone');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[93/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Mixer Defaults (C900) > generates mixer defaults from roles
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4255:9
    4253|       allocateOrchestrationRoles,
    4254|       generateMixerDefaults,
    4255|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4256|     const roles = allocateOrchestrationRoles(3);
    4257|     const mixer = generateMixerDefaults(roles);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[94/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Variation Recommendations (C932) > recommends variations for song parts
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4272:9
    4270|     const {
    4271|       recommendVariations,
    4272|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4273|     const recs = recommendVariations(['intro', 'verse', 'chorus', 'out…
    4274|     expect(recs.length).toBe(4);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[95/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Fill Triggers (C934) > suggests fills at section boundaries
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4288:9
    4286|     const {
    4287|       suggestFillTriggers,
    4288|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4289|     const triggers = suggestFillTriggers([8, 16, 24], 32);
    4290|     expect(triggers.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[96/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Fill Triggers (C934) > assigns higher intensity near end
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4297:9
    4295|     const {
    4296|       suggestFillTriggers,
    4297|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4298|     const triggers = suggestFillTriggers([4, 28], 32);
    4299|     expect(triggers[1]!.intensity).toBeGreaterThan(triggers[0]!.intens…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[97/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > provides galant board template
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4311:9
    4309|     const {
    4310|       GALANT_BOARD_TEMPLATE,
    4311|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4312|     expect(GALANT_BOARD_TEMPLATE.id).toBe('galant-workspace');
    4313|     expect(GALANT_BOARD_TEMPLATE.decks).toContain('notation');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[98/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > provides celtic board template
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4320:9
    4318|     const {
    4319|       CELTIC_BOARD_TEMPLATE,
    4320|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4321|     expect(CELTIC_BOARD_TEMPLATE.id).toBe('celtic-session');
    4322|     expect(CELTIC_BOARD_TEMPLATE.decks).toContain('tracker');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[99/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Board Templates (C349, C350, C751) > getAllBoardTemplates returns all
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4329:9
    4327|     const {
    4328|       getAllBoardTemplates,
    4329|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4330|     const templates = getAllBoardTemplates();
    4331|     expect(templates.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[100/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > searches by query
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4343:9
    4341|     const {
    4342|       searchConstraints,
    4343|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4344|     const results = searchConstraints('raga');
    4345|     expect(results.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[101/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > filters by culture
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4352:9
    4350|     const {
    4351|       searchConstraints,
    4352|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4353|     const results = searchConstraints('', { culture: 'celtic' });
    4354|     const allCelticOrUniversal = results.every(

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[102/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > filters by category
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4363:9
    4361|     const {
    4362|       searchConstraints,
    4363|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4364|     const results = searchConstraints('', { category: 'rhythm' });
    4365|     expect(results.every((r: any) => r.category === 'rhythm')).toBe(tr…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[103/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Search (C1012) > returns all for empty query
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4371:9
    4369|     const {
    4370|       searchConstraints,
    4371|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4372|     const results = searchConstraints('');
    4373|     expect(results.length).toBeGreaterThan(20);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[104/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > has multiple templates
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4385:9
    4383|     const {
    4384|       LCC_POLYCHORD_TEMPLATES,
    4385|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4386|     expect(LCC_POLYCHORD_TEMPLATES.length).toBeGreaterThan(2);
    4387|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[105/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > finds template for lydian scale
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4392:9
    4390|     const {
    4391|       getLCCPolychordForScale,
    4392|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4393|     const template = getLCCPolychordForScale('lydian');
    4394|     expect(template).toBeDefined();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[106/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Polychord Templates (C1171) > returns undefined for unknown scale
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4401:9
    4399|     const {
    4400|       getLCCPolychordForScale,
    4401|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4402|     const template = getLCCPolychordForScale('chromatic');
    4403|     expect(template).toBeUndefined();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[107/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Reharmonization (C1340, C1341) > suggests tritone substitutions
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4415:9
    4413|     const {
    4414|       suggestReharmonizations,
    4415|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4416|     const results = suggestReharmonizations(['G7', 'Cmaj7'], 'jazz');
    4417|     expect(results[0]!.suggestions.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[108/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Reharmonization (C1340, C1341) > filters by context
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4426:9
    4424|     const {
    4425|       suggestReharmonizations,
    4426|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4427|     const jazzResults = suggestReharmonizations(['C'], 'jazz');
    4428|     const filmResults = suggestReharmonizations(['C'], 'film');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[109/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Bebop Vocabulary Constraints (C1398) > has multiple pattern constraints
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4443:9
    4441|     const {
    4442|       BEBOP_VOCABULARY_CONSTRAINTS,
    4443|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4444|     expect(BEBOP_VOCABULARY_CONSTRAINTS.length).toBeGreaterThan(4);
    4445|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[110/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Tracker Jazz Patterns (C1399) > has patterns of various difficulties
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4452:9
    4450|     const {
    4451|       getJazzPatterns,
    4452|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4453|     const beginner = getJazzPatterns(undefined, 'beginner');
    4454|     const advanced = getJazzPatterns(undefined, 'advanced');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[111/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Tracker Jazz Patterns (C1399) > filters by category
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4462:9
    4460|     const {
    4461|       getJazzPatterns,
    4462|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4463|     const bebop = getJazzPatterns('bebop');
    4464|     expect(bebop.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[112/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Solo Section Config (C1400) > generates config for bebop
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4473:9
    4471|     const {
    4472|       generateSoloSectionConfig,
    4473|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4474|     const config = generateSoloSectionConfig('saxophone', 'bebop', 2);
    4475|     expect(config.instrument).toBe('saxophone');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[113/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Solo Section Config (C1400) > generates config for blues
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4484:9
    4482|     const {
    4483|       generateSoloSectionConfig,
    4484|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4485|     const config = generateSoloSectionConfig('guitar', 'blues', 1);
    4486|     expect(config.vocabularyLevel).toBe('beginner');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[114/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Heterophony Lanes (C794) > generates lanes with lead as first
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4499:9
    4497|     const {
    4498|       generateHeterophonyLanes,
    4499|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4500|     const melody = [
    4501|       { midi: 60, time: 0, duration: 0.5 },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[115/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Heterophony Lanes (C794) > assigns culture-specific labels
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4513:9
    4511|     const {
    4512|       generateHeterophonyLanes,
    4513|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4514|     const melody = [{ midi: 60, time: 0, duration: 0.5 }];
    4515|     const lanes = generateHeterophonyLanes(melody, 3, 'chinese');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[116/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > supports push and undo
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4529:9
    4527|     const {
    4528|       HostActionUndoStack,
    4529|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4530|     const stack = new HostActionUndoStack();
    4531|     const action = {

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[117/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > supports redo
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4549:9
    4547|     const {
    4548|       HostActionUndoStack,
    4549|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4550|     const stack = new HostActionUndoStack();
    4551|     stack.push({ id: '1', timestamp: 0, description: 'test', type: 'x'…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[118/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > HostActionUndoStack (C922) > clears redo on new push
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4561:9
    4559|     const {
    4560|       HostActionUndoStack,
    4561|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4562|     const stack = new HostActionUndoStack();
    4563|     stack.push({ id: '1', timestamp: 0, description: 'test', type: 'x'…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[119/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > installs and retrieves packs
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4578:9
    4576|     const {
    4577|       ConstraintPackManager,
    4578|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4579|     const manager = new ConstraintPackManager();
    4580|     const result = manager.install({

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[120/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > prevents duplicate installs
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4596:9
    4594|     const {
    4595|       ConstraintPackManager,
    4596|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4597|     const manager = new ConstraintPackManager();
    4598|     manager.install({ id: 'p1', name: 'P1', version: '1.0', constraint…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[121/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > ConstraintPackManager (C1013) > enables and disables packs
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4606:9
    4604|     const {
    4605|       ConstraintPackManager,
    4606|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4607|     const manager = new ConstraintPackManager();
    4608|     manager.install({ id: 'p1', name: 'P1', version: '1.0', constraint…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[122/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Voice Leading (C1170) > scores smooth voice leading
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4624:9
    4622|     const {
    4623|       suggestLCCVoiceLeading,
    4624|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4625|     const result = suggestLCCVoiceLeading([60, 64, 67], [60, 65, 69]);
    4626|     expect(result.totalMovement).toBe(3); // 0 + 1 + 2

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[123/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Voice Leading (C1170) > flags wide voice leading
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4633:9
    4631|     const {
    4632|       suggestLCCVoiceLeading,
    4633|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4634|     const result = suggestLCCVoiceLeading([48, 55, 60], [60, 67, 72]);
    4635|     expect(result.totalMovement).toBeGreaterThan(6);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[124/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > PersonalVocabularyLibrary (C1439) > adds and retrieves entries
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4648:9
    4646|     const {
    4647|       PersonalVocabularyLibrary,
    4648|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4649|     const lib = new PersonalVocabularyLibrary();
    4650|     lib.add({

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[125/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > PersonalVocabularyLibrary (C1439) > searches by query
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4667:9
    4665|     const {
    4666|       PersonalVocabularyLibrary,
    4667|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4668|     const lib = new PersonalVocabularyLibrary();
    4669|     lib.add({

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[126/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Pitch Class Visualization (C1079) > generates 12 pitch classes
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4691:9
    4689|     const {
    4690|       generatePitchClassVisualization,
    4691|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4692|     const viz = generatePitchClassVisualization(0, [0, 2, 4, 5, 7, 9, …
    4693|     expect(viz.pitchClasses.length).toBe(12);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[127/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Beat Grid Visualization (C1080) > generates beats for 4/4
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4704:9
    4702|     const {
    4703|       generateBeatGridVisualization,
    4704|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4705|     const viz = generateBeatGridVisualization(4, 4, 120);
    4706|     expect(viz.beats.length).toBe(4);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[128/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Tension Graph Visualization (C1081) > generates tension points
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4716:9
    4714|     const {
    4715|       generateTensionGraph,
    4716|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4717|     const viz = generateTensionGraph([
    4718|       { chord: 'Cmaj7', tension: 0.2 },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[129/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Diff (C1084) > detects added constraints
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4735:9
    4733|     const {
    4734|       diffConstraints,
    4735|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4736|     const before = [{ type: 'key', hard: true, key: { root: 'c', mode:…
    4737|     const after = [

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[130/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Diff (C1084) > detects removed constraints
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4750:9
    4748|     const {
    4749|       diffConstraints,
    4750|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4751|     const before = [
    4752|       { type: 'key', hard: true },

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[131/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > ConstraintUsageTracker (C1097) > tracks events and computes stats
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4770:9
    4768|     const {
    4769|       ConstraintUsageTracker,
    4770|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4771|     const tracker = new ConstraintUsageTracker();
    4772|     tracker.track('key', 'add');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[132/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > ConstraintUsageTracker (C1097) > finds most used constraints
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4784:9
    4782|     const {
    4783|       ConstraintUsageTracker,
    4784|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4785|     const tracker = new ConstraintUsageTracker();
    4786|     tracker.track('key', 'add');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[133/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Ear Training (C1442) > generates interval exercises
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4804:9
    4802|     const {
    4803|       generateEarTrainingExercises,
    4804|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4805|     const exercises = generateEarTrainingExercises('interval', 'beginn…
    4806|     expect(exercises.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[134/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Ear Training (C1442) > generates chord exercises
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4815:9
    4813|     const {
    4814|       generateEarTrainingExercises,
    4815|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4816|     const exercises = generateEarTrainingExercises('chord', 'intermedi…
    4817|     expect(exercises.length).toBe(2);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[135/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phrase Adaptation (C877, C878) > transposes phrase to target key
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4831:9
    4829|     const {
    4830|       adaptPhraseToContext,
    4831|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4832|     const result = adaptPhraseToContext(
    4833|       [60, 64, 67], [0.5, 0.5, 1.0],

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[136/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phrase Adaptation (C877, C878) > scales rhythm for tempo change
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4844:9
    4842|     const {
    4843|       adaptPhraseToContext,
    4844|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4845|     const result = adaptPhraseToContext(
    4846|       [60], [0.5],

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[137/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Prolog Preview (C1052) > generates key constraint preview
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4862:9
    4860|     const {
    4861|       constraintToPrologPreview,
    4862|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4863|     const preview = constraintToPrologPreview({ type: 'style', style: …
    4864|     expect(preview).toContain('style_constraint');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[138/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Prolog Preview (C1052) > generates multi-constraint preview
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4871:9
    4869|     const {
    4870|       constraintsToPrologPreview,
    4871|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4872|     const preview = constraintsToPrologPreview([
    4873|       { type: 'tempo', bpm: 120, hard: false } as any,

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[139/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Explain Constraint (C1054) > explains key constraint
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4889:9
    4887|     const {
    4888|       explainConstraint,
    4889|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4890|     const explanation = explainConstraint({ type: 'key', hard: true, k…
    4891|     expect(explanation.humanReadable).toContain('key');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[140/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Explain Constraint (C1054) > handles unknown constraint types
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4900:9
    4898|     const {
    4899|       explainConstraint,
    4900|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4901|     const explanation = explainConstraint({ type: 'custom_xyz', hard: …
    4902|     expect(explanation.humanReadable).toContain('custom_xyz');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[141/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > has starter listings
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4914:9
    4912|     const {
    4913|       MARKETPLACE_LISTINGS,
    4914|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4915|     expect(MARKETPLACE_LISTINGS.length).toBeGreaterThan(2);
    4916|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[142/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > searches by query
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4921:9
    4919|     const {
    4920|       searchMarketplace,
    4921|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4922|     const results = searchMarketplace('jazz');
    4923|     expect(results.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[143/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Theory Card Marketplace (C1070) > filters by culture
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4929:9
    4927|     const {
    4928|       searchMarketplace,
    4929|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4930|     const results = searchMarketplace('', { culture: 'celtic' });
    4931|     expect(results.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[144/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Target Note Practice (C1436) > generates practice for known chords
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4944:9
    4942|     const {
    4943|       generateTargetNotePractice,
    4944|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4945|     const practice = generateTargetNotePractice(['Cmaj7', 'Dm7', 'G7']…
    4946|     expect(practice.chordProgression.length).toBe(3);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[145/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Target Note Practice (C1436) > increases targets with difficulty
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4954:9
    4952|     const {
    4953|       generateTargetNotePractice,
    4954|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4955|     const beginner = generateTargetNotePractice(['Cmaj7'], 'beginner');
    4956|     const advanced = generateTargetNotePractice(['Cmaj7'], 'advanced');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[146/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Card Pack Prolog Bundling (C1032) > extracts predicates from Prolog code
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4969:9
    4967|     const {
    4968|       createCardPackPrologBundle,
    4969|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4970|     const bundle = createCardPackPrologBundle('test-pack', 'my_pred(X)…
    4971|     expect(bundle.packId).toBe('test-pack');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[147/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Inline Prolog Snippets (C1033) > namespaces predicates
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4980:9
    4978|     const {
    4979|       createInlinePrologSnippet,
    4980|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4981|     const result = createInlinePrologSnippet('card1', 'my_rule(X) :- t…
    4982|     expect(result.namespacedCode).toContain('user_card1_my_rule');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[148/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > validates correct Prolog
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:4994:9
    4992|     const {
    4993|       checkPrologSyntax,
    4994|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    4995|     const result = checkPrologSyntax('my_pred(X) :- atom(X).\nother(Y)…
    4996|     expect(result.valid).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[149/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > detects missing period
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5003:9
    5001|     const {
    5002|       checkPrologSyntax,
    5003|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5004|     const result = checkPrologSyntax('my_pred(X) :- atom(X)');
    5005|     // Should detect missing period

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[150/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Prolog Syntax Check (C981) > skips comments
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5012:9
    5010|     const {
    5011|       checkPrologSyntax,
    5012|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5013|     const result = checkPrologSyntax('% This is a comment\n/* block */…
    5014|     expect(result.valid).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[151/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Round-Trip Tests (C921) > changing spec constraints updates recommendations
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5026:9
    5024|     const {
    5025|       searchConstraints,
    5026|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5027| 
    5028|     // First: filter for jazz constraints

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[152/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Round-Trip Tests (C921) > accept recommendation → modify → new recommendations differ
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5046:9
    5044|     const {
    5045|       recommendVariations,
    5046|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5047| 
    5048|     // First recommendation

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[153/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Visualization Updates (C1089) > pitch class display updates on scale change
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5067:9
    5065|     const {
    5066|       generatePitchClassVisualization,
    5067|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5068| 
    5069|     const cMajor = generatePitchClassVisualization(0, [0, 2, 4, 5, 7, …

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[154/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Constraint Visualization Updates (C1089) > beat grid updates on meter change
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5084:9
    5082|     const {
    5083|       generateBeatGridVisualization,
    5084|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5085| 
    5086|     const four4 = generateBeatGridVisualization(4, 4);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[155/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Generic Editor Parameter Types (C1087) > editor fields handle all basic theory card params
TypeError: Cannot read properties of undefined (reading 'Key')
 ❯ src/ai/theory/custom-constraints.ts:2315:19
    2313|   return defs.map(def => ({
    2314|     paramDef: def,
    2315|     currentValue: currentValues[def.label] ?? ('defaultValue' in def ?…
       |                   ^
    2316|     fieldType: def.kind,
    2317|   }));
 ❯ Module.generateEditorFields src/ai/theory/custom-constraints.ts:2313:15
 ❯ src/ai/theory/spec-event-bus.test.ts:5105:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[156/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Celtic Workflow Integration (C760) > full Celtic workflow: tune type → form → ornaments → set
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5130:9
    5128|       buildTuneSet,
    5129|       getCelticArrangementTemplate,
    5130|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5131| 
    5132|     // 1. Choose tune type

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[157/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Chinese Workflow Integration (C857) > full Chinese workflow: mode → heterophony → ornaments
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5173:9
    5171|       generateHeterophonyLanes,
    5172|       assignHeterophonyRoles,
    5173|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5174| 
    5175|     // 1. Select mode

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[158/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > LCC Workflow Integration (C1200) > full LCC workflow: scale → voicing → voice leading
TypeError: actual value must be number or bigint, received "undefined"
 ❯ src/ai/theory/spec-event-bus.test.ts:5204:31
    5202|   it('full LCC workflow: scale → voicing → voice leading', () => {
    5203|     // 1. Get LCC scale
    5204|     expect(LCC_SCALES.length).toBeGreaterThan(5);
       |                               ^
    5205|     const lydian = LCC_SCALES.find((s: any) => s.name === 'lydian');
    5206|     expect(lydian).toBeDefined();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[159/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Arranging Workflow (C1350) > full jazz workflow: voicing → reharmonization → solo section
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5243:9
    5241|       BEBOP_VOCABULARY_CONSTRAINTS,
    5242|       allocateOrchestrationRoles,
    5243|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5244| 
    5245|     // 1. Get reharmonizations

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[160/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Improv Workflow (C1445) > full improv workflow: vocabulary → patterns → practice
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5278:9
    5276|       exportVocabularyToPracticeSheet,
    5277|       PersonalVocabularyLibrary,
    5278|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5279| 
    5280|     // 1. Browse patterns

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[161/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Custom Constraint Ecosystem Integration (C1099) > full ecosystem: define → register → search → preview → explain
Error: Cannot find module '../../queries/spec-queries'
Require stack:
- /Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts
 ❯ TracingChannel.traceSync node:diagnostics_channel:328:14
 ❯ src/ai/theory/spec-event-bus.test.ts:5322:9
    5320|       ConstraintUsageTracker,
    5321|       ConstraintPackManager,
    5322|     } = require('../../queries/spec-queries') as typeof import('../../…
       |         ^
    5323| 
    5324|     // 1. Search available constraints

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 'MODULE_NOT_FOUND', requireStack: [ '/Users/halleyyoung/Documents/behavioral/cardplay/src/ai/theory/spec-event-bus.test.ts' ] }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[162/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Theory Cross-Phase Validation > C1447 LCC constraints work with jazz voicings
TypeError: fromChord.join is not a function
 ❯ Module.suggestLCCVoiceLeading src/ai/queries/spec-queries.ts:12968:26
    12966| 
    12967|   return {
    12968|     fromChord: fromChord.join('-'),
       |                          ^
    12969|     toChord: toChord.join('-'),
    12970|     voiceMovements,
 ❯ src/ai/theory/spec-event-bus.test.ts:5374:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[163/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Jazz Theory Cross-Phase Validation > C1448 jazz voicings work with reharmonization
AssertionError: expected undefined to be truthy

- Expected: 
undefined

+ Received: 
false

 ❯ src/ai/theory/spec-event-bus.test.ts:5390:30
    5388|     for (const t of templates) {
    5389|       expect(t.name).toBeTruthy();
    5390|       expect(t.substitution).toBeTruthy();
       |                              ^
    5391|     }
    5392|     // Reharmonization suggestions should produce jazz-valid chords

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[164/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1474 spectral analysis produces correct centroids
TypeError: actual value must be number or bigint, received "object"
 ❯ src/ai/theory/spec-event-bus.test.ts:5454:25
    5452|     ];
    5453|     const lowCentroid = sq.calculateSpectralCentroid(lowSpectrum);
    5454|     expect(lowCentroid).toBeGreaterThan(0);
       |                         ^
    5455|     expect(lowCentroid).toBeLessThan(500);
    5456| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[165/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1490 spectral morphing interpolates correctly
TypeError: Cannot read properties of undefined (reading 'amplitude')
 ❯ src/ai/theory/spec-event-bus.test.ts:5482:23
    5480|     const morphMid = sq.morphSpectrum(spec1, spec2, 0.5);
    5481|     // At t=0, should match spec1 amplitudes
    5482|     expect(morph0[0]!.amplitude).toBeCloseTo(1.0, 1);
       |                       ^
    5483|     // At t=1, should match spec2 amplitudes
    5484|     expect(morph1[0]!.amplitude).toBeCloseTo(0.2, 1);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[166/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C14 — Computational Orchestration Tests > C1530 parsimonious path finds smooth voice leading
AssertionError: expected undefined not to be undefined
 ❯ src/ai/theory/spec-event-bus.test.ts:5513:27
    5511|     );
    5512|     expect(path).toBeDefined();
    5513|     expect(path.distance).toBeDefined();
       |                           ^
    5514|     expect(path.distance).toBeGreaterThanOrEqual(0);
    5515|     // C major to A minor is a relative key — should be short distance

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[167/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C15 — Film Scoring Tests > C1694 composer style matching returns valid results
TypeError: cueFeatures.join is not a function
 ❯ Module.matchComposerStyle src/ai/queries/spec-queries.ts:4266:35
    4264|   await ensureLoaded(adapter);
    4265| 
    4266|   const cueList = `[${cueFeatures.join(',')}]`;
       |                                   ^
    4267|   const result = await adapter.querySingle(
    4268|     `composer_style_match(${cueList}, ${composer}, Score).`
 ❯ src/ai/theory/spec-event-bus.test.ts:5566:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[168/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C15 — Film Scoring Tests > C1699 emotion and composer systems integrate
TypeError: features.map is not a function
 ❯ Module.mapMusicToEmotion src/ai/queries/spec-queries.ts:4155:36
    4153|   await ensureLoaded(adapter);
    4154| 
    4155|   const featureList = `[${features.map((f) => `${f.key}(${f.value})`).…
       |                                    ^
    4156|   const result = await adapter.querySingle(
    4157|     `composite_emotion_model(${featureList}, russell, emotion(Label, v…
 ❯ src/ai/theory/spec-event-bus.test.ts:5582:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[169/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1746 raga details include fusion-compatible data
AssertionError: expected undefined not to be undefined
 ❯ src/ai/theory/spec-event-bus.test.ts:5610:55
    5608|     if (raga) {
    5609|       // Should have scale info that can map to Western
    5610|       expect(raga.aroha || raga.scale || raga.swaras).toBeDefined();
       |                                                       ^
    5611|     }
    5612|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[170/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1776 maqam details include modulation info
AssertionError: expected undefined not to be undefined
 ❯ src/ai/theory/spec-event-bus.test.ts:5640:56
    5638|     if (maqam) {
    5639|       // Should have jins (tetrachord) info
    5640|       expect(maqam.name || maqam.jins1 || maqam.ajnas).toBeDefined();
       |                                                        ^
    5641|     }
    5642|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[171/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C16 — World Music Tests > C1789 maqam + emotion model cross-validation
TypeError: features.map is not a function
 ❯ Module.mapMusicToEmotion src/ai/queries/spec-queries.ts:4155:36
    4153|   await ensureLoaded(adapter);
    4154| 
    4155|   const featureList = `[${features.map((f) => `${f.key}(${f.value})`).…
       |                                    ^
    4156|   const result = await adapter.querySingle(
    4157|     `composite_emotion_model(${featureList}, russell, emotion(Label, v…
 ❯ src/ai/theory/spec-event-bus.test.ts:5656:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[172/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2090 all cultures work with emotion models
TypeError: features.map is not a function
 ❯ Module.mapMusicToEmotion src/ai/queries/spec-queries.ts:4155:36
    4153|   await ensureLoaded(adapter);
    4154| 
    4155|   const featureList = `[${features.map((f) => `${f.key}(${f.value})`).…
       |                                    ^
    4156|   const result = await adapter.querySingle(
    4157|     `composite_emotion_model(${featureList}, russell, emotion(Label, v…
 ❯ src/ai/theory/spec-event-bus.test.ts:5772:28

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[173/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2095 popular music final integration
TypeError: adapter.loadProgram is not a function
 ❯ Module.loadMusicTheoryKB src/ai/knowledge/music-theory-loader.ts:71:17
     69|   }
     70| 
     71|   await adapter.loadProgram(musicTheoryPl, 'music-theory-kb');
       |                 ^
     72|   await adapter.loadProgram(musicTheoryComputationalPl, 'music-theory-…
     73|   await adapter.loadProgram(musicTheoryGalantPl, 'music-theory-kb/gala…
 ❯ ensureLoaded src/ai/queries/spec-queries.ts:180:9
 ❯ Module.getRockProgression src/ai/queries/spec-queries.ts:4642:9
 ❯ src/ai/theory/spec-event-bus.test.ts:5817:27

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[174/446]⎯

 FAIL  src/ai/theory/spec-event-bus.test.ts > Phase C18 — Cross-Cultural & Final Integration > C2096 film scoring final integration
TypeError: features.map is not a function
 ❯ Module.mapMusicToEmotion src/ai/queries/spec-queries.ts:4155:36
    4153|   await ensureLoaded(adapter);
    4154| 
    4155|   const featureList = `[${features.map((f) => `${f.key}(${f.value})`).…
       |                                    ^
    4156|   const result = await adapter.querySingle(
    4157|     `composite_emotion_model(${featureList}, russell, emotion(Label, v…
 ❯ src/ai/theory/spec-event-bus.test.ts:5833:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[175/446]⎯

 FAIL  src/boards/__tests__/board-factory-validation.test.ts > B134: Board Factory Validation > all referenced deck types have registered factories
AssertionError: Missing factories for: pattern-deck, instruments-deck, dsp-chain, properties-deck, harmony-deck, phrases-deck, session-deck, mixer-deck, samples-deck, arrangement-deck, notation-deck, arranger-deck, generators-deck, ai-advisor-deck, transport-deck, routing-deck: expected [ 'pattern-deck', …(15) ] to have a length of +0 but got 16

- Expected
+ Received

- 0
+ 16

 ❯ src/boards/__tests__/board-factory-validation.test.ts:115:7
    113|       missingFactories,
    114|       `Missing factories for: ${missingFactories.join(', ')}`
    115|     ).toHaveLength(0);
       |       ^
    116|   });
    117| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[176/446]⎯

 FAIL  src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > I024: Session clip selection updates notation/tracker editor > should update active context when selecting clip
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
 ❯ Object.setSelection src/state/selection-state.ts:216:19
    214|       
    215|       state = {
    216|         selected: new Set(eventIds),
       |                   ^
    217|         primary: eventIds[0] ?? null,
    218|         streamId: streamId ?? null,
 ❯ src/boards/__tests__/cross-view-sync.integration.test.ts:132:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[177/446]⎯

 FAIL  src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > I024: Session clip selection updates notation/tracker editor > should maintain selection across board switches
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
 ❯ Object.setSelection src/state/selection-state.ts:216:19
    214|       
    215|       state = {
    216|         selected: new Set(eventIds),
       |                   ^
    217|         primary: eventIds[0] ?? null,
    218|         streamId: streamId ?? null,
 ❯ src/boards/__tests__/cross-view-sync.integration.test.ts:162:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[178/446]⎯

 FAIL  src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > Selection synchronization > should sync selection across tracker/piano roll/notation
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
 ❯ Object.setSelection src/state/selection-state.ts:216:19
    214|       
    215|       state = {
    216|         selected: new Set(eventIds),
       |                   ^
    217|         primary: eventIds[0] ?? null,
    218|         streamId: streamId ?? null,
 ❯ src/boards/__tests__/cross-view-sync.integration.test.ts:317:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[179/446]⎯

 FAIL  src/boards/__tests__/cross-view-sync.integration.test.ts > Cross-View Synchronization > Selection synchronization > should clear selection when switching with clearSelection option
TypeError: object is not iterable (cannot read property Symbol(Symbol.iterator))
 ❯ Object.setSelection src/state/selection-state.ts:216:19
    214|       
    215|       state = {
    216|         selected: new Set(eventIds),
       |                   ^
    217|         primary: eventIds[0] ?? null,
    218|         streamId: streamId ?? null,
 ❯ src/boards/__tests__/cross-view-sync.integration.test.ts:342:22

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[180/446]⎯

 FAIL  src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E079: Phrase drop writes events into store > should write phrase notes to active stream
AssertionError: expected undefined to be 'note' // Object.is equality

- Expected: 
"note"

+ Received: 
undefined

 ❯ src/boards/__tests__/drag-drop-integration.test.ts:95:30
     93|       
     94|       // Verify first note
     95|       expect(events[0].kind).toBe(EventKinds.NOTE);
       |                              ^
     96|       expect(events[0].start).toBe(asTick(0));
     97|       expect(events[0].duration).toBe(asTickDuration(48));

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[181/446]⎯

 FAIL  src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E079: Phrase drop writes events into store > should handle empty phrase gracefully
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/drag-drop-integration.test.ts:178:31
    176|       
    177|       // Should accept but write no events
    178|       expect(result.accepted).toBe(true);
       |                               ^
    179|       
    180|       const streamRecord = eventStore.getStream(stream.id);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[182/446]⎯

 FAIL  src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > E080: Disallowed drops rejected with reason > should reject generator card drop on manual-only deck
AssertionError: expected 'No handler registered for card-templa…' to contain 'generator'

- Expected
+ Received

- generator
+ No handler registered for card-template → dsp-chain

 ❯ src/boards/__tests__/drag-drop-integration.test.ts:271:29
    269|       
    270|       expect(result.accepted).toBe(false);
    271|       expect(result.reason).toContain('generator');
       |                             ^
    272|     });
    273| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[183/446]⎯

 FAIL  src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > Drop handler undo integration > should mark drop as undoable when successful
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/drag-drop-integration.test.ts:334:31
    332|       const result = await handleDrop(phrasePayload, dropContext);
    333|       
    334|       expect(result.accepted).toBe(true);
       |                               ^
    335|       expect(result.undoable).toBe(true);
    336|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[184/446]⎯

 FAIL  src/boards/__tests__/drag-drop-integration.test.ts > Drag/Drop Integration (E079-E080) > Multi-track phrase drops > should handle phrases with multiple tracks
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/drag-drop-integration.test.ts:367:31
    365|       const result = await handleDrop(multiTrackPhrase, dropContext);
    366|       
    367|       expect(result.accepted).toBe(true);
       |                               ^
    368|       
    369|       const streamRecord = eventStore.getStream(stream.id);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[185/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G026-G027: Chord tracking and undo > G026: should update tracker coloring when chord changes
TypeError: Cannot read properties of undefined (reading 'CHORD')
 ❯ src/boards/__tests__/phase-g-integration.test.ts:51:26
     49|       // Add a C major chord
     50|       const chordEvent = {
     51|         kind: EventKinds.CHORD,
       |                          ^
     52|         start: asTick(0),
     53|         duration: asTickDuration(192),

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[186/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G026-G027: Chord tracking and undo > G027: should make chord edits undoable
TypeError: Cannot read properties of undefined (reading 'CHORD')
 ❯ src/boards/__tests__/phase-g-integration.test.ts:97:26
     95|       // Add chord with undo support
     96|       const chordEvent = {
     97|         kind: EventKinds.CHORD,
       |                          ^
     98|         start: asTick(0),
     99|         duration: asTickDuration(192),

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[187/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G055: should show phrase library deck on Tracker+Phrases board
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:159:32
    157|       // Verify phrase library deck is in the layout
    158|       const hasPhraseLibrary = board!.decks.some(deck => deck.type ===…
    159|       expect(hasPhraseLibrary).toBe(true);
       |                                ^
    160|       
    161|       // Verify phrase database tool is enabled

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[188/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G056: should write correct event timings when dropping phrase
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:203:31
    201|       const result = await handleDrop(phrasePayload, dropContext);
    202|       
    203|       expect(result.accepted).toBe(true);
       |                               ^
    204|       
    205|       const streamRecord = eventStore.getStream(stream.id);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[189/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > G055-G057: Phrase library and drag/drop > G057: should make phrase drop undoable
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:253:31
    251|       // Drop phrase
    252|       const result = await handleDrop(phrasePayload, dropContext);
    253|       expect(result.accepted).toBe(true);
       |                               ^
    254|       expect(result.undoable).toBe(true);
    255|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[190/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Tracker+Harmony Board > should have harmony display deck visible
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:288:33
    286|       
    287|       const hasHarmonyDisplay = board!.decks.some(deck => deck.type ==…
    288|       expect(hasHarmonyDisplay).toBe(true);
       |                                 ^
    289|       
    290|       expect(board!.compositionTools.harmonyExplorer.enabled).toBe(tru…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[191/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Session+Generators Board > should have generator deck visible
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:302:32
    300|       
    301|       const hasGeneratorDeck = board!.decks.some(deck => deck.type ===…
    302|       expect(hasGeneratorDeck).toBe(true);
       |                                ^
    303|       
    304|       expect(board!.compositionTools.phraseGenerators.enabled).toBe(tr…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[192/446]⎯

 FAIL  src/boards/__tests__/phase-g-integration.test.ts > Phase G: Assisted Boards Integration > Notation+Harmony Board > should have notation and harmony decks
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/boards/__tests__/phase-g-integration.test.ts:318:27
    316|       const hasHarmony = board!.decks.some(deck => deck.type === 'harm…
    317|       
    318|       expect(hasNotation).toBe(true);
       |                           ^
    319|       expect(hasHarmony).toBe(true);
    320|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[193/446]⎯

 FAIL  src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > snapToChordTones > snaps notes to chord tones
TypeError: Cannot read properties of undefined (reading 'id')
 ❯ src/boards/builtins/harmony-analysis.test.ts:116:43
    114|       };
    115|       
    116|       snapToChordTones(streamId, [event1!.id], cMajor);
       |                                           ^
    117|       
    118|       // Check that note was snapped

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[194/446]⎯

 FAIL  src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > snapToChordTones > is undoable
TypeError: Cannot read properties of undefined (reading 'id')
 ❯ src/boards/builtins/harmony-analysis.test.ts:146:43
    144|       };
    145|       
    146|       snapToChordTones(streamId, [event1!.id], cMajor);
       |                                           ^
    147|       
    148|       // Undo

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[195/446]⎯

 FAIL  src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > harmonizeMelody > adds harmony notes below melody
TypeError: Cannot read properties of undefined (reading 'id')
 ❯ src/boards/builtins/harmony-analysis.test.ts:179:47
    177|       };
    178|       
    179|       harmonizeMelody(streamId, [melodyEvent!.id], cMajor);
       |                                               ^
    180|       
    181|       // Check that harmony note was added

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[196/446]⎯

 FAIL  src/boards/builtins/harmony-analysis.test.ts > Harmony Analysis > getReharmonizationSuggestions > suggests chords based on melody
AssertionError: expected 0 to be greater than 0
 ❯ src/boards/builtins/harmony-analysis.test.ts:229:34
    227|       const suggestions = getReharmonizationSuggestions(melodyEvents, …
    228|       
    229|       expect(suggestions.length).toBeGreaterThan(0);
       |                                  ^
    230|       expect(suggestions[0]).toHaveProperty('chord');
    231|       expect(suggestions[0]).toHaveProperty('score');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[197/446]⎯

 FAIL  src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > AI Arranger Board (H001-H025) > H022: smoke test - arranger board registered
AssertionError: expected undefined to be { id: 'ai-arranger', …(21) } // Object.is equality

- Expected: 
Object {
  "author": "CardPlay",
  "category": "Generative",
  "compositionTools": Object {
    "aiComposer": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "arrangerCard": Object {
      "enabled": true,
      "mode": "chord-follow",
    },
    "harmonyExplorer": Object {
      "enabled": true,
      "mode": "display-only",
    },
    "phraseDatabase": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "phraseGenerators": Object {
      "enabled": true,
      "mode": "on-demand",
    },
  },
  "connections": Array [],
  "controlLevel": "directed",
  "decks": Array [
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "arranger",
      "panelId": "arranger",
      "type": "arranger-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "clip-session",
      "panelId": "session",
      "type": "session-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "generators",
      "panelId": "generator",
      "type": "generators-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "mixer",
      "panelId": "mixer",
      "type": "mixer-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "tabs",
      "id": "properties",
      "panelId": "generator",
      "type": "properties-deck",
    },
  ],
  "description": "Directed arrangement - set chord progressions and style, AI generates parts, you curate",
  "difficulty": "advanced",
  "icon": "🎛️",
  "id": "ai-arranger",
  "layout": Object {
    "panels": Array [
      Object {
        "defaultHeight": 200,
        "id": "arranger",
        "position": "top",
        "role": "toolbar",
      },
      Object {
        "id": "session",
        "position": "center",
        "role": "composition",
      },
      Object {
        "defaultWidth": 300,
        "id": "generator",
        "position": "right",
        "role": "browser",
      },
      Object {
        "defaultHeight": 180,
        "id": "mixer",
        "position": "bottom",
        "role": "mixer",
      },
    ],
    "type": "dock",
  },
  "name": "AI Arranger",
  "onActivate": [Function onActivate],
  "onDeactivate": [Function onDeactivate],
  "panels": Array [
    Object {
      "collapsible": true,
      "defaultHeight": 200,
      "id": "arranger",
      "position": "top",
      "resizable": true,
      "role": "toolbar",
    },
    Object {
      "id": "session",
      "position": "center",
      "resizable": true,
      "role": "composition",
    },
    Object {
      "collapsible": true,
      "defaultWidth": 300,
      "id": "generator",
      "position": "right",
      "resizable": true,
      "role": "browser",
    },
    Object {
      "collapsible": true,
      "defaultHeight": 180,
      "id": "mixer",
      "position": "bottom",
      "resizable": true,
      "role": "mixer",
    },
  ],
  "philosophy": "You set direction, AI fills in - fast sketching with stylistic control",
  "policy": Object {
    "allowControlLevelOverridePerTrack": true,
    "allowDeckCustomization": false,
    "allowLayoutCustomization": true,
    "allowToolToggles": true,
  },
  "primaryView": "arranger",
  "shortcuts": Object {
    "add-section": "Cmd+N",
    "capture-to-manual": "Cmd+Shift+M",
    "duplicate-section": "Cmd+D",
    "freeze-part": "Cmd+Shift+F",
    "freeze-section": "Cmd+F",
    "humanize": "Cmd+H",
    "next-section": "Right",
    "play": "Space",
    "prev-section": "Left",
    "quantize": "Cmd+Q",
    "redo": "Cmd+Shift+Z",
    "regenerate-part": "Cmd+Shift+R",
    "regenerate-section": "Cmd+R",
    "stop": "Escape",
    "toggle-bass": "2",
    "toggle-drums": "1",
    "toggle-harmony": "3",
    "toggle-melody": "4",
    "undo": "Cmd+Z",
  },
  "tags": Array [
    "arranger",
    "directed",
    "ai",
    "generation",
    "composition",
  ],
  "theme": Object {
    "colors": Object {
      "accent": "#10b981",
      "background": "#1a1a1a",
      "primary": "#ec4899",
      "secondary": "#8b5cf6",
    },
    "controlIndicators": Object {
      "showGenerative": true,
      "showHints": false,
      "showSuggestions": true,
    },
    "typography": Object {
      "fontFamily": "-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif",
      "fontSize": 14,
    },
  },
  "version": "1.0.0",
}

+ Received: 
undefined

 ❯ src/boards/builtins/phase-h-integration.test.ts:96:43
     94|     it('H022: smoke test - arranger board registered', () => {
     95|       const registry = getBoardRegistry();
     96|       expect(registry.get('ai-arranger')).toBe(aiArrangerBoard);
       |                                           ^
     97|     });
     98| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[198/446]⎯

 FAIL  src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > AI Composition Board (H026-H050) > H047: smoke test - generate draft creates clip + events, visible in notation and tracker
AssertionError: expected undefined to be { id: 'ai-composition', …(21) } // Object.is equality

- Expected: 
Object {
  "author": "CardPlay",
  "category": "Generative",
  "compositionTools": Object {
    "aiComposer": Object {
      "enabled": true,
      "mode": "command-palette",
    },
    "arrangerCard": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "harmonyExplorer": Object {
      "enabled": true,
      "mode": "display-only",
    },
    "phraseDatabase": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "phraseGenerators": Object {
      "enabled": true,
      "mode": "on-demand",
    },
  },
  "connections": Array [],
  "controlLevel": "directed",
  "decks": Array [
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "ai-composer",
      "panelId": "composer",
      "type": "ai-advisor-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "tabs",
      "id": "notation-score",
      "panelId": "notation",
      "type": "notation-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "tabs",
      "id": "pattern-editor",
      "panelId": "notation",
      "type": "pattern-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "timeline",
      "panelId": "timeline",
      "type": "arrangement-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "tabs",
      "id": "properties",
      "panelId": "composer",
      "type": "properties-deck",
    },
  ],
  "description": "Directed composition - describe intent, system drafts, you refine in notation or tracker",
  "difficulty": "advanced",
  "icon": "🤖",
  "id": "ai-composition",
  "layout": Object {
    "panels": Array [
      Object {
        "defaultWidth": 350,
        "id": "composer",
        "position": "left",
        "role": "browser",
      },
      Object {
        "id": "notation",
        "position": "center",
        "role": "composition",
      },
      Object {
        "defaultHeight": 150,
        "id": "timeline",
        "position": "bottom",
        "role": "timeline",
      },
    ],
    "type": "dock",
  },
  "name": "AI Composition",
  "onActivate": [Function onActivate],
  "onDeactivate": [Function onDeactivate],
  "panels": Array [
    Object {
      "collapsible": true,
      "defaultWidth": 350,
      "id": "composer",
      "position": "left",
      "resizable": true,
      "role": "browser",
    },
    Object {
      "id": "notation",
      "position": "center",
      "resizable": true,
      "role": "composition",
    },
    Object {
      "collapsible": true,
      "defaultHeight": 150,
      "id": "timeline",
      "position": "bottom",
      "resizable": true,
      "role": "timeline",
    },
  ],
  "philosophy": "Describe intent, system drafts - collaborative composition workflow",
  "policy": Object {
    "allowControlLevelOverridePerTrack": false,
    "allowDeckCustomization": false,
    "allowLayoutCustomization": true,
    "allowToolToggles": true,
  },
  "primaryView": "composer",
  "shortcuts": Object {
    "accept-draft": "Cmd+Enter",
    "append": "Cmd+Option+G",
    "commit-to-library": "Cmd+S",
    "generate-draft": "Cmd+G",
    "generate-variation": "Cmd+Shift+V",
    "open-composer": "Cmd+K",
    "play": "Space",
    "redo": "Cmd+Shift+Z",
    "regenerate": "Cmd+R",
    "reject-draft": "Cmd+Backspace",
    "replace-selection": "Cmd+Shift+G",
    "save-as-phrase": "Cmd+Shift+S",
    "stop": "Escape",
    "switch-to-notation": "Cmd+1",
    "switch-to-timeline": "Cmd+3",
    "switch-to-tracker": "Cmd+2",
    "undo": "Cmd+Z",
  },
  "tags": Array [
    "ai-composer",
    "directed",
    "prompts",
    "drafting",
    "collaboration",
  ],
  "theme": Object {
    "colors": Object {
      "accent": "#f59e0b",
      "background": "#1a1a1a",
      "primary": "#06b6d4",
      "secondary": "#8b5cf6",
    },
    "controlIndicators": Object {
      "showGenerative": true,
      "showHints": false,
      "showSuggestions": true,
    },
    "typography": Object {
      "fontFamily": "-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif",
      "fontSize": 14,
    },
  },
  "version": "1.0.0",
}

+ Received: 
undefined

 ❯ src/boards/builtins/phase-h-integration.test.ts:157:46
    155|     it('H047: smoke test - generate draft creates clip + events, visib…
    156|       const registry = getBoardRegistry();
    157|       expect(registry.get('ai-composition')).toBe(aiCompositionBoard);
       |                                              ^
    158|       
    159|       // This smoke test verifies the concept exists

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[199/446]⎯

 FAIL  src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Generative Ambient Board (H051-H075) > H071: smoke test - ambient board registered
AssertionError: expected undefined to be { id: 'generative-ambient', …(21) } // Object.is equality

- Expected: 
Object {
  "author": "CardPlay",
  "category": "Generative",
  "compositionTools": Object {
    "aiComposer": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "arrangerCard": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "harmonyExplorer": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "phraseDatabase": Object {
      "enabled": false,
      "mode": "hidden",
    },
    "phraseGenerators": Object {
      "enabled": true,
      "mode": "continuous",
    },
  },
  "connections": Array [],
  "controlLevel": "generative",
  "decks": Array [
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "generator-stream",
      "panelId": "generator",
      "type": "generators-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "mixer",
      "panelId": "mixer",
      "type": "mixer-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "timeline",
      "panelId": "timeline",
      "type": "arrangement-deck",
    },
    Object {
      "allowDragOut": false,
      "allowReordering": false,
      "cardLayout": "stack",
      "id": "properties",
      "panelId": "properties",
      "type": "properties-deck",
    },
  ],
  "description": "Continuous generative ambient - system evolves soundscapes, you curate and capture moments",
  "difficulty": "beginner",
  "icon": "🌊",
  "id": "generative-ambient",
  "layout": Object {
    "panels": Array [
      Object {
        "id": "generator",
        "position": "center",
        "role": "composition",
      },
      Object {
        "defaultHeight": 200,
        "id": "mixer",
        "position": "bottom",
        "role": "mixer",
      },
      Object {
        "defaultWidth": 350,
        "id": "timeline",
        "position": "right",
        "role": "timeline",
      },
      Object {
        "defaultWidth": 300,
        "id": "properties",
        "position": "left",
        "role": "properties",
      },
    ],
    "type": "dock",
  },
  "name": "Generative Ambient",
  "onActivate": [Function onActivate],
  "onDeactivate": [Function onDeactivate],
  "panels": Array [
    Object {
      "id": "generator",
      "position": "center",
      "resizable": true,
      "role": "composition",
    },
    Object {
      "collapsible": true,
      "defaultHeight": 200,
      "id": "mixer",
      "position": "bottom",
      "resizable": true,
      "role": "mixer",
    },
    Object {
      "collapsible": true,
      "defaultWidth": 350,
      "id": "timeline",
      "position": "right",
      "resizable": true,
      "role": "timeline",
    },
    Object {
      "collapsible": true,
      "defaultWidth": 300,
      "id": "properties",
      "position": "left",
      "resizable": true,
      "role": "properties",
    },
  ],
  "philosophy": "System generates, you curate - ambient soundscape exploration",
  "policy": Object {
    "allowControlLevelOverridePerTrack": true,
    "allowDeckCustomization": false,
    "allowLayoutCustomization": true,
    "allowToolToggles": true,
  },
  "primaryView": "composer",
  "shortcuts": Object {
    "accept-candidate": "Enter",
    "capture-live": "Cmd+R",
    "freeze-layer": "Cmd+F",
    "mood-drone": "1",
    "mood-granular": "3",
    "mood-minimalist": "4",
    "mood-shimmer": "2",
    "play": "Space",
    "redo": "Cmd+Shift+Z",
    "regenerate-layer": "Cmd+Shift+R",
    "reject-candidate": "Backspace",
    "stop": "Escape",
    "undo": "Cmd+Z",
  },
  "tags": Array [
    "generative",
    "ambient",
    "continuous",
    "curation",
    "exploration",
  ],
  "theme": Object {
    "colors": Object {
      "accent": "#10b981",
      "background": "#0f172a",
      "primary": "#6366f1",
      "secondary": "#8b5cf6",
    },
    "controlIndicators": Object {
      "showGenerative": true,
      "showHints": false,
      "showSuggestions": false,
    },
    "typography": Object {
      "fontFamily": "-apple-system, BlinkMacSystemFont, \"Segoe UI\", Roboto, sans-serif",
      "fontSize": 14,
    },
  },
  "version": "1.0.0",
}

+ Received: 
undefined

 ❯ src/boards/builtins/phase-h-integration.test.ts:292:50
    290|     it('H071: smoke test - ambient board registered', () => {
    291|       const registry = getBoardRegistry();
    292|       expect(registry.get('generative-ambient')).toBe(generativeAmbien…
       |                                                  ^
    293|     });
    294| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[200/446]⎯

 FAIL  src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should switch between generative boards preserving context
AssertionError: expected null to be 'ai-arranger' // Object.is equality

- Expected: 
"ai-arranger"

+ Received: 
null

 ❯ src/boards/builtins/phase-h-integration.test.ts:307:52
    305|       // Switch to AI Arranger
    306|       switchBoard('ai-arranger', { preserveActiveContext: true });
    307|       expect(stateStore.getState().currentBoardId).toBe('ai-arranger');
       |                                                    ^
    308| 
    309|       // Switch to AI Composition

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[201/446]⎯

 FAIL  src/boards/builtins/phase-h-integration.test.ts > Phase H: Generative Boards > Cross-Board Switching (Phase H) > should maintain recent boards list across generative board switches
AssertionError: expected [] to include 'ai-arranger'
 ❯ src/boards/builtins/phase-h-integration.test.ts:326:28
    324| 
    325|       const recentBoards = stateStore.getState().recentBoardIds;
    326|       expect(recentBoards).toContain('ai-arranger');
       |                            ^
    327|       expect(recentBoards).toContain('ai-composition');
    328|       expect(recentBoards).toContain('generative-ambient');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[202/446]⎯

 FAIL  src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H022: Arranger generates events visible in tracker/piano roll > should generate events visible across views
AssertionError: expected 0 to be greater than 0
 ❯ src/boards/builtins/phase-h-smoke.test.ts:57:33
     55|       expect(result.success).toBe(true);
     56|       expect(result.streamId).toBeTruthy();
     57|       expect(result.eventCount).toBeGreaterThan(0);
       |                                 ^
     58|       
     59|       // Stream should exist and be accessible

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[203/446]⎯

 FAIL  src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H022: Arranger generates events visible in tracker/piano roll > should preserve generated events when switching boards
AssertionError: expected undefined not to be undefined
 ❯ src/boards/builtins/phase-h-smoke.test.ts:105:26
    103|       // Manual board can now edit these events
    104|       const firstEvent = stream!.events[0];
    105|       expect(firstEvent).toBeDefined();
       |                          ^
    106|     });
    107| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[204/446]⎯

 FAIL  src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H023: Freeze prevents regeneration and is undoable > should freeze generated events
TypeError: Cannot read properties of undefined (reading 'start')
 ❯ src/boards/builtins/phase-h-smoke.test.ts:175:26
    173|       
    174|       // This is a basic check - actual implementation may vary
    175|       expect(frozenEvent.start).toBe(originalEvent!.start);
       |                          ^
    176|       expect(frozenEvent.duration).toBe(originalEvent!.duration);
    177|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[205/446]⎯

 FAIL  src/boards/builtins/phase-h-smoke.test.ts > Phase H Smoke Tests > H023: Freeze prevents regeneration and is undoable > should support selective freeze (specific event IDs)
AssertionError: expected 0 to be greater than 0
 ❯ src/boards/builtins/phase-h-smoke.test.ts:267:32
    265|       
    266|       const allEvents = store.getStream(genResult.streamId)!.events;
    267|       expect(allEvents.length).toBeGreaterThan(0);
       |                                ^
    268|       
    269|       // Freeze only first half of events

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[206/446]⎯

 FAIL  src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > G056: dropping phrase writes correct event timings into SharedEventStore
AssertionError: expected undefined to be true // Object.is equality

- Expected: 
true

+ Received: 
undefined

 ❯ src/boards/builtins/phrase-integration.test.ts:87:29
     85|     const result = handlePhraseToPatternEditor(phrasePayload, streamId…
     86|     
     87|     expect(result.accepted).toBe(true);
       |                             ^
     88|     
     89|     // Verify events were written to store

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[207/446]⎯

 FAIL  src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > G057: phrase drop is undoable and restores previous events
AssertionError: expected undefined to be true // Object.is equality

- Expected: 
true

+ Received: 
undefined

 ❯ src/boards/builtins/phrase-integration.test.ts:145:29
    143|     // Execute drop (should be undoable)
    144|     const result = handlePhraseToPatternEditor(phrasePayload, streamId…
    145|     expect(result.accepted).toBe(true);
       |                             ^
    146|     expect(result.undoable).toBe(true);
    147|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[208/446]⎯

 FAIL  src/boards/builtins/phrase-integration.test.ts > Phrase Integration (G055-G057) > phrase adaptation: adapts to harmony context when available
AssertionError: expected undefined to be true // Object.is equality

- Expected: 
true

+ Received: 
undefined

 ❯ src/boards/builtins/phrase-integration.test.ts:206:29
    204|     const result = handlePhraseToPatternEditor(phrasePayload, streamId…
    205|     
    206|     expect(result.accepted).toBe(true);
       |                             ^
    207|     
    208|     // Verify events were transposed (C→G is +7 semitones)

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[209/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should create a deck container element
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:60:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[210/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should render deck header with title
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:73:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[211/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Initialization > should render deck content in body
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:85:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[212/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should render tabs when cardLayout is tabs
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:103:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[213/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should highlight active tab based on state
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:116:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[214/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should call onStateChange when tab is clicked
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:130:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[215/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Tab Switching > should persist active tab to runtime state
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:148:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[216/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist scroll position
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:167:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[217/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist focused item
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:184:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[218/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should persist filter state
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:200:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[219/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > State Persistence > should restore state from persisted runtime state
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:228:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[220/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render stack layout
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderStackLayout src/boards/decks/deck-container.ts:284:44
    282| 
    283|     // Render deck instance
    284|     const rendered = this.options.instance.render();
       |                                            ^
    285|     if (rendered) {
    286|       stackContainer.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:239:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:242:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[221/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render split layout
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderSplitLayout src/boards/decks/deck-container.ts:310:44
    308| 
    309|     // Render deck instance in left pane
    310|     const rendered = this.options.instance.render();
       |                                            ^
    311|     if (rendered) {
    312|       leftPane.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:242:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:253:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[222/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Layout Modes > should render floating layout
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderFloatingLayout src/boards/decks/deck-container.ts:333:44
    331| 
    332|     // Render deck instance
    333|     const rendered = this.options.instance.render();
       |                                            ^
    334|     if (rendered) {
    335|       floatingContainer.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:245:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:264:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[223/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Cleanup > should call deck instance destroy on cleanup
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:277:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[224/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Cleanup > should remove element from DOM on destroy
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:290:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[225/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Close Action > should call onClose callback when close button is clicked
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:307:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[226/446]⎯

 FAIL  src/boards/decks/deck-container.test.ts > DeckContainer > Context Menu > should show context menu on right click
TypeError: this.options.instance.render is not a function
 ❯ DeckContainer.renderTabsLayout src/boards/decks/deck-container.ts:266:44
    264| 
    265|     // Render deck instance in tab content
    266|     const rendered = this.options.instance.render();
       |                                            ^
    267|     if (rendered) {
    268|       tabContent.appendChild(rendered);
 ❯ DeckContainer.renderDeckContent src/boards/decks/deck-container.ts:236:14
 ❯ new DeckContainer src/boards/decks/deck-container.ts:65:10
 ❯ src/boards/decks/deck-container.test.ts:324:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[227/446]⎯

 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should compute visible decks for current board
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should update visible decks when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should cache visible decks for performance
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should compute allowed cards for current board
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should update allowed cards when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should provide card-specific check method
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should clear cache when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should recompute on force refresh
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should notify listeners on board switch
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should allow unsubscribe
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > isDeckCurrentlyVisible > should check deck visibility using cached results
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle no active board gracefully
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle board switch to same board
SecurityError: Cannot initialize local storage without a `--localstorage-file` path
 ❯ src/boards/integration/board-switch-integration.test.ts:27:5
     25|   beforeEach(() => {
     26|     // Clear stores
     27|     localStorage.clear();
       |     ^
     28|     
     29|     // Register factories and boards

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 18, INDEX_SIZE_ERR: 1, DOMSTRING_SIZE_ERR: 2, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, INVALID_CHARACTER_ERR: 5, NO_DATA_ALLOWED_ERR: 6, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INUSE_ATTRIBUTE_ERR: 10, INVALID_STATE_ERR: 11, SYNTAX_ERR: 12, INVALID_MODIFICATION_ERR: 13, NAMESPACE_ERR: 14, INVALID_ACCESS_ERR: 15, VALIDATION_ERR: 16, TYPE_MISMATCH_ERR: 17, SECURITY_ERR: 18, NETWORK_ERR: 19, ABORT_ERR: 20, URL_MISMATCH_ERR: 21, QUOTA_EXCEEDED_ERR: 22, TIMEOUT_ERR: 23, INVALID_NODE_TYPE_ERR: 24, DATA_CLONE_ERR: 25 }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[228/446]⎯

 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should compute visible decks for current board
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should update visible decks when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D066: Visible Decks Recomputation > should cache visible decks for performance
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should compute allowed cards for current board
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should update allowed cards when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D067: Allowed Cards Recomputation > should provide card-specific check method
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should clear cache when board switches
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > D068: Cache Invalidation > should recompute on force refresh
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should notify listeners on board switch
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Board Switch Listeners > should allow unsubscribe
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > isDeckCurrentlyVisible > should check deck visibility using cached results
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle no active board gracefully
 FAIL  src/boards/integration/board-switch-integration.test.ts > Board Switch Integration (D066-D068) > Edge Cases > should handle board switch to same board
SecurityError: Cannot initialize local storage without a `--localstorage-file` path
 ❯ src/boards/integration/board-switch-integration.test.ts:42:5
     40|       cleanup = null;
     41|     }
     42|     localStorage.clear();
       |     ^
     43|   });
     44| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯
Serialized Error: { code: 18, INDEX_SIZE_ERR: 1, DOMSTRING_SIZE_ERR: 2, HIERARCHY_REQUEST_ERR: 3, WRONG_DOCUMENT_ERR: 4, INVALID_CHARACTER_ERR: 5, NO_DATA_ALLOWED_ERR: 6, NO_MODIFICATION_ALLOWED_ERR: 7, NOT_FOUND_ERR: 8, NOT_SUPPORTED_ERR: 9, INUSE_ATTRIBUTE_ERR: 10, INVALID_STATE_ERR: 11, SYNTAX_ERR: 12, INVALID_MODIFICATION_ERR: 13, NAMESPACE_ERR: 14, INVALID_ACCESS_ERR: 15, VALIDATION_ERR: 16, TYPE_MISMATCH_ERR: 17, SECURITY_ERR: 18, NETWORK_ERR: 19, ABORT_ERR: 20, URL_MISMATCH_ERR: 21, QUOTA_EXCEEDED_ERR: 22, TIMEOUT_ERR: 23, INVALID_NODE_TYPE_ERR: 24, DATA_CLONE_ERR: 25 }
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[229/446]⎯

 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should create panel with board settings
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show board name in header
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should have default display settings
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show display section
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should show tracker base selector for tracker boards
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should emit event when settings applied
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should be read-only when configured
 FAIL  src/boards/settings/board-settings-panel.test.ts > BoardSettingsPanel > should destroy cleanly
Error: Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/boards/settings/board-settings-panel.test.ts:16:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[230/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should ignore missing pack with "ignore" policy
TypeError: handleMissingPack is not a function
 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:28:22
     26|   describe('Missing Pack Behavior Policy', () => {
     27|     it('should ignore missing pack with "ignore" policy', () => {
     28|       const result = handleMissingPack(
       |                      ^
     29|         'missing-pack',
     30|         'Pack not found',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[231/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should create placeholder with "placeholder" policy
TypeError: handleMissingPack is not a function
 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:39:22
     37| 
     38|     it('should create placeholder with "placeholder" policy', () => {
     39|       const result = handleMissingPack(
       |                      ^
     40|         'missing-pack',
     41|         'Pack not found',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[232/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Behavior Policy > should propagate error with "error" policy
TypeError: handleMissingPack is not a function
 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:51:22
     49| 
     50|     it('should propagate error with "error" policy', () => {
     51|       const result = handleMissingPack(
       |                      ^
     52|         'missing-pack',
     53|         'Pack not found',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[233/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Missing Pack Placeholder > should handle missing pack with placeholder behavior
TypeError: handleMissingPack is not a function
 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:64:22
     62|   describe('Missing Pack Placeholder', () => {
     63|     it('should handle missing pack with placeholder behavior', () => {
     64|       const result = handleMissingPack(
       |                      ^
     65|         'missing-pack',
     66|         'Pack not found in any discovery path',

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[234/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Invalid Manifest > should accept manifest with valid version
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:130:30
    128|       );
    129| 
    130|       expect(result.success).toBe(true);
       |                              ^
    131|     });
    132|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[235/446]⎯

 FAIL  src/extensions/__tests__/missing-pack-graceful-degradation.test.ts > Missing Pack Graceful Degradation > Loading Errors > should handle extension enable failure gracefully
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/extensions/__tests__/missing-pack-graceful-degradation.test.ts:183:37
    181|         manifest
    182|       );
    183|       expect(installResult.success).toBe(true);
       |                                     ^
    184| 
    185|       // Enable fails due to missing module

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[236/446]⎯

 FAIL  src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should register event kinds with namespaced IDs
AssertionError: expected [ { kind: 'note', …(3) }, …(12) ] to include 'integration-test:custom-event'
 ❯ src/extensions/__tests__/pack-integration.test.ts:56:24
     54|     // Verify it's in the registry
     55|     const eventKinds = listEventKinds();
     56|     expect(eventKinds).toContain('integration-test:custom-event');
       |                        ^
     57|   });
     58| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[237/446]⎯

 FAIL  src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should register port types with namespaced IDs
TypeError: getPortTypeEntries is not a function
 ❯ src/extensions/__tests__/pack-integration.test.ts:68:23
     66| 
     67|     // Verify it's in the registry
     68|     const portTypes = getPortTypeEntries();
       |                       ^
     69|     const hasCustomPort = portTypes.some(p => p.type === 'integration-…
     70|     expect(hasCustomPort).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[238/446]⎯

 FAIL  src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should prevent ID collisions with builtins
AssertionError: expected [Function] to throw an error

- Expected: 
null

+ Received: 
undefined

 ❯ src/extensions/__tests__/pack-integration.test.ts:81:8
     79|         payloadSchema: { type: 'object', properties: {} },
     80|       });
     81|     }).toThrow(/builtin/i);
       |        ^
     82|   });
     83| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[239/446]⎯

 FAIL  src/extensions/__tests__/pack-integration.test.ts > Pack Loading Integration > should allow multiple packs with different namespaces
AssertionError: expected [ { kind: 'note', …(2) }, …(14) ] to include 'pack1-test:event'
 ❯ src/extensions/__tests__/pack-integration.test.ts:101:24
     99|     // Both packs should coexist
    100|     const eventKinds = listEventKinds();
    101|     expect(eventKinds).toContain('pack1-test:event');
       |                        ^
    102|     expect(eventKinds).toContain('pack2-test:event');
    103|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[240/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should prefer lower-cost plan when both satisfy goals
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:83:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[241/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should minimize opcode count for simple goals
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:103:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[242/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should prefer non-destructive edits
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:116:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[243/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Basic Principle > should rank plans by total cost
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:130:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[244/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Cost Hierarchy > should prefer production changes over event changes
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:196:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[245/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Cost Hierarchy > should calculate costs consistently
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:214:50
 ❯ src/gofai/eval/least-change-tests.test.ts:214:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[246/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request aggressive editing
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:246:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[247/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request minimal editing
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:271:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[248/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: User Override > should allow user to request rewrite
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:296:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[249/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Tie-Breaking > should use deterministic tie-breaker when costs are equal
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:317:50
 ❯ src/gofai/eval/least-change-tests.test.ts:317:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[250/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Tie-Breaking > should maintain stable ordering across multiple runs
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:368:51
 ❯ src/gofai/eval/least-change-tests.test.ts:368:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[251/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should scale cost with goal magnitude
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:397:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[252/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should have proportional cost increase for multiple goals
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:419:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[253/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Proportionality > should avoid exponential cost growth
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:442:21
 ❯ src/gofai/eval/least-change-tests.test.ts:437:30

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[254/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should handle zero-cost plans (identity)
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:468:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[255/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should cap maximum cost
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:484:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[256/446]⎯

 FAIL  src/gofai/eval/least-change-tests.test.ts > Least-Change Tests: Edge Cases > should handle negative costs gracefully
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/least-change-tests.test.ts:500:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[257/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should link every goal to at least one opcode
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:88:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[258/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should provide reason for every opcode
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:110:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[259/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should link opcodes to specific goals in reason text
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:127:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[260/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Coverage > should handle multi-goal plans with clear attribution
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:147:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[261/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should track provenance from lexeme to opcode
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:191:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[262/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should preserve provenance through planning stages
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:205:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[263/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should track which rule/strategy generated each opcode
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:221:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[264/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Provenance > should include extension namespace in provenance when applicable
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:253:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[265/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should generate user-friendly explanation text
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:285:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[266/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should explain what each opcode does
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:308:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[267/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should explain why each opcode was chosen
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:323:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[268/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should group related opcodes in explanation
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:338:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[269/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Human Readability > should mention constraints that were respected
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:365:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[270/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "what changed?"
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:386:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[271/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "why did it change?"
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:401:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[272/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should answer "what was kept fixed?"
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:434:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[273/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should explain tradeoffs when goals conflict
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:450:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[274/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Completeness > should explain why alternatives were rejected
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:467:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[275/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should generate identical explanations for identical plans
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:490:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[276/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should maintain explanation across serialization
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:506:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[277/446]⎯

 FAIL  src/gofai/eval/plan-explanation-tests.test.ts > Plan Explanation Tests: Consistency > should handle missing provenance gracefully
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/plan-explanation-tests.test.ts:526:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[278/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate deterministic plan for "make it darker"
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:268:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[279/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate plan for "increase lift" with texture opcodes
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:293:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[280/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate plan for "make it wider" with production opcodes
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:313:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[281/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Basic Planning > should generate minimal plan for small changes
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:330:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[282/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Scoped Planning > should restrict plan to chorus only when scope specified
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:359:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[283/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Scoped Planning > should plan differently for verse vs chorus with same goal
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:382:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[284/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should preserve melody when constrained
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:417:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[285/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should only change drums when constrained
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:451:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[286/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Constrained Planning > should choose lower-cost plan when constraints limit options
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:473:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[287/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Multi-Objective Planning > should handle complementary goals efficiently
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:502:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[288/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Multi-Objective Planning > should handle conflicting goals by choosing balanced plan
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:532:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[289/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should produce identical plans across multiple runs
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:560:50
 ❯ src/gofai/eval/planning-golden-suite.test.ts:560:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[290/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should have stable ranking when scores are equal
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:588:51
 ❯ src/gofai/eval/planning-golden-suite.test.ts:588:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[291/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Determinism > should produce byte-identical serialization
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:604:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[292/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Edge Cases > should handle empty project gracefully
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:628:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[293/446]⎯

 FAIL  src/gofai/eval/planning-golden-suite.test.ts > Planning Golden Suite: Edge Cases > should handle impossible constraints gracefully
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-golden-suite.test.ts:649:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[294/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan simple single-axis goal in < 100ms
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:188:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[295/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan multi-axis goals in < 500ms
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:202:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[296/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan chorus-scope edit in < 1s
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:226:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[297/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan constrained goals in < 2s
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:251:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[298/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Latency > should plan full-song scope in < 5s
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:262:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[299/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should use < 50MB for simple planning
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:280:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[300/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should use < 100MB for complex planning
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:296:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[301/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Memory > should not leak memory across multiple planning runs
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-performance-tests.test.ts:313:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[302/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should scale linearly with project length
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:341:23

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[303/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should scale sub-linearly with goal count
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:363:23

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[304/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should handle large fixtures efficiently
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:380:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[305/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Scalability > should benefit from scoped planning
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:408:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[306/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Throughput > should generate multiple plans per second
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ src/gofai/eval/planning-performance-tests.test.ts:431:7

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[307/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Throughput > should maintain throughput with caching
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:449:25

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[308/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle pathological goal combinations
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:477:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[309/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle deep constraint hierarchies
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:502:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[310/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should prune search space effectively
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:514:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[311/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should handle empty fixtures gracefully
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:527:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[312/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Stress > should timeout or fail gracefully on impossible requests
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:542:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[313/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Regression Guards > should maintain baseline performance across refactors
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:560:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[314/446]⎯

 FAIL  src/gofai/eval/planning-performance-tests.test.ts > Planning Performance Tests: Regression Guards > should not regress on typical use cases
TypeError: Cannot read properties of undefined (reading 'maxDepth')
 ❯ Module.generatePlans src/gofai/planning/plan-generation.ts:432:46
    430| 
    431|   // Beam search: expand level by level
    432|   for (let depth = 0; depth < context.config.maxDepth; depth++) {
       |                                              ^
    433|     const nextBeam: PartialPlan[] = [];
    434| 
 ❯ measurePlanningPerformance src/gofai/eval/planning-performance-tests.test.ts:63:17
 ❯ src/gofai/eval/planning-performance-tests.test.ts:573:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[315/446]⎯

 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should create browser element
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should group boards by control level
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should filter by difficulty
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should show deck type previews
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should support board opening
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should support search/filtering
 FAIL  src/ui/components/board-browser.test.ts > BoardBrowser > should support favoriting boards
Error: Extension board 'manual-test' must use namespaced ID (e.g., 'your-pack:manual-test'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/ui/components/board-browser.test.ts:89:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[316/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should create a board host element
TypeError: window.matchMedia is not a function
 ❯ render src/ui/components/board-host.ts:190:41
    188|     
    189|     // C076: Check reduced motion preference
    190|     const prefersReducedMotion = window.matchMedia('(prefers-reduced-m…
       |                                         ^
    191|     const transitionMs = prefersReducedMotion ? 0 : 200;
    192|     
 ❯ Module.createBoardHost src/ui/components/board-host.ts:261:3
 ❯ src/ui/components/board-host.test.ts:36:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[317/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should have a header and workspace
TypeError: window.matchMedia is not a function
 ❯ render src/ui/components/board-host.ts:190:41
    188|     
    189|     // C076: Check reduced motion preference
    190|     const prefersReducedMotion = window.matchMedia('(prefers-reduced-m…
       |                                         ^
    191|     const transitionMs = prefersReducedMotion ? 0 : 200;
    192|     
 ❯ Module.createBoardHost src/ui/components/board-host.ts:261:3
 ❯ src/ui/components/board-host.test.ts:42:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[318/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should show "No board active" when no board is selected
TypeError: window.matchMedia is not a function
 ❯ render src/ui/components/board-host.ts:190:41
    188|     
    189|     // C076: Check reduced motion preference
    190|     const prefersReducedMotion = window.matchMedia('(prefers-reduced-m…
       |                                         ^
    191|     const transitionMs = prefersReducedMotion ? 0 : 200;
    192|     
 ❯ Module.createBoardHost src/ui/components/board-host.ts:261:3
 ❯ src/ui/components/board-host.test.ts:51:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[319/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should update when board state changes
Error: Extension board 'test-board' must use namespaced ID (e.g., 'your-pack:test-board'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/ui/components/board-host.test.ts:61:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[320/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should cleanup subscriptions on destroy
TypeError: window.matchMedia is not a function
 ❯ render src/ui/components/board-host.ts:190:41
    188|     
    189|     // C076: Check reduced motion preference
    190|     const prefersReducedMotion = window.matchMedia('(prefers-reduced-m…
       |                                         ^
    191|     const transitionMs = prefersReducedMotion ? 0 : 200;
    192|     
 ❯ Module.createBoardHost src/ui/components/board-host.ts:261:3
 ❯ src/ui/components/board-host.test.ts:96:18

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[321/446]⎯

 FAIL  src/ui/components/board-host.test.ts > BoardHost > should display control level badge
Error: Extension board 'assisted-board' must use namespaced ID (e.g., 'your-pack:assisted-board'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/ui/components/board-host.test.ts:113:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[322/446]⎯

 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should create a board switcher modal
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should have search input
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should show results
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should filter results on search
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should toggle favorites
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should close on Escape
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should close on outside click
 FAIL  src/ui/components/board-switcher.test.ts > BoardSwitcher > should navigate with arrow keys
Error: Extension board 'board-1' must use namespaced ID (e.g., 'your-pack:board-1'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/ui/components/board-switcher.test.ts:31:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[323/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should create a badge with the correct control level
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:11:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[324/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should show label when showLabel is true
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:21:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[325/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should hide label when showLabel is false
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:33:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[326/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should update control level dynamically
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:44:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[327/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should apply correct size classes
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:57:24

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[328/446]⎯

 FAIL  src/ui/components/control-spectrum-badge.test.ts > ControlSpectrumBadge > should cleanup when destroyed
ReferenceError: document is not defined
 ❯ ControlSpectrumBadge.createElement src/ui/components/control-spectrum-badge.ts:55:19
     53| 
     54|   private createElement(): HTMLElement {
     55|     const badge = document.createElement('div');
       |                   ^
     56|     badge.className = `control-spectrum-badge control-spectrum-badge--…
     57|     
 ❯ new ControlSpectrumBadge src/ui/components/control-spectrum-badge.ts:50:25
 ❯ src/ui/components/control-spectrum-badge.test.ts:77:19

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[329/446]⎯

 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should create first-run selection element
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should show recommended boards
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should mark first-run complete on selection
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should provide skip option
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should show control spectrum explanation
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should persist first-run completion
 FAIL  src/ui/components/first-run-board-selection.test.ts > FirstRunBoardSelection > should support user type mapping
Error: Extension board 'basic-tracker' must use namespaced ID (e.g., 'your-pack:basic-tracker'). Only builtin boards can use un-namespaced IDs.
 ❯ BoardRegistry.register src/boards/registry.ts:99:15
     97|       // Extension boards MUST have namespace
     98|       if (!hasNamespace) {
     99|         throw new Error(
       |               ^
    100|           `Extension board '${board.id}' must use namespaced ID (e.g.,…
    101|           `Only builtin boards can use un-namespaced IDs.`
 ❯ src/ui/components/first-run-board-selection.test.ts:89:14

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[330/446]⎯

 FAIL  src/ui/components/help-browser-deck.test.ts > HelpBrowserDeck > should search help topics
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/help-browser-deck.test.ts:124:61
    122|     
    123|     expect(results.length).toBeGreaterThan(0);
    124|     expect(results.some(t => t.title.includes('Tutorial'))).toBe(true);
       |                                                             ^
    125|   });
    126| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[331/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > creates a DOM element with pack information
ReferenceError: document is not defined
 ❯ Module.createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:49:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[332/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes error message when present
ReferenceError: document is not defined
 ❯ Module.createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:61:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[333/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes provenance when present
ReferenceError: document is not defined
 ❯ Module.createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:70:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[334/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createMissingPackPlaceholder > includes referenced-by when present
ReferenceError: document is not defined
 ❯ Module.createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:80:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[335/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createInlineMissingPackPlaceholder > creates a compact inline element
ReferenceError: document is not defined
 ❯ Module.createInlineMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:140:21
    138|  */
    139| export function createInlineMissingPackPlaceholder(packId: string): HT…
    140|   const container = document.createElement('span');
       |                     ^
    141|   container.className = 'missing-pack-placeholder--inline';
    142|   container.setAttribute('data-pack-id', packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:89:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[336/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > createInlineMissingPackPlaceholder > includes warning icon
ReferenceError: document is not defined
 ❯ Module.createInlineMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:140:21
    138|  */
    139| export function createInlineMissingPackPlaceholder(packId: string): HT…
    140|   const container = document.createElement('span');
       |                     ^
    141|   container.className = 'missing-pack-placeholder--inline';
    142|   container.setAttribute('data-pack-id', packId);
 ❯ src/ui/components/missing-pack-placeholder.test.ts:98:21

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[337/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > returns placeholder when pack is not found
ReferenceError: document is not defined
 ❯ createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ Module.getPackOrPlaceholder src/ui/components/missing-pack-placeholder.ts:213:25
 ❯ src/ui/components/missing-pack-placeholder.test.ts:117:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[338/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > returns placeholder when getter throws
ReferenceError: document is not defined
 ❯ createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ Module.getPackOrPlaceholder src/ui/components/missing-pack-placeholder.ts:213:25
 ❯ src/ui/components/missing-pack-placeholder.test.ts:130:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[339/446]⎯

 FAIL  src/ui/components/missing-pack-placeholder.test.ts > getPackOrPlaceholder > includes context in placeholder
ReferenceError: document is not defined
 ❯ createMissingPackPlaceholder src/ui/components/missing-pack-placeholder.ts:85:21
     83|  */
     84| export function createMissingPackPlaceholder(info: MissingPackInfo): H…
     85|   const container = document.createElement('div');
       |                     ^
     86|   container.className = 'missing-pack-placeholder';
     87|   container.setAttribute('data-pack-id', info.packId);
 ❯ Module.getPackOrPlaceholder src/ui/components/missing-pack-placeholder.ts:213:25
 ❯ src/ui/components/missing-pack-placeholder.test.ts:145:20

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[340/446]⎯

 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > creates overlay with toolbar buttons
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > toggles highlights when button is clicked
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > G114: snap to chord tones is undoable and preserves rhythm
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > G113: chord suggestions update context and refresh overlays
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > harmonizes selection when harmonize button is clicked
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > handles empty selection gracefully
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > handles no active stream gracefully
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > subscribes to context changes
 FAIL  src/ui/components/notation-harmony-overlay.test.ts > NotationHarmonyOverlay > cleans up subscription on disposal
TypeError: Cannot read properties of undefined (reading 'NOTE')
 ❯ src/ui/components/notation-harmony-overlay.test.ts:37:26
     35|       {
     36|         id: 'event-1' as EventId,
     37|         kind: EventKinds.NOTE,
       |                          ^
     38|         start: asTick(0),
     39|         duration: asTickDuration(96),

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[341/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Grid Rendering > should apply clip colors to slots
AssertionError: expected '' to be truthy

- Expected: 
""

+ Received: 
false

 ❯ src/ui/components/session-grid-panel.test.ts:106:48
    104| 
    105|       const firstSlot = panel.querySelector('[data-track="0"][data-sce…
    106|       expect(firstSlot?.style.borderLeftColor).toBeTruthy();
       |                                                ^
    107|     });
    108|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[342/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Slot Selection > should update selection indicator when slot is clicked
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/session-grid-panel.test.ts:178:70
    176|       // Click first slot
    177|       firstSlot.click();
    178|       expect(firstSlot.classList.contains('session-slot--selected')).t…
       |                                                                      ^
    179| 
    180|       // Click second slot

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[343/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Play State Display > should show stopped state styling
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/session-grid-panel.test.ts:192:64
    190| 
    191|       const slot = panel.querySelector('[data-track="0"][data-scene="0…
    192|       expect(slot.classList.contains('session-slot--stopped')).toBe(tr…
       |                                                                ^
    193|     });
    194| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[344/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Keyboard Navigation > should navigate slots with arrow keys
AssertionError: expected <body><div id="test-root"></div></body> to be <button …(7)>…(1)</button> // Object.is equality

- Expected
+ Received

- <button
-   aria-label="Clip: Clip 1,0, stopped"
-   class="session-slot session-slot--filled"
-   data-play-state="stopped"
-   data-scene="0"
-   data-track="1"
-   role="gridcell"
-   style="background-color: rgb(66, 135, 245);"
- >
-   <span
-     class="session-slot-label"
-   >
-     Clip 1,0
-   </span>
- </button>
+ <body>
+   <div
+     id="test-root"
+   />
+ </body>

 ❯ src/ui/components/session-grid-panel.test.ts:266:38
    264| 
    265|       const secondSlot = panel.querySelector('[data-track="1"][data-sc…
    266|       expect(document.activeElement).toBe(secondSlot);
       |                                      ^
    267|     });
    268| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[345/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Keyboard Navigation > should activate slot with Enter key
AssertionError: expected "spy" to be called at least once
 ❯ src/ui/components/session-grid-panel.test.ts:286:27
    284|       firstSlot.dispatchEvent(enterKey);
    285| 
    286|       expect(onSlotClick).toHaveBeenCalled();
       |                           ^
    287|     });
    288|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[346/446]⎯

 FAIL  src/ui/components/session-grid-panel.test.ts > SessionGridPanel > Accessibility > should update aria-pressed for play state
AssertionError: expected null to be 'true' // Object.is equality

- Expected: 
"true"

+ Received: 
null

 ❯ src/ui/components/session-grid-panel.test.ts:328:56
    326| 
    327|       const playingSlot = panel.querySelector('[data-track="0"][data-s…
    328|       expect(playingSlot.getAttribute('aria-pressed')).toBe('true');
       |                                                        ^
    329| 
    330|       const stoppedSlot = panel.querySelector('[data-track="1"][data-s…

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[347/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Auto-dismiss > should auto-dismiss after duration
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/toast-notification.test.ts:179:53
    177|       });
    178|       
    179|       expect(document.body.contains(toast.element)).toBe(true);
       |                                                     ^
    180|       
    181|       vi.advanceTimersByTime(1100);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[348/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Auto-dismiss > should not auto-dismiss when duration is 0
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/toast-notification.test.ts:196:53
    194|       vi.advanceTimersByTime(10000);
    195|       
    196|       expect(document.body.contains(toast.element)).toBe(true);
       |                                                     ^
    197|     });
    198|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[349/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Manual dismiss > should dismiss toast when dismiss() is called
AssertionError: expected "spy" to be called at least once
 ❯ src/ui/components/toast-notification.test.ts:211:25
    209|       
    210|       vi.advanceTimersByTime(200);
    211|       expect(onDismiss).toHaveBeenCalled();
       |                         ^
    212|     });
    213| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[350/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Manual dismiss > should dismiss toast when close button is clicked
AssertionError: expected "spy" to be called at least once
 ❯ src/ui/components/toast-notification.test.ts:226:25
    224|       
    225|       vi.advanceTimersByTime(200);
    226|       expect(onDismiss).toHaveBeenCalled();
       |                         ^
    227|     });
    228|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[351/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > dismissAllToasts > should dismiss all active toasts
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/toast-notification.test.ts:236:54
    234|       const toast3 = showToast({ message: 'Toast 3', position: 'top-le…
    235|       
    236|       expect(document.body.contains(toast1.element)).toBe(true);
       |                                                      ^
    237|       expect(document.body.contains(toast2.element)).toBe(true);
    238|       expect(document.body.contains(toast3.element)).toBe(true);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[352/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > dismissToastsAtPosition > should dismiss only toasts at specified position
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/components/toast-notification.test.ts:260:54
    258|       
    259|       expect(document.body.contains(toast1.element)).toBe(false);
    260|       expect(document.body.contains(toast2.element)).toBe(true);
       |                                                      ^
    261|     });
    262|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[353/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Stacking > should stack multiple toasts at same position
AssertionError: expected undefined to be 3 // Object.is equality

- Expected: 
3

+ Received: 
undefined

 ❯ src/ui/components/toast-notification.test.ts:271:42
    269|       
    270|       const container = document.querySelector('.toast-container--bott…
    271|       expect(container?.children.length).toBe(3);
       |                                          ^
    272|     });
    273| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[354/446]⎯

 FAIL  src/ui/components/toast-notification.test.ts > Toast Notification System > Stacking > should create separate containers for different positions
AssertionError: expected null to be truthy

- Expected: 
null

+ Received: 
false

 ❯ src/ui/components/toast-notification.test.ts:281:31
    279|       const topContainer = document.querySelector('.toast-container--t…
    280|       
    281|       expect(bottomContainer).toBeTruthy();
       |                               ^
    282|       expect(topContainer).toBeTruthy();
    283|       expect(bottomContainer?.children.length).toBe(1);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[355/446]⎯

 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should create and render undo history browser
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display header with title
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display empty state when no actions
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display stats correctly
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should render control buttons
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should display actions in timeline
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should mark current action
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should distinguish past and future actions
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should have proper ARIA attributes
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should inject styles only once
 FAIL  src/ui/components/undo-history-browser.test.ts > UndoHistoryBrowser > should auto-update timeline periodically
TypeError: Cannot read properties of undefined (reading 'getInstance')
 ❯ src/ui/components/undo-history-browser.test.ts:18:27
     16|     container = document.createElement('div');
     17|     document.body.appendChild(container);
     18|     undoStack = UndoStack.getInstance();
       |                           ^
     19|     undoStack.clear();
     20|   });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[356/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 335: Tracker projection matches SSOT > should project events onto tracker rows
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

 ❯ src/ui/projections/event-projections.test.ts:54:42
     52|       
     53|       // Check step 0 has first note
     54|       expect(projection.rows[0]!.events).toHaveLength(1);
       |                                          ^
     55|       expect((projection.rows[0]!.events[0]!.payload as { note: number…
     56|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[357/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should project notes onto piano roll grid
AssertionError: expected [] to have a length of 3 but got +0

- Expected
+ Received

- 3
+ 0

 ❯ src/ui/projections/event-projections.test.ts:124:32
    122|       );
    123|       
    124|       expect(projection.notes).toHaveLength(3);
       |                                ^
    125|       
    126|       // Check first note

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[358/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should filter by pitch range
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

 ❯ src/ui/projections/event-projections.test.ts:162:32
    160|       );
    161|       
    162|       expect(projection.notes).toHaveLength(1);
       |                                ^
    163|       expect(projection.notes[0]!.note).toBe(60);
    164|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[359/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should track selection state
TypeError: Cannot read properties of undefined (reading 'selected')
 ❯ src/ui/projections/event-projections.test.ts:187:35
    185|       );
    186|       
    187|       expect(projection.notes[0]!.selected).toBe(true);
       |                                   ^
    188|       expect(projection.notes[1]!.selected).toBe(false);
    189|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[360/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 336: Piano roll projection matches SSOT > should handle viewport clipping
AssertionError: expected [] to have a length of 1 but got +0

- Expected
+ Received

- 1
+ 0

 ❯ src/ui/projections/event-projections.test.ts:210:32
    208|       );
    209|       
    210|       expect(projection.notes).toHaveLength(1);
       |                                ^
    211|       expect(projection.notes[0]!.note).toBe(64);
    212|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[361/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Notation projection > should organize notes into measures
AssertionError: expected [] to have a length of 2 but got +0

- Expected
+ Received

- 2
+ 0

 ❯ src/ui/projections/event-projections.test.ts:240:45
    238|       
    239|       // Measure 1 should have 2 notes
    240|       expect(projection.measures[0]!.notes).toHaveLength(2);
       |                                             ^
    241|       expect(projection.measures[0]!.number).toBe(1);
    242|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[362/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 334: Projection invalidation > should track projection version
AssertionError: expected true to be false // Object.is equality

- Expected
+ Received

- false
+ true

 ❯ src/ui/projections/event-projections.test.ts:267:54
    265|       
    266|       // Projection should now be invalid
    267|       expect(isProjectionValid(projection1.version)).toBe(false);
       |                                                      ^
    268|       
    269|       // New projection should have new version

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[363/446]⎯

 FAIL  src/ui/projections/event-projections.test.ts > Event Projections > Change 334: Projection invalidation > should notify subscribers on invalidation
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/ui/projections/event-projections.test.ts:296:27
    294|       ]);
    295|       
    296|       expect(invalidated).toBe(true);
       |                           ^
    297|       
    298|       unsubscribe();

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[364/446]⎯

 FAIL  src/ui/utils/micro-interactions.test.ts > Micro-interactions > highlightFlash > adds highlight flash
AssertionError: expected 'rgb(255, 215, 0)' to be '#ffd700' // Object.is equality

- Expected
+ Received

- #ffd700
+ rgb(255, 215, 0)

 ❯ src/ui/utils/micro-interactions.test.ts:151:40
    149|       highlightFlash(element, '#ffd700');
    150|       
    151|       expect(element.style.background).toBe('#ffd700');
       |                                        ^
    152|       expect(element.style.transition).toContain('background');
    153|       

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[365/446]⎯

 FAIL  src/ui/utils/micro-interactions.test.ts > Micro-interactions > createLoadingSpinner > creates spinner element
AssertionError: expected '' to be '20px' // Object.is equality

- Expected
+ Received

- 20px

 ❯ src/ui/utils/micro-interactions.test.ts:166:35
    164|       
    165|       expect(spinner.className).toBe('micro-spinner');
    166|       expect(spinner.style.width).toBe('20px');
       |                                   ^
    167|       expect(spinner.style.height).toBe('20px');
    168|       expect(spinner.style.borderRadius).toBe('50%');

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[366/446]⎯

 FAIL  src/ui/utils/micro-interactions.test.ts > Micro-interactions > animateNumber > animates number from start to end
AssertionError: expected '0' not to be '0' // Object.is equality
 ❯ src/ui/utils/micro-interactions.test.ts:192:39
    190|       
    191|       // Should start animating
    192|       expect(element.textContent).not.toBe('0');
       |                                       ^
    193|     });
    194|     

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[367/446]⎯

 FAIL  src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > every implemented DeckType has a registered factory
Error: Missing factories for implemented DeckTypes:
  - pattern-deck
  - piano-roll-deck
  - notation-deck
  - session-deck
  - arrangement-deck
  - arranger-deck
  - mixer-deck
  - transport-deck
  - instruments-deck
  - samples-deck
  - sample-manager-deck
  - effects-deck
  - dsp-chain
  - routing-deck
  - modulation-matrix-deck
  - automation-deck
  - properties-deck
  - phrases-deck
  - harmony-deck
  - generators-deck
  - ai-advisor-deck
  - track-groups-deck
  - mix-bus-deck
  - reference-track-deck

Either:
1. Implement the factory in factories/ directory
2. Register it in factories/index.ts
3. Or add to NOT_YET_IMPLEMENTED if not ready
 ❯ src/boards/decks/__tests__/deck-type-coverage.test.ts:73:13
     71|         .join('\n');
     72|       
     73|       throw new Error(
       |             ^
     74|         `Missing factories for implemented DeckTypes:\n${details}\n\n`…
     75|         'Either:\n' +

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[368/446]⎯

 FAIL  src/boards/decks/__tests__/deck-type-coverage.test.ts > DeckType Factory Coverage > factory registry has reasonable coverage
AssertionError: expected 0 to be greater than or equal to 80
 ❯ src/boards/decks/__tests__/deck-type-coverage.test.ts:134:22
    132|     
    133|     // Expect at least 80% coverage
    134|     expect(coverage).toBeGreaterThanOrEqual(80);
       |                      ^
    135|   });
    136| });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[369/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical axis IDs
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:103:41
    101| 
    102|       for (const criticalId of CRITICAL_ENTITY_IDS.axes) {
    103|         expect(axisIds.has(criticalId)).toBe(true);
       |                                         ^
    104|       }
    105|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[370/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical opcode IDs
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:127:43
    125| 
    126|       for (const criticalId of CRITICAL_ENTITY_IDS.opcodes) {
    127|         expect(opcodeIds.has(criticalId)).toBe(true);
       |                                           ^
    128|       }
    129|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[371/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Entity ID Stability > should preserve all critical constraint type IDs
AssertionError: expected false to be true // Object.is equality

- Expected
+ Received

- true
+ false

 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:135:47
    133| 
    134|       for (const criticalId of CRITICAL_ENTITY_IDS.constraints) {
    135|         expect(constraintIds.has(criticalId)).toBe(true);
       |                                               ^
    136|       }
    137|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[372/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Lexeme Binding Stability > should preserve section lexeme bindings
AssertionError: expected 0 to be greater than 0
 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:174:36
    172|       );
    173| 
    174|       expect(chorusLexemes.length).toBeGreaterThan(0);
       |                                    ^
    175| 
    176|       const verseLexemes = CORE_LEXEMES.filter(lex =>

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[373/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Critical Lexeme Binding Stability > should preserve layer lexeme bindings
AssertionError: expected 0 to be greater than 0
 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:188:35
    186|       );
    187| 
    188|       expect(drumsLexemes.length).toBeGreaterThan(0);
       |                                   ^
    189| 
    190|       const bassLexemes = CORE_LEXEMES.filter(lex =>

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[374/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > ID Format Stability > should maintain opcode ID format (op:name)
AssertionError: expected 'opcode:change' to match /^(op:|[a-z_]+:op:)/

- Expected: 
/^(op:|[a-z_]+:op:)/

+ Received: 
"opcode:change"

 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:223:20
    221|       for (const opcode of CORE_OPCODES) {
    222|         const id = opcode.id as string;
    223|         expect(id).toMatch(/^(op:|[a-z_]+:op:)/);
       |                    ^
    224|       }
    225|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[375/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > ID Format Stability > should maintain lexeme ID format (lex:category:name)
AssertionError: expected 'lexeme:make:verb' to match /^(lex:|[a-z_]+:lex:)/

- Expected: 
/^(lex:|[a-z_]+:lex:)/

+ Received: 
"lexeme:make:verb"

 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:231:20
    229|         const id = lexeme.id as string;
    230|         // Core lexemes should start with lex: or have namespace:lex: …
    231|         expect(id).toMatch(/^(lex:|[a-z_]+:lex:)/);
       |                    ^
    232|       }
    233|     });

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[376/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Backwards Compatibility > should maintain minimum entity counts (no accidental deletions)
AssertionError: expected 54 to be greater than or equal to 100
 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:304:35
    302|       expect(CORE_OPCODES.length).toBeGreaterThanOrEqual(6);
    303|       expect(CORE_CONSTRAINT_TYPES.length).toBeGreaterThanOrEqual(3);
    304|       expect(CORE_LEXEMES.length).toBeGreaterThanOrEqual(100);
       |                                   ^
    305|     });
    306| 

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[377/446]⎯

 FAIL  src/gofai/canon/__tests__/entity-binding-stability.test.ts > entity-binding-stability (Step 099) > Semantic Stability > should maintain section role consistency
AssertionError: expected undefined not to be undefined
 ❯ src/gofai/canon/__tests__/entity-binding-stability.test.ts:368:30
    366|       // Sections should have consistent role definitions
    367|       for (const section of CORE_SECTION_TYPES) {
    368|         expect(section.role).toBeDefined();
       |                              ^
    369|         expect(typeof section.role).toBe('string');
    370|         expect(section.role.length).toBeGreaterThan(0);

⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯[378/446]⎯

⎯⎯⎯⎯⎯⎯ Unhandled Errors ⎯⎯⎯⎯⎯⎯

Vitest caught 3 unhandled errors during the test run.
This might cause false positive tests. Resolve unhandled errors to make sure your tests are not affected.

⎯⎯⎯⎯⎯ Uncaught Exception ⎯⎯⎯⎯⎯
AssertionError: expected '0' to be '1' // Object.is equality

- Expected
+ Received

- 1
+ 0

 ❯ src/ui/utils/micro-interactions.test.ts:221:39
    219|       // Initially should be transparent
    220|       requestAnimationFrame(() => {
    221|         expect(element.style.opacity).toBe('1');
       |                                       ^
    222|       });
    223|     });
 ❯ invokeTheCallbackFunction node_modules/jsdom/lib/jsdom/living/generated/Function.js:19:26
 ❯ runAnimationFrameCallbacks node_modules/jsdom/lib/jsdom/browser/Window.js:688:13
 ❯ Timeout._onTimeout node_modules/jsdom/lib/jsdom/browser/Window.js:666:11
 ❯ listOnTimeout node:internal/timers:605:17
 ❯ processTimers node:internal/timers:541:7

This error originated in "src/ui/utils/micro-interactions.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "fades out element". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- If the error occurred after the test had been completed, this was the last documented test before it was thrown.

⎯⎯⎯⎯⎯ Uncaught Exception ⎯⎯⎯⎯⎯
AssertionError: expected '' to be 'scale(1)' // Object.is equality

- Expected
+ Received

- scale(1)

 ❯ Timeout._onTimeout src/ui/utils/micro-interactions.test.ts:58:41
     56|       // Wait for animation to complete
     57|       setTimeout(() => {
     58|         expect(element.style.transform).toBe('scale(1)');
       |                                         ^
     59|       }, 150);
     60|     });
 ❯ listOnTimeout node:internal/timers:605:17
 ❯ processTimers node:internal/timers:541:7

This error originated in "src/ui/utils/micro-interactions.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
The latest test that might've caused the error is "fades out element". It might mean one of the following:
- The error was thrown, while Vitest was running this test.
- If the error occurred after the test had been completed, this was the last documented test before it was thrown.

⎯⎯⎯⎯⎯ Uncaught Exception ⎯⎯⎯⎯⎯
AssertionError: expected 'translateX(20px)' to be 'translate(0, 0)' // Object.is equality

- Expected
+ Received

- translate(0, 0)
+ translateX(20px)

 ❯ src/ui/utils/micro-interactions.test.ts:245:41
    243|       
    244|       requestAnimationFrame(() => {
    245|         expect(element.style.transform).toBe('translate(0, 0)');
       |                                         ^
    246|         expect(element.style.opacity).toBe('1');
    247|       });
 ❯ invokeTheCallbackFunction node_modules/jsdom/lib/jsdom/living/generated/Function.js:19:26
 ❯ runAnimationFrameCallbacks node_modules/jsdom/lib/jsdom/browser/Window.js:688:13
 ❯ Timeout._onTimeout node_modules/jsdom/lib/jsdom/browser/Window.js:666:11
 ❯ listOnTimeout node:internal/timers:605:17
 ❯ processTimers node:internal/timers:541:7

This error originated in "src/ui/utils/micro-interactions.test.ts" test file. It doesn't mean the error was thrown inside the file itself, but while it was running.
⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯⎯

 Test Files  35 failed | 284 passed (319)
      Tests  432 failed | 11103 passed | 33 skipped (11568)
Type Errors  no errors
     Errors  3 errors
   Start at  07:50:06
   Duration  47.50s (transform 14.55s, setup 11ms, collect 29.36s, tests 171.54s, environment 11.42s, prepare 14.96s)

